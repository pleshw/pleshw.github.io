var AudioTools;(()=>{"use strict";var t={173:(t,e,n)=>{n.d(e,{AudioComponent:()=>c});var i=n(7353),o=n(1319),s=n(3164),r=n(2843),a=n(6555),l=n(2560);class c extends l.S{src;audioElement;_container;_startsAt;_blockInteraction=!1;_divBlockInteraction;constructor(t){super(),this.src=t.src,this._container=t.container,this.audioElement=t.audioElement,this._blockInteraction=!!t.blockInteraction,t.audioElementId&&(this.audioElement.id=t.audioElementId),this._startsAt=t.startsAt??0,this.audioElement.classList.add("audio-component"),this.audioElement.addEventListener("ended",(()=>{this.stop()})),this._container.id||(this._container.id=t.audioElementId+"AudioComponentContainer"),this._container.classList.add("audio-component-container"),this._divBlockInteraction=this.getInvisibleDivBlockInteraction(this),this.setupInvisibleDivBlockInteraction(),this.setElementsAttributes()}destroy(){this.container.remove()}get isPlaying(){return!this.audioElement.paused}set id(t){this.audioElement.id=t}get id(){return this.audioElement.id}get _videoInfoAttributeList(){return[["audio-component-src",this.src],["audio-component-name",this.name]]}get name(){return(0,r.replacePercentEncoding)((0,s.removeFilePath)(this.src))}setElementsAttributes(){(0,o.setAttributeListForElement)(this.audioElement,this._videoInfoAttributeList),(0,o.setAttributeListForElement)(this.container,this._videoInfoAttributeList),(0,o.setAttributeListForElement)(this.divBlockInteraction,this._videoInfoAttributeList)}get divBlockInteraction(){return this._divBlockInteraction}get container(){return this._container}get paused(){return this.audioElement.paused}get fileName(){return this.audioElement.src||this.audioElement.querySelector("source")?.src||""}get startsAt(){return this._startsAt}set playerCurrentTime(t){this.audioElement.currentTime=t}get playerCurrentTime(){return this.audioElement.currentTime}get currentTime(){return this.playerCurrentTime-this.startsAt}set currentTime(t){this.seek(t)}get sourceElements(){return Array.from(this.audioElement.querySelectorAll("source"))}changeSource(t,e){this.id=e,this.src=t,this.audioElement.innerHTML=(0,i.sourceElementHTML)(this.src),this.audioElement.load(),this.setElementsAttributes(),this.stop()}playWithoutTriggerEvents(){var t=this.audioElement.play();return void 0!==t&&t.then((t=>{})).catch((()=>{this.stop()})),this.setClassesPlaying(),this}pauseWithoutTriggerEvents(){return this.audioElement.pause(),this.setClassesPaused(),this}setClassesPlaying(){this._container.classList.add("audio-component-playing"),this._divBlockInteraction.classList.add("audio-component-playing"),this._container.classList.remove("audio-component-paused"),this._divBlockInteraction.classList.remove("audio-component-paused")}setClassesPaused(){this._container.classList.add("audio-component-paused"),this._divBlockInteraction.classList.add("audio-component-paused"),this._container.classList.remove("audio-component-playing"),this._divBlockInteraction.classList.remove("audio-component-playing")}play(){return this.playWithoutTriggerEvents(),this.callEventsByName("onplay",this),this}pause(){return this.pauseWithoutTriggerEvents(),this.callEventsByName("onpause",this),this}stop(){return this.pause(),this.audioElement.currentTime=this.startsAt,this.callEventsByName("onstop",this),this}toggle(){return this.paused?this.playWithoutTriggerEvents():this.pause(),this.callEventsByName("ontoggle",this),this}mute(){return this.audioElement.volume=0,this.callEventsByName("onmute",this),this}unmute(){return this.audioElement.volume=1,this.callEventsByName("onunmute",this),this}seek(t,e){return this.playerCurrentTime=t,this.callEventsByName("onseek",this),this}get dimensions(){return(0,o.getElementDimensions)(this._container)}getInvisibleDivBlockInteraction(t){const e=(0,o.createInvisibleDivAboveParent)({parentElement:t._container,id:`invisibleDivBlockInteraction${t._container.id}`,position:{top:0,left:0},dimensions:{width:t.dimensions.width,height:t.dimensions.height}});return e.classList.add("audio-component-div-block-interaction"),e}setupInvisibleDivBlockInteraction(){this._divBlockInteraction.style.display=this._blockInteraction?"block":"none",this._divBlockInteraction.style.zIndex="995",this._divBlockInteraction.addEventListener("click",(()=>{this.callEventsByName("onclickinteractionblocked",this,this._divBlockInteraction),this.callEventsByName("oninteractionblocked",this,this._divBlockInteraction)}))}static async createAudioComponentOnBody(t){const e=await new a.AudioComponentFactory(t.src).buildOnBody();return new c({src:t.src,container:e,audioElement:e.querySelector("audio"),audioElementId:t.audioElementId,blockInteraction:t.blockInteraction})}static async createAudioComponent(t){if(t.container===document.body||!t.container)return this.createAudioComponentOnBody(t);const e=await new a.AudioComponentFactory(t.src).build(t.container);return new c({src:t.src,container:e,audioElement:e.querySelector("audio"),audioElementId:t.audioElementId,blockInteraction:t.blockInteraction})}}},6555:(t,e,n)=>{n.d(e,{AudioComponentFactory:()=>s});var i=n(7353),o=n(6401);class s extends o.ComponentContainer{constructor(t,e){super("audioComponent",(0,i.createInvisiblePlayer)([t],e))}async buildSubComponents(t){}}},6401:(t,e,n)=>{n.d(e,{ComponentContainer:()=>i});class i{_element=null;templateElement;componentName;subComponentCountByName=new Map;subComponents=[];constructor(t,e){if("string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error("Invalid template for scene component. Template id: "+e);this.templateElement=t}else this.templateElement=document.createElement("template"),this.templateElement.content.appendChild(e),document.body.appendChild(this.templateElement);this.componentName=t}getTemplateCloneNodes(){return this.templateElement.content.cloneNode(!0).children}async buildSingleSubComponent(t,e){this.subComponentCountByName.has(this.componentName)&&this.subComponentCountByName.set(this.componentName,0);let n=this.subComponentCountByName.get(this.componentName);return this.subComponentCountByName.set(this.componentName,n+1),await t.build(e,`${this.componentName}${t.componentName.capitalizeFirstLetter()}${n}`)}async buildOnBody(t){this._element=document.createElement("div"),t&&(this._element.id=t);for(let t of this.getTemplateCloneNodes())this._element.insertAdjacentElement("afterbegin",t);if(!this._element)throw new Error(`Fail building SceneComponent. ElementId: ${t}`);return await this.buildSubComponents(document.body),document.body.insertAdjacentElement("beforeend",this._element),this._element}async build(t,e){for(let e of this.getTemplateCloneNodes())t.insertAdjacentElement("afterbegin",e);return await this.buildSubComponents(t),t}}},2560:(t,e,n)=>{n.d(e,{S:()=>o});var i=n(7930);class o extends i.ObjectEventListener{constructor(){super()}}},2976:()=>{String.prototype.isNullOrEmpty=function(){return"string"!=typeof this&&!this&&""!==this},String.prototype.truncate=function(t,e="..."){return(this.length>t?this.substring(0,t)+e:this).toString()},String.prototype.removeAccents=function(){return this.normalize("NFD").replace(/[\u0300-\u036f]/g,"")},String.prototype.capitalizeFirstLetter=function(){return"string"!=typeof this?"":this.charAt(0).toUpperCase()+this.substring(1)},String.prototype.zeroBefore=function(){return this.padStart(2,"0")}},7930:(t,e,n)=>{n.d(e,{ObjectEventListener:()=>i});class i{eventsByName=new Map;addEventListener(t,e){const n={id:crypto.randomUUID(),event:e};return this.eventsByName.has(t.toLowerCase())?(this.eventsByName.get(t.toLowerCase()).push(n),n.id):(this.eventsByName.set(t.toLowerCase(),[n]),n.id)}getEventsByName(t){return this.eventsByName.has(t.toLowerCase())||this.eventsByName.set(t.toLowerCase(),[]),this.eventsByName.get(t.toLowerCase())}removeEventById(t){this.eventsByName.forEach(((e,n)=>{this.eventsByName.set(n,e.filter((e=>e.id!==t)))}))}callEventsByName(t,...e){this.getEventsByName(t).forEach((t=>t.event(...e)))}}},7353:(t,e,n)=>{n.r(e),n.d(e,{audioElementHTML:()=>l,createAudioComponentOnBody:()=>r,createInvisiblePlayer:()=>a,playButtonCSS:()=>u,sourceElementHTML:()=>c}),n(2976);var i=n(1319),o=n(3164),s=n(173);async function r(t){return await s.AudioComponent.createAudioComponentOnBody(t)}function a(t,e){const n=(0,i.getElementFromHTML)(l(t,e));return document.body.insertAdjacentElement("afterbegin",n),(0,i.hideElement)(n),n}function l(t,e){return`<audio controls ${e?function(t){return` ${t.id?'id="'+t.id+'"':""} ${t.autoPlay||t.autoplay?"autoplay":""} ${t.muted?"muted":""} ${t.loop?"loop":""} ${t.preload?'preload="'+t.preload+'"':""}`.trimEnd()}(e):""}>\n    ${t.map((t=>c(t))).reduce(((t,e)=>t+e),"")}\n  </audio>`}function c(t){return`<source src="${t}" type="audio/${(0,o.getFileExtension)(t)}">`}function u(){return"\n    .play-button {\n      margin: 0;\n      padding: 0;\n      display: flex;\n      border: 0;\n      background: transparent;\n      box-sizing: border-box;\n      width: 0;\n      height: 34px;\n      border-color: transparent transparent transparent #202020;\n      transition: 100ms all ease;\n      cursor: pointer;\n      border-style: double;\n      border-width: 0px 0 0px 30px;\n    }\n\n    .play-button.paused {\n      border-style: solid;\n      border-width: 23px 0px 23px 34px;\n    }\n\n    .play-button:hover {\n      border-color: transparent transparent transparent #404040;\n    }\n  "}},1319:(t,e,n)=>{n.d(e,{createInvisibleDivAboveParent:()=>c,getElementDimensions:()=>l,getElementFromHTML:()=>a,hideElement:()=>u,setAttributeListForElement:()=>r});const i=new Map,o=new Map,s=new Map;function r(t,e){e.forEach((([e,n])=>{t.setAttribute(e,n)}))}function a(t,e=!0){if(!(t=e?t.trim():t))return null;const n=document.createElement("template");n.innerHTML=t;const i=n.content.children;return 1===i.length?i[0]:Array.from(i)}function l(t){var e=t.getBoundingClientRect();return{width:e.width,height:e.height}}function c({parentElement:t,id:e,position:n,dimensions:i}){var o=document.createElement("div");return t.style.position||(t.style.position="relative"),o.id=e,o.style.position="absolute",o.style.width=i&&i.width?i.width.toString()+"px":"100%",o.style.height=i&&i.height?i.height.toString()+"px":"100%",o.style.top=(n?.top.toString()??"0")+"px",o.style.left=(n?.left.toString()??"0")+"px",o.style.opacity="0",o.style.pointerEvents="auto",t.appendChild(o),o}function u(t){t.style.display="block",t.style.position="absolute",t.style.zIndex="-1",t.style.opacity="0",t.style.width="0px !important",t.style.height="0px !important",t.setAttribute("hidden","")}new Map,window.addEventListener("keydown",(t=>{t.repeat||function(t){for(const e of i)t.code===e[0]&&e[1].forEach((e=>e(t)))}(t),function(t){for(const e of o)t.code===e[0]&&e[1].forEach((e=>e(t)))}(t)})),window.addEventListener("keyup",(t=>{for(const e of s)t.code===e[0]&&e[1].forEach((e=>e(t)))}))},3164:(t,e,n)=>{n.d(e,{getFileExtension:()=>s,removeFilePath:()=>o});var i=n(2843);function o(t){const e=/(?:.*[\\/])([^\\/]+)$/.exec(t);return e&&e.length>1?e[1]:t}function s(t){if((0,i.isNullOrEmpty)(t))return"";const e=t.split(".").pop();if(e&&e!==t)return e;const n=t.split("/").pop();return n&&n!==t?n:""}},2843:(t,e,n)=>{function i(t){return"string"!=typeof t||!t||""===t}function o(t){return t.replace(/%20/g," ")}n.d(e,{isNullOrEmpty:()=>i,replacePercentEncoding:()=>o})}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i=n(7353);AudioTools=i})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R3JCLElBQUlDLEVBQVNMLEVBQXlCRSxHQUFZLENBR2pERSxRQUFTLENBQUMsR0FPWCxPQUhBRSxFQUFvQkosR0FBVUcsRUFBUUEsRUFBT0QsUUFBU0gsR0FHL0NJLEVBQU9ELE9BQ2YsQ0NyQkFILEVBQW9CTSxFQUFLRixJQUN4QixJQUFJRyxFQUFTSCxHQUFVQSxFQUFPSSxXQUM3QixJQUFPSixFQUFpQixRQUN4QixJQUFNLEVBRVAsT0FEQUosRUFBb0JTLEVBQUVGLEVBQVEsQ0FBRUcsRUFBR0gsSUFDNUJBLENBQU0sRUNMZFAsRUFBb0JTLEVBQUksQ0FBQ04sRUFBU1EsS0FDakMsSUFBSSxJQUFJaEUsS0FBT2dFLEVBQ1hYLEVBQW9CWSxFQUFFRCxFQUFZaEUsS0FBU3FELEVBQW9CWSxFQUFFVCxFQUFTeEQsSUFDNUVrRSxPQUFPQyxlQUFlWCxFQUFTeEQsRUFBSyxDQUFFb0UsWUFBWSxFQUFNeEcsSUFBS29HLEVBQVdoRSxJQUUxRSxFQ05EcUQsRUFBb0JZLEVBQUksQ0FBQ0ksRUFBS0MsSUFBVUosT0FBTzlGLFVBQVVtRyxlQUFlQyxLQUFLSCxFQUFLQyxHQ0NsRmpCLEVBQW9Cb0IsRUFBS2pCLElBQ0gsb0JBQVhrQixRQUEwQkEsT0FBT0MsYUFDMUNULE9BQU9DLGVBQWVYLEVBQVNrQixPQUFPQyxZQUFhLENBQUU1RSxNQUFPLFdBRTdEbUUsT0FBT0MsZUFBZVgsRUFBUyxhQUFjLENBQUV6RCxPQUFPLEdBQU8sRUNGOUQsSUFBSTZFLEVBQXNCdkIsRUFBb0IsTSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9Db21wb25lbnRzL0F1ZGlvQ29tcG9uZW50LnRzIiwid2VicGFjazovLy8uL3NyYy9Db21wb25lbnRzL0F1ZGlvQ29tcG9uZW50RmFjdG9yeS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvQ29tcG9uZW50cy9Db21wb25lbnRDb250YWluZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NvbXBvbmVudHMvVHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0V4dGVuc2lvbnMvU3RyaW5nRXh0ZW5zaW9ucy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvRXh0cmFzL09iamVjdEV2ZW50TGlzdGVuZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Rvb2xzL0F1ZGlvVG9vbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Rvb2xzL0RPTVRvb2xzLnRzIiwid2VicGFjazovLy8uL3NyYy9Ub29scy9GaWxlVG9vbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Rvb2xzL1N0cmluZ1Rvb2xzLnRzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly8vd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9iamVjdEV2ZW50TGlzdGVuZXIgfSBmcm9tICcuLi9FeHRyYXMvT2JqZWN0RXZlbnRMaXN0ZW5lcic7XHJcbmltcG9ydCB7IHNvdXJjZUVsZW1lbnRIVE1MIH0gZnJvbSAnLi4vVG9vbHMvQXVkaW9Ub29scyc7XHJcbmltcG9ydCB7IGNyZWF0ZUludmlzaWJsZURpdkFib3ZlUGFyZW50LCBnZXRFbGVtZW50RGltZW5zaW9ucywgc2V0QXR0cmlidXRlTGlzdEZvckVsZW1lbnQgfSBmcm9tICcuLi9Ub29scy9ET01Ub29scyc7XHJcbmltcG9ydCB7IHJlbW92ZUZpbGVQYXRoIH0gZnJvbSAnLi4vVG9vbHMvRmlsZVRvb2xzJztcclxuaW1wb3J0IHsgRGltZW5zaW9ucyB9IGZyb20gJy4uL1Rvb2xzL01hdGhUb29scyc7XHJcbmltcG9ydCB7IHJlbW92ZVNwZWNpYWxDaGFyYWN0ZXJzLCByZXBsYWNlUGVyY2VudEVuY29kaW5nIH0gZnJvbSAnLi4vVG9vbHMvU3RyaW5nVG9vbHMnO1xyXG5pbXBvcnQgeyBBdWRpb0NvbXBvbmVudEZhY3RvcnkgfSBmcm9tICcuL0F1ZGlvQ29tcG9uZW50RmFjdG9yeSc7XHJcbmltcG9ydCB7IElNZWRpYVBsYXllckZ1bmN0aW9ucywgTWVkaWFQbGF5ZXIgfSBmcm9tICcuL1R5cGVzJztcclxuXHJcbmV4cG9ydCB0eXBlIEF1ZGlvQ29tcG9uZW50T3B0aW9ucyA9IHtcclxuICBzcmM6IHN0cmluZztcclxuICBhdWRpb0VsZW1lbnQ6IEhUTUxBdWRpb0VsZW1lbnQ7XHJcbiAgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcclxuICBhdWRpb0VsZW1lbnRJZD86IHN0cmluZztcclxuICBibG9ja0ludGVyYWN0aW9uPzogYm9vbGVhbjtcclxuICBzdGFydHNBdD86IG51bWJlcjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIENyZWF0ZUF1ZGlvQ29tcG9uZW50T3B0aW9ucyA9IHtcclxuICBzcmM6IHN0cmluZztcclxuICBhdWRpb0VsZW1lbnRJZD86IHN0cmluZztcclxuICBibG9ja0ludGVyYWN0aW9uPzogYm9vbGVhbjtcclxuICBjb250YWluZXI/OiBIVE1MRWxlbWVudDtcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBBdWRpb0NvbXBvbmVudCBleHRlbmRzIE1lZGlhUGxheWVyIHtcclxuICBwdWJsaWMgc3JjOiBzdHJpbmc7XHJcbiAgcHVibGljIGF1ZGlvRWxlbWVudDogSFRNTEF1ZGlvRWxlbWVudDtcclxuICBwcml2YXRlIF9jb250YWluZXI6IEhUTUxFbGVtZW50O1xyXG5cclxuICBwcml2YXRlIF9zdGFydHNBdDogbnVtYmVyO1xyXG5cclxuICBwcm90ZWN0ZWQgX2Jsb2NrSW50ZXJhY3Rpb246IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwcm90ZWN0ZWQgX2RpdkJsb2NrSW50ZXJhY3Rpb246IEhUTUxFbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3Rvciggb3B0aW9uczogQXVkaW9Db21wb25lbnRPcHRpb25zICkge1xyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICB0aGlzLnNyYyA9IG9wdGlvbnMuc3JjO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gb3B0aW9ucy5jb250YWluZXI7XHJcbiAgICB0aGlzLmF1ZGlvRWxlbWVudCA9IG9wdGlvbnMuYXVkaW9FbGVtZW50O1xyXG4gICAgdGhpcy5fYmxvY2tJbnRlcmFjdGlvbiA9IG9wdGlvbnMuYmxvY2tJbnRlcmFjdGlvbiA/IHRydWUgOiBmYWxzZTtcclxuXHJcbiAgICBpZiAoIG9wdGlvbnMuYXVkaW9FbGVtZW50SWQgKSB7XHJcbiAgICAgIHRoaXMuYXVkaW9FbGVtZW50LmlkID0gb3B0aW9ucy5hdWRpb0VsZW1lbnRJZDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9zdGFydHNBdCA9IG9wdGlvbnMuc3RhcnRzQXQgPz8gMDtcclxuXHJcbiAgICB0aGlzLmF1ZGlvRWxlbWVudC5jbGFzc0xpc3QuYWRkKCAnYXVkaW8tY29tcG9uZW50JyApO1xyXG4gICAgdGhpcy5hdWRpb0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2VuZGVkJywgKCkgPT4ge1xyXG4gICAgICB0aGlzLnN0b3AoKTtcclxuICAgIH0gKTtcclxuXHJcbiAgICBpZiAoICF0aGlzLl9jb250YWluZXIuaWQgKSB7XHJcbiAgICAgIHRoaXMuX2NvbnRhaW5lci5pZCA9IG9wdGlvbnMuYXVkaW9FbGVtZW50SWQgKyAnQXVkaW9Db21wb25lbnRDb250YWluZXInO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoICdhdWRpby1jb21wb25lbnQtY29udGFpbmVyJyApO1xyXG5cclxuICAgIHRoaXMuX2RpdkJsb2NrSW50ZXJhY3Rpb24gPSB0aGlzLmdldEludmlzaWJsZURpdkJsb2NrSW50ZXJhY3Rpb24oIHRoaXMgKTtcclxuICAgIHRoaXMuc2V0dXBJbnZpc2libGVEaXZCbG9ja0ludGVyYWN0aW9uKCk7XHJcbiAgICB0aGlzLnNldEVsZW1lbnRzQXR0cmlidXRlcygpO1xyXG4gIH1cclxuXHJcbiAgZGVzdHJveSgpIHtcclxuICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBpc1BsYXlpbmcoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gIXRoaXMuYXVkaW9FbGVtZW50LnBhdXNlZDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgaWQoIHZhbDogc3RyaW5nICkge1xyXG4gICAgdGhpcy5hdWRpb0VsZW1lbnQuaWQgPSB2YWw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGlkKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5hdWRpb0VsZW1lbnQuaWQ7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldCBfdmlkZW9JbmZvQXR0cmlidXRlTGlzdCgpOiBbc3RyaW5nLCBzdHJpbmddW10ge1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgWydhdWRpby1jb21wb25lbnQtc3JjJywgdGhpcy5zcmNdLFxyXG4gICAgICBbJ2F1ZGlvLWNvbXBvbmVudC1uYW1lJywgdGhpcy5uYW1lXVxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgbmFtZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHJlcGxhY2VQZXJjZW50RW5jb2RpbmcoIHJlbW92ZUZpbGVQYXRoKCB0aGlzLnNyYyApICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldEVsZW1lbnRzQXR0cmlidXRlcygpIHtcclxuICAgIHNldEF0dHJpYnV0ZUxpc3RGb3JFbGVtZW50KCB0aGlzLmF1ZGlvRWxlbWVudCwgdGhpcy5fdmlkZW9JbmZvQXR0cmlidXRlTGlzdCApO1xyXG4gICAgc2V0QXR0cmlidXRlTGlzdEZvckVsZW1lbnQoIHRoaXMuY29udGFpbmVyLCB0aGlzLl92aWRlb0luZm9BdHRyaWJ1dGVMaXN0ICk7XHJcbiAgICBzZXRBdHRyaWJ1dGVMaXN0Rm9yRWxlbWVudCggdGhpcy5kaXZCbG9ja0ludGVyYWN0aW9uLCB0aGlzLl92aWRlb0luZm9BdHRyaWJ1dGVMaXN0ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGRpdkJsb2NrSW50ZXJhY3Rpb24oKTogSFRNTEVsZW1lbnQge1xyXG4gICAgcmV0dXJuIHRoaXMuX2RpdkJsb2NrSW50ZXJhY3Rpb247XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGNvbnRhaW5lcigpOiBIVE1MRWxlbWVudCB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29udGFpbmVyO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBwYXVzZWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5hdWRpb0VsZW1lbnQucGF1c2VkO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBmaWxlTmFtZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuYXVkaW9FbGVtZW50LnNyYyB8fCB0aGlzLmF1ZGlvRWxlbWVudC5xdWVyeVNlbGVjdG9yKCAnc291cmNlJyApPy5zcmMgfHwgJyc7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHN0YXJ0c0F0KCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5fc3RhcnRzQXQ7XHJcbiAgfVxyXG5cclxuXHJcbiAgcHVibGljIHNldCBwbGF5ZXJDdXJyZW50VGltZSggdDogbnVtYmVyICkge1xyXG4gICAgdGhpcy5hdWRpb0VsZW1lbnQuY3VycmVudFRpbWUgPSB0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBwbGF5ZXJDdXJyZW50VGltZSgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuYXVkaW9FbGVtZW50LmN1cnJlbnRUaW1lO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBjdXJyZW50VGltZSgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMucGxheWVyQ3VycmVudFRpbWUgLSB0aGlzLnN0YXJ0c0F0O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldCBjdXJyZW50VGltZSggdDogbnVtYmVyICkge1xyXG4gICAgdGhpcy5zZWVrKCB0ICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHNvdXJjZUVsZW1lbnRzKCk6IEhUTUxTb3VyY2VFbGVtZW50W10ge1xyXG4gICAgcmV0dXJuIEFycmF5LmZyb20oIHRoaXMuYXVkaW9FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoICdzb3VyY2UnICkgKSBhcyBIVE1MU291cmNlRWxlbWVudFtdO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNoYW5nZVNvdXJjZSggc3JjOiBzdHJpbmcsIG5ld0lkOiBzdHJpbmcgKSB7XHJcbiAgICB0aGlzLmlkID0gbmV3SWQ7XHJcbiAgICB0aGlzLnNyYyA9IHNyYztcclxuICAgIHRoaXMuYXVkaW9FbGVtZW50LmlubmVySFRNTCA9IHNvdXJjZUVsZW1lbnRIVE1MKCB0aGlzLnNyYyApO1xyXG4gICAgdGhpcy5hdWRpb0VsZW1lbnQubG9hZCgpO1xyXG4gICAgdGhpcy5zZXRFbGVtZW50c0F0dHJpYnV0ZXMoKTtcclxuICAgIHRoaXMuc3RvcCgpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHBsYXlXaXRob3V0VHJpZ2dlckV2ZW50cygpIHtcclxuICAgIHZhciBwbGF5UHJvbWlzZSA9IHRoaXMuYXVkaW9FbGVtZW50LnBsYXkoKTtcclxuXHJcbiAgICBpZiAoIHBsYXlQcm9taXNlICE9PSB1bmRlZmluZWQgKSB7XHJcbiAgICAgIHBsYXlQcm9taXNlLnRoZW4oIF8gPT4geyB9IClcclxuICAgICAgICAuY2F0Y2goICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgIH0gKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnNldENsYXNzZXNQbGF5aW5nKCk7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBwYXVzZVdpdGhvdXRUcmlnZ2VyRXZlbnRzKCkge1xyXG4gICAgdGhpcy5hdWRpb0VsZW1lbnQucGF1c2UoKTtcclxuICAgIHRoaXMuc2V0Q2xhc3Nlc1BhdXNlZCgpO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBzZXRDbGFzc2VzUGxheWluZygpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCAnYXVkaW8tY29tcG9uZW50LXBsYXlpbmcnICk7XHJcbiAgICB0aGlzLl9kaXZCbG9ja0ludGVyYWN0aW9uLmNsYXNzTGlzdC5hZGQoICdhdWRpby1jb21wb25lbnQtcGxheWluZycgKTtcclxuXHJcbiAgICB0aGlzLl9jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSggJ2F1ZGlvLWNvbXBvbmVudC1wYXVzZWQnICk7XHJcbiAgICB0aGlzLl9kaXZCbG9ja0ludGVyYWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoICdhdWRpby1jb21wb25lbnQtcGF1c2VkJyApO1xyXG4gIH1cclxuXHJcbiAgc2V0Q2xhc3Nlc1BhdXNlZCgpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCAnYXVkaW8tY29tcG9uZW50LXBhdXNlZCcgKTtcclxuICAgIHRoaXMuX2RpdkJsb2NrSW50ZXJhY3Rpb24uY2xhc3NMaXN0LmFkZCggJ2F1ZGlvLWNvbXBvbmVudC1wYXVzZWQnICk7XHJcblxyXG4gICAgdGhpcy5fY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoICdhdWRpby1jb21wb25lbnQtcGxheWluZycgKTtcclxuICAgIHRoaXMuX2RpdkJsb2NrSW50ZXJhY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSggJ2F1ZGlvLWNvbXBvbmVudC1wbGF5aW5nJyApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHBsYXkoKSB7XHJcbiAgICB0aGlzLnBsYXlXaXRob3V0VHJpZ2dlckV2ZW50cygpO1xyXG4gICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb25wbGF5JywgdGhpcyApO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcGF1c2UoKSB7XHJcbiAgICB0aGlzLnBhdXNlV2l0aG91dFRyaWdnZXJFdmVudHMoKTtcclxuICAgIHRoaXMuY2FsbEV2ZW50c0J5TmFtZSggJ29ucGF1c2UnLCB0aGlzICk7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdG9wKCkge1xyXG4gICAgdGhpcy5wYXVzZSgpO1xyXG4gICAgdGhpcy5hdWRpb0VsZW1lbnQuY3VycmVudFRpbWUgPSB0aGlzLnN0YXJ0c0F0O1xyXG5cclxuICAgIHRoaXMuY2FsbEV2ZW50c0J5TmFtZSggJ29uc3RvcCcsIHRoaXMgKTtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHRvZ2dsZSgpIHtcclxuICAgIGlmICggdGhpcy5wYXVzZWQgKSB7XHJcbiAgICAgIHRoaXMucGxheVdpdGhvdXRUcmlnZ2VyRXZlbnRzKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnBhdXNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb250b2dnbGUnLCB0aGlzICk7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIG11dGUoKSB7XHJcbiAgICB0aGlzLmF1ZGlvRWxlbWVudC52b2x1bWUgPSAwO1xyXG4gICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb25tdXRlJywgdGhpcyApO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICB1bm11dGUoKSB7XHJcbiAgICB0aGlzLmF1ZGlvRWxlbWVudC52b2x1bWUgPSAxO1xyXG4gICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb251bm11dGUnLCB0aGlzICk7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIHNlZWsoIHNlZWtUaW1lOiBudW1iZXIsIF9yZWxvYWRCdWZmZXI/OiBib29sZWFuICkge1xyXG4gICAgdGhpcy5wbGF5ZXJDdXJyZW50VGltZSA9IHNlZWtUaW1lO1xyXG4gICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb25zZWVrJywgdGhpcyApO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IGRpbWVuc2lvbnMoKTogRGltZW5zaW9ucyB7XHJcbiAgICByZXR1cm4gZ2V0RWxlbWVudERpbWVuc2lvbnMoIHRoaXMuX2NvbnRhaW5lciApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRJbnZpc2libGVEaXZCbG9ja0ludGVyYWN0aW9uKCBhdWRpb0NvbXBvbmVudDogQXVkaW9Db21wb25lbnQgKTogSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3QgZWxlbWVudEludmlzaWJsZURpdiA9IGNyZWF0ZUludmlzaWJsZURpdkFib3ZlUGFyZW50KCB7XHJcbiAgICAgIHBhcmVudEVsZW1lbnQ6IGF1ZGlvQ29tcG9uZW50Ll9jb250YWluZXIsXHJcbiAgICAgIGlkOiBgaW52aXNpYmxlRGl2QmxvY2tJbnRlcmFjdGlvbiR7IGF1ZGlvQ29tcG9uZW50Ll9jb250YWluZXIuaWQgfWAsXHJcbiAgICAgIHBvc2l0aW9uOiB7IHRvcDogMCwgbGVmdDogMCB9LFxyXG4gICAgICBkaW1lbnNpb25zOiB7IHdpZHRoOiBhdWRpb0NvbXBvbmVudC5kaW1lbnNpb25zLndpZHRoLCBoZWlnaHQ6IGF1ZGlvQ29tcG9uZW50LmRpbWVuc2lvbnMuaGVpZ2h0IH1cclxuICAgIH0gKTtcclxuXHJcbiAgICBlbGVtZW50SW52aXNpYmxlRGl2LmNsYXNzTGlzdC5hZGQoICdhdWRpby1jb21wb25lbnQtZGl2LWJsb2NrLWludGVyYWN0aW9uJyApO1xyXG5cclxuICAgIHJldHVybiBlbGVtZW50SW52aXNpYmxlRGl2O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldHVwSW52aXNpYmxlRGl2QmxvY2tJbnRlcmFjdGlvbigpIHtcclxuICAgIHRoaXMuX2RpdkJsb2NrSW50ZXJhY3Rpb24uc3R5bGUuZGlzcGxheSA9IHRoaXMuX2Jsb2NrSW50ZXJhY3Rpb24gPyAnYmxvY2snIDogJ25vbmUnO1xyXG4gICAgdGhpcy5fZGl2QmxvY2tJbnRlcmFjdGlvbi5zdHlsZS56SW5kZXggPSAnOTk1JztcclxuXHJcbiAgICB0aGlzLl9kaXZCbG9ja0ludGVyYWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoICdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb25jbGlja2ludGVyYWN0aW9uYmxvY2tlZCcsIHRoaXMsIHRoaXMuX2RpdkJsb2NrSW50ZXJhY3Rpb24gKTtcclxuICAgICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb25pbnRlcmFjdGlvbmJsb2NrZWQnLCB0aGlzLCB0aGlzLl9kaXZCbG9ja0ludGVyYWN0aW9uICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG5cclxuICAvLyBhd2FpdHMgYXVkaW8gbG9hZHMgZnJvbSBzb3VyY2UgdGhlbiBjcmVhdGVzIHRoZSBjb21wb25lbnRcclxuICBwdWJsaWMgc3RhdGljIGFzeW5jIGNyZWF0ZUF1ZGlvQ29tcG9uZW50T25Cb2R5KCBvcHRpb25zOiBDcmVhdGVBdWRpb0NvbXBvbmVudE9wdGlvbnMgKTogUHJvbWlzZTxBdWRpb0NvbXBvbmVudD4ge1xyXG4gICAgY29uc3QgYXVkaW9Db21wb25lbnRDb250YWluZXIgPSBhd2FpdCBuZXcgQXVkaW9Db21wb25lbnRGYWN0b3J5KCBvcHRpb25zLnNyYyApLmJ1aWxkT25Cb2R5KCk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBBdWRpb0NvbXBvbmVudCgge1xyXG4gICAgICBzcmM6IG9wdGlvbnMuc3JjLFxyXG4gICAgICBjb250YWluZXI6IGF1ZGlvQ29tcG9uZW50Q29udGFpbmVyLFxyXG4gICAgICBhdWRpb0VsZW1lbnQ6IGF1ZGlvQ29tcG9uZW50Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoICdhdWRpbycgKSEsXHJcbiAgICAgIGF1ZGlvRWxlbWVudElkOiBvcHRpb25zLmF1ZGlvRWxlbWVudElkLFxyXG4gICAgICBibG9ja0ludGVyYWN0aW9uOiBvcHRpb25zLmJsb2NrSW50ZXJhY3Rpb25cclxuICAgIH0gKTtcclxuICB9XHJcblxyXG4gIC8vIGF3YWl0cyBhdWRpbyBsb2FkcyBmcm9tIHNvdXJjZSB0aGVuIGNyZWF0ZXMgdGhlIGNvbXBvbmVudFxyXG4gIHB1YmxpYyBzdGF0aWMgYXN5bmMgY3JlYXRlQXVkaW9Db21wb25lbnQoIG9wdGlvbnM6IENyZWF0ZUF1ZGlvQ29tcG9uZW50T3B0aW9ucyApOiBQcm9taXNlPEF1ZGlvQ29tcG9uZW50PiB7XHJcbiAgICBpZiAoIG9wdGlvbnMuY29udGFpbmVyID09PSBkb2N1bWVudC5ib2R5IHx8ICFvcHRpb25zLmNvbnRhaW5lciApIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQXVkaW9Db21wb25lbnRPbkJvZHkoIG9wdGlvbnMgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhdWRpb0NvbXBvbmVudENvbnRhaW5lciA9IGF3YWl0IG5ldyBBdWRpb0NvbXBvbmVudEZhY3RvcnkoIG9wdGlvbnMuc3JjICkuYnVpbGQoIG9wdGlvbnMuY29udGFpbmVyICk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBBdWRpb0NvbXBvbmVudCgge1xyXG4gICAgICBzcmM6IG9wdGlvbnMuc3JjLFxyXG4gICAgICBjb250YWluZXI6IGF1ZGlvQ29tcG9uZW50Q29udGFpbmVyLFxyXG4gICAgICBhdWRpb0VsZW1lbnQ6IGF1ZGlvQ29tcG9uZW50Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoICdhdWRpbycgKSEsXHJcbiAgICAgIGF1ZGlvRWxlbWVudElkOiBvcHRpb25zLmF1ZGlvRWxlbWVudElkLFxyXG4gICAgICBibG9ja0ludGVyYWN0aW9uOiBvcHRpb25zLmJsb2NrSW50ZXJhY3Rpb25cclxuICAgIH0gKTtcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBBdWRpb1BsYXllckNvbmZpZywgY3JlYXRlSW52aXNpYmxlUGxheWVyIH0gZnJvbSAnLi4vVG9vbHMvQXVkaW9Ub29scyc7XHJcbmltcG9ydCB7IENvbXBvbmVudENvbnRhaW5lciB9IGZyb20gJy4vQ29tcG9uZW50Q29udGFpbmVyJztcclxuXHJcbmV4cG9ydCBjbGFzcyBBdWRpb0NvbXBvbmVudEZhY3RvcnkgZXh0ZW5kcyBDb21wb25lbnRDb250YWluZXIge1xyXG4gIGNvbnN0cnVjdG9yKCBzcmM6IHN0cmluZywgcGxheWVyQ29uZmlnPzogQXVkaW9QbGF5ZXJDb25maWcgKSB7XHJcbiAgICBzdXBlciggXCJhdWRpb0NvbXBvbmVudFwiLCBjcmVhdGVJbnZpc2libGVQbGF5ZXIoIFtzcmNdLCBwbGF5ZXJDb25maWcgKSApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGFzeW5jIGJ1aWxkU3ViQ29tcG9uZW50cyggcGFyZW50OiBIVE1MRWxlbWVudCApOiBQcm9taXNlPEhUTUxFbGVtZW50W10gfCB2b2lkPiB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG59IiwiZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbXBvbmVudENvbnRhaW5lciB7XHJcbiAgcHJvdGVjdGVkIF9lbGVtZW50OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG4gIHB1YmxpYyB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgcHVibGljIHJlYWRvbmx5IGNvbXBvbmVudE5hbWU6IHN0cmluZztcclxuICBwcm90ZWN0ZWQgc3ViQ29tcG9uZW50Q291bnRCeU5hbWU6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XHJcbiAgcHJvdGVjdGVkIHN1YkNvbXBvbmVudHM6IEhUTUxFbGVtZW50W10gPSBbXTtcclxuXHJcbiAgLy8vIFRlbXBsYXRlIGlzIGVpdGhlciBhIGlkIGZvciBhIGh0bWwgdGVtcGxhdGUgZWxlbWVudCBvciBhbiBlbGVtZW50IHRoYXQgd2lsbCBiZSBpbnNlcnRlZCBhcyBhIHRlbXBsYXRlIGluc2lkZSBkb2N1bWVudC5ib2R5XHJcbiAgY29uc3RydWN0b3IoIGNvbXBvbmVudE5hbWU6IHN0cmluZywgdGVtcGxhdGU6IHN0cmluZyB8IEhUTUxFbGVtZW50ICkge1xyXG4gICAgaWYgKCB0eXBlb2YgdGVtcGxhdGUgPT09ICdzdHJpbmcnICkge1xyXG4gICAgICBjb25zdCB0ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggdGVtcGxhdGUgKSBhcyBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG5cclxuICAgICAgaWYgKCAhdGVtcGxhdGVFbGVtZW50ICkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvciggXCJJbnZhbGlkIHRlbXBsYXRlIGZvciBzY2VuZSBjb21wb25lbnQuIFRlbXBsYXRlIGlkOiBcIiArIHRlbXBsYXRlICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gdGVtcGxhdGVFbGVtZW50O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcInRlbXBsYXRlXCIgKTtcclxuICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudC5hcHBlbmRDaGlsZCggdGVtcGxhdGUgKTtcclxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggdGhpcy50ZW1wbGF0ZUVsZW1lbnQgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNvbXBvbmVudE5hbWUgPSBjb21wb25lbnROYW1lO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGdldFRlbXBsYXRlQ2xvbmVOb2RlcygpOiBIVE1MQ29sbGVjdGlvbiB7XHJcbiAgICByZXR1cm4gKCB0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LmNsb25lTm9kZSggdHJ1ZSApIGFzIERvY3VtZW50RnJhZ21lbnQgKS5jaGlsZHJlbjtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBhYnN0cmFjdCBidWlsZFN1YkNvbXBvbmVudHMoIHBhcmVudDogSFRNTEVsZW1lbnQgKTogUHJvbWlzZTxIVE1MRWxlbWVudFtdIHwgdm9pZD47XHJcblxyXG4gIHByb3RlY3RlZCBhc3luYyBidWlsZFNpbmdsZVN1YkNvbXBvbmVudCggY29tcG9uZW50OiBDb21wb25lbnRDb250YWluZXIsIHBhcmVudDogSFRNTEVsZW1lbnQgKTogUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xyXG4gICAgaWYgKCB0aGlzLnN1YkNvbXBvbmVudENvdW50QnlOYW1lLmhhcyggdGhpcy5jb21wb25lbnROYW1lICkgKSB7XHJcbiAgICAgIHRoaXMuc3ViQ29tcG9uZW50Q291bnRCeU5hbWUuc2V0KCB0aGlzLmNvbXBvbmVudE5hbWUsIDAgKTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgY29tcG9uZW50Q291bnQgPSB0aGlzLnN1YkNvbXBvbmVudENvdW50QnlOYW1lLmdldCggdGhpcy5jb21wb25lbnROYW1lICkhO1xyXG5cclxuICAgIHRoaXMuc3ViQ29tcG9uZW50Q291bnRCeU5hbWUuc2V0KCB0aGlzLmNvbXBvbmVudE5hbWUsIGNvbXBvbmVudENvdW50ICsgMSApO1xyXG5cclxuICAgIHJldHVybiBhd2FpdCBjb21wb25lbnQuYnVpbGQoIHBhcmVudCwgYCR7IHRoaXMuY29tcG9uZW50TmFtZSB9JHsgY29tcG9uZW50LmNvbXBvbmVudE5hbWUuY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKCkgfSR7IGNvbXBvbmVudENvdW50IH1gICk7XHJcbiAgfVxyXG5cclxuICAvLy8gR2V0cyB0aGUgdGVtcGxhdGUgbm9kZXMgYW5kIGluc2VydCB0aGVtIGludG8gYSBjb250YWluZXIgdGhlbiByZXR1cm5zIHRoZSBjb250YWluZXJcclxuICBwdWJsaWMgYXN5bmMgYnVpbGRPbkJvZHkoIGVsZW1lbnRJZD86IHN0cmluZyApOiBQcm9taXNlPEhUTUxFbGVtZW50PiB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcclxuXHJcbiAgICBpZiAoIGVsZW1lbnRJZCApIHtcclxuICAgICAgdGhpcy5fZWxlbWVudC5pZCA9IGVsZW1lbnRJZDtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKCBsZXQgaXRlbSBvZiB0aGlzLmdldFRlbXBsYXRlQ2xvbmVOb2RlcygpICkge1xyXG4gICAgICB0aGlzLl9lbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudCggJ2FmdGVyYmVnaW4nLCBpdGVtICk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCAhdGhpcy5fZWxlbWVudCApIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCBgRmFpbCBidWlsZGluZyBTY2VuZUNvbXBvbmVudC4gRWxlbWVudElkOiAkeyBlbGVtZW50SWQgfWAgKTtcclxuICAgIH1cclxuXHJcbiAgICBhd2FpdCB0aGlzLmJ1aWxkU3ViQ29tcG9uZW50cyggZG9jdW1lbnQuYm9keSApO1xyXG5cclxuICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCAnYmVmb3JlZW5kJywgdGhpcy5fZWxlbWVudCApO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgLy8vIEdldHMgdGhlIHRlbXBsYXRlIG5vZGVzIGFuZCBpbnNlcnQgdGhlbSBpbnRvIGEgY29udGFpbmVyIHRoZW4gcmV0dXJucyB0aGUgY29udGFpbmVyXHJcbiAgcHVibGljIGFzeW5jIGJ1aWxkKCBjb250YWluZXI6IEhUTUxFbGVtZW50LCBlbGVtZW50SWQ/OiBzdHJpbmcgKTogUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xyXG4gICAgZm9yICggbGV0IGl0ZW0gb2YgdGhpcy5nZXRUZW1wbGF0ZUNsb25lTm9kZXMoKSApIHtcclxuICAgICAgY29udGFpbmVyLmluc2VydEFkamFjZW50RWxlbWVudCggJ2FmdGVyYmVnaW4nLCBpdGVtICk7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdGhpcy5idWlsZFN1YkNvbXBvbmVudHMoIGNvbnRhaW5lciApO1xyXG5cclxuICAgIHJldHVybiBjb250YWluZXI7XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgT2JqZWN0RXZlbnRMaXN0ZW5lciB9IGZyb20gJy4uL0V4dHJhcy9PYmplY3RFdmVudExpc3RlbmVyJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU1lZGlhUGxheWVyRnVuY3Rpb25zIHtcclxuICBwbGF5KCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBwYXVzZSgpOiBJTWVkaWFQbGF5ZXJGdW5jdGlvbnM7XHJcbiAgdG9nZ2xlKCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBzZWVrKCBzZWVrVGltZTogbnVtYmVyLCByZWxvYWRCdWZmZXI/OiBib29sZWFuICk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBtdXRlKCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICB1bm11dGUoKTogSU1lZGlhUGxheWVyRnVuY3Rpb25zO1xyXG4gIHBsYXlXaXRob3V0VHJpZ2dlckV2ZW50cygpOiBJTWVkaWFQbGF5ZXJGdW5jdGlvbnM7XHJcbiAgcGF1c2VXaXRob3V0VHJpZ2dlckV2ZW50cygpOiBJTWVkaWFQbGF5ZXJGdW5jdGlvbnM7XHJcbiAgZGVzdHJveSgpOiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTWVkaWFQbGF5ZXIgZXh0ZW5kcyBPYmplY3RFdmVudExpc3RlbmVyIGltcGxlbWVudHMgSU1lZGlhUGxheWVyRnVuY3Rpb25zIHtcclxuICBwdWJsaWMgYWJzdHJhY3QgaWQ6IHN0cmluZztcclxuICBwdWJsaWMgYWJzdHJhY3QgbmFtZTogc3RyaW5nO1xyXG4gIHB1YmxpYyBhYnN0cmFjdCBpc1BsYXlpbmc6IGJvb2xlYW47XHJcbiAgcHVibGljIGFic3RyYWN0IHN0YXJ0c0F0OiBudW1iZXI7XHJcbiAgcHVibGljIGFic3RyYWN0IGN1cnJlbnRUaW1lOiBudW1iZXI7XHJcbiAgcHVibGljIGFic3RyYWN0IHBsYXllckN1cnJlbnRUaW1lOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICB9XHJcblxyXG4gIGFic3RyYWN0IHBsYXkoKTogSU1lZGlhUGxheWVyRnVuY3Rpb25zO1xyXG4gIGFic3RyYWN0IHBhdXNlKCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBhYnN0cmFjdCB0b2dnbGUoKTogSU1lZGlhUGxheWVyRnVuY3Rpb25zO1xyXG4gIGFic3RyYWN0IHNlZWsoIHNlZWtUaW1lOiBudW1iZXIsIHJlbG9hZEJ1ZmZlcj86IGJvb2xlYW4gKTogSU1lZGlhUGxheWVyRnVuY3Rpb25zO1xyXG4gIGFic3RyYWN0IG11dGUoKTogSU1lZGlhUGxheWVyRnVuY3Rpb25zO1xyXG4gIGFic3RyYWN0IHVubXV0ZSgpOiBJTWVkaWFQbGF5ZXJGdW5jdGlvbnM7XHJcbiAgYWJzdHJhY3QgcGxheVdpdGhvdXRUcmlnZ2VyRXZlbnRzKCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBhYnN0cmFjdCBwYXVzZVdpdGhvdXRUcmlnZ2VyRXZlbnRzKCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBhYnN0cmFjdCBkZXN0cm95KCk6IHZvaWQ7XHJcbn1cclxuIiwiXHJcbmludGVyZmFjZSBTdHJpbmcge1xyXG4gIHRydW5jYXRlKCBtYXg6IG51bWJlciwgZGVjb3JhdG9yOiBzdHJpbmcgKTogc3RyaW5nO1xyXG4gIHJlbW92ZUFjY2VudHMoKTogc3RyaW5nO1xyXG4gIGNhcGl0YWxpemVGaXJzdExldHRlcigpOiBzdHJpbmc7XHJcbiAgemVyb0JlZm9yZSgpOiBzdHJpbmc7XHJcbiAgaXNOdWxsT3JFbXB0eSgpOiBib29sZWFuO1xyXG59XHJcblxyXG5TdHJpbmcucHJvdG90eXBlLmlzTnVsbE9yRW1wdHkgPSBmdW5jdGlvbiAoKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHR5cGVvZiB0aGlzICE9PSAnc3RyaW5nJyAmJiAhdGhpcyAmJiB0aGlzICE9PSAnJztcclxufTtcclxuXHJcblN0cmluZy5wcm90b3R5cGUudHJ1bmNhdGUgPSBmdW5jdGlvbiAoIG1heDogbnVtYmVyLCBkZWNvcmF0b3I6IHN0cmluZyA9ICcuLi4nICk6IHN0cmluZyB7XHJcbiAgcmV0dXJuICggdGhpcy5sZW5ndGggPiBtYXggPyB0aGlzLnN1YnN0cmluZyggMCwgbWF4ICkgKyBkZWNvcmF0b3IgOiB0aGlzICkudG9TdHJpbmcoKTtcclxufTtcclxuXHJcblN0cmluZy5wcm90b3R5cGUucmVtb3ZlQWNjZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICByZXR1cm4gdGhpcy5ub3JtYWxpemUoICdORkQnICkucmVwbGFjZSggL1tcXHUwMzAwLVxcdTAzNmZdL2csIFwiXCIgKTtcclxufVxyXG5cclxuU3RyaW5nLnByb3RvdHlwZS5jYXBpdGFsaXplRmlyc3RMZXR0ZXIgPSBmdW5jdGlvbiAoKTogc3RyaW5nIHtcclxuICBpZiAoIHR5cGVvZiB0aGlzICE9PSAnc3RyaW5nJyApIHtcclxuICAgIHJldHVybiAnJztcclxuICB9XHJcblxyXG4gIHJldHVybiB0aGlzLmNoYXJBdCggMCApLnRvVXBwZXJDYXNlKCkgKyB0aGlzLnN1YnN0cmluZyggMSApO1xyXG59XHJcblxyXG5TdHJpbmcucHJvdG90eXBlLnplcm9CZWZvcmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgcmV0dXJuIHRoaXMucGFkU3RhcnQoIDIsICcwJyApO1xyXG59IiwiZXhwb3J0IHR5cGUgRXZlbnRMaXN0ZW5lciA9IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIGV2ZW50OiBGdW5jdGlvbjtcclxufTtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgT2JqZWN0RXZlbnRMaXN0ZW5lciB7XHJcbiAgcHVibGljIGV2ZW50c0J5TmFtZTogTWFwPHN0cmluZywgRXZlbnRMaXN0ZW5lcltdPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgcHVibGljIGFkZEV2ZW50TGlzdGVuZXIoIGV2ZW50TmFtZTogc3RyaW5nLCBldmVudDogRnVuY3Rpb24gKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IG5ld0V2ZW50OiBFdmVudExpc3RlbmVyID0ge1xyXG4gICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcclxuICAgICAgZXZlbnQ6IGV2ZW50LFxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoICF0aGlzLmV2ZW50c0J5TmFtZS5oYXMoIGV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpICkgKSB7XHJcbiAgICAgIHRoaXMuZXZlbnRzQnlOYW1lLnNldCggZXZlbnROYW1lLnRvTG93ZXJDYXNlKCksIFtuZXdFdmVudF0gKTtcclxuICAgICAgcmV0dXJuIG5ld0V2ZW50LmlkO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZXZlbnRzQnlOYW1lLmdldCggZXZlbnROYW1lLnRvTG93ZXJDYXNlKCkgKSEucHVzaCggbmV3RXZlbnQgKTtcclxuXHJcbiAgICByZXR1cm4gbmV3RXZlbnQuaWQ7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0RXZlbnRzQnlOYW1lKCBldmVudE5hbWU6IHN0cmluZyApOiBFdmVudExpc3RlbmVyW10ge1xyXG4gICAgaWYgKCAhdGhpcy5ldmVudHNCeU5hbWUuaGFzKCBldmVudE5hbWUudG9Mb3dlckNhc2UoKSApICkge1xyXG4gICAgICB0aGlzLmV2ZW50c0J5TmFtZS5zZXQoIGV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpLCBbXSApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLmV2ZW50c0J5TmFtZS5nZXQoIGV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpICkhO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlbW92ZUV2ZW50QnlJZCggZXZlbnRJZDogc3RyaW5nICkge1xyXG4gICAgdGhpcy5ldmVudHNCeU5hbWUuZm9yRWFjaCggKCB2YWx1ZSwga2V5ICkgPT4ge1xyXG4gICAgICB0aGlzLmV2ZW50c0J5TmFtZS5zZXQoIGtleSwgdmFsdWUuZmlsdGVyKCBlID0+IGUuaWQgIT09IGV2ZW50SWQgKSApO1xyXG4gICAgfSApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNhbGxFdmVudHNCeU5hbWUoIGV2ZW50TmFtZTogc3RyaW5nLCAuLi5ldmVudEFyZ3M6IGFueVtdICk6IHZvaWQge1xyXG4gICAgdGhpcy5nZXRFdmVudHNCeU5hbWUoIGV2ZW50TmFtZSApLmZvckVhY2goIGUgPT4gZS5ldmVudCggLi4uZXZlbnRBcmdzICkgKTtcclxuICB9XHJcbn0iLCJpbXBvcnQgJy4uL0V4dGVuc2lvbnMvU3RyaW5nRXh0ZW5zaW9ucyc7XHJcbmltcG9ydCB7IGdldEVsZW1lbnRGcm9tSFRNTCwgaGlkZUVsZW1lbnQgfSBmcm9tICcuL0RPTVRvb2xzJztcclxuaW1wb3J0IHsgZ2V0RmlsZUV4dGVuc2lvbiB9IGZyb20gJy4vRmlsZVRvb2xzJztcclxuaW1wb3J0IHsgQXVkaW9Db21wb25lbnQsIENyZWF0ZUF1ZGlvQ29tcG9uZW50T3B0aW9ucyB9IGZyb20gJy4uL0NvbXBvbmVudHMvQXVkaW9Db21wb25lbnQnO1xyXG5cclxuZXhwb3J0IHR5cGUgQXVkaW9QbGF5ZXJDb25maWcgPSB7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbiAgYXV0b1BsYXk/OiBib29sZWFuO1xyXG4gIGF1dG9wbGF5PzogYm9vbGVhbjtcclxuICBtdXRlZD86IGJvb2xlYW47XHJcbiAgbG9vcD86IGJvb2xlYW47XHJcbiAgcHJlbG9hZD86ICdhdXRvJyB8ICdtZXRhZGF0YScgfCAnbm9uZSc7XHJcbiAgb25wbGF5PzogKCBhdWRpb0VsZW1lbnQ6IEhUTUxBdWRpb0VsZW1lbnQgKSA9PiB2b2lkO1xyXG4gIG9ucGF1c2U/OiAoIGF1ZGlvRWxlbWVudDogSFRNTEF1ZGlvRWxlbWVudCApID0+IHZvaWQ7XHJcbiAgb25QbGF5PzogKCBhdWRpb0VsZW1lbnQ6IEhUTUxBdWRpb0VsZW1lbnQgKSA9PiB2b2lkO1xyXG4gIG9uUGF1c2U/OiAoIGF1ZGlvRWxlbWVudDogSFRNTEF1ZGlvRWxlbWVudCApID0+IHZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVBdWRpb0NvbXBvbmVudE9uQm9keSggb3B0aW9uczogQ3JlYXRlQXVkaW9Db21wb25lbnRPcHRpb25zICkge1xyXG4gIHJldHVybiBhd2FpdCBBdWRpb0NvbXBvbmVudC5jcmVhdGVBdWRpb0NvbXBvbmVudE9uQm9keSggb3B0aW9ucyApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSW52aXNpYmxlUGxheWVyKCBhcnJTb3VyY2VzOiBzdHJpbmdbXSwgcGxheWVyQ29uZmlnPzogQXVkaW9QbGF5ZXJDb25maWcgKSB7XHJcbiAgY29uc3QgYXVkaW9FbGVtZW50ID0gZ2V0RWxlbWVudEZyb21IVE1MKCBhdWRpb0VsZW1lbnRIVE1MKCBhcnJTb3VyY2VzLCBwbGF5ZXJDb25maWcgKSApIGFzIEhUTUxFbGVtZW50O1xyXG4gIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCAnYWZ0ZXJiZWdpbicsIGF1ZGlvRWxlbWVudCApO1xyXG4gIGhpZGVFbGVtZW50KCBhdWRpb0VsZW1lbnQgKTtcclxuICByZXR1cm4gYXVkaW9FbGVtZW50O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXVkaW9FbGVtZW50SFRNTCggYXJyU291cmNlczogc3RyaW5nW10sIHBsYXllckNvbmZpZz86IEF1ZGlvUGxheWVyQ29uZmlnICkge1xyXG4gIHJldHVybiBgPGF1ZGlvIGNvbnRyb2xzICR7IHBsYXllckNvbmZpZyA/IGF1ZGlvRWxlbWVudFBhcmFtc0J5UGxheWVyQ29uZmlnKCBwbGF5ZXJDb25maWcgKSA6IFwiXCIgfT5cclxuICAgICR7IGFyclNvdXJjZXMubWFwKCBzcmMgPT4gc291cmNlRWxlbWVudEhUTUwoIHNyYyApICkucmVkdWNlKCAoIGFjYywgbmV4dCApID0+IGFjYyArIG5leHQsICcnICkgfVxyXG4gIDwvYXVkaW8+YDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNvdXJjZUVsZW1lbnRIVE1MKCBzcmM6IHN0cmluZyApIHtcclxuICByZXR1cm4gYDxzb3VyY2Ugc3JjPVwiJHsgc3JjIH1cIiB0eXBlPVwiYXVkaW8vJHsgZ2V0RmlsZUV4dGVuc2lvbiggc3JjICkgfVwiPmA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGF1ZGlvRWxlbWVudFBhcmFtc0J5UGxheWVyQ29uZmlnKCBwbGF5ZXJDb25maWc6IEF1ZGlvUGxheWVyQ29uZmlnICkge1xyXG4gIGNvbnN0IHBhcmFtSWQgPSBwbGF5ZXJDb25maWcuaWQgPyAnaWQ9XCInICsgcGxheWVyQ29uZmlnLmlkICsgJ1wiJyA6ICcnO1xyXG4gIGNvbnN0IHBhcmFtQXV0b1BsYXkgPSBwbGF5ZXJDb25maWcuYXV0b1BsYXkgfHwgcGxheWVyQ29uZmlnLmF1dG9wbGF5ID8gJ2F1dG9wbGF5JyA6ICcnO1xyXG4gIGNvbnN0IHBhcmFtTXV0ZWQgPSBwbGF5ZXJDb25maWcubXV0ZWQgPyAnbXV0ZWQnIDogJyc7XHJcbiAgY29uc3QgcGFyYW1Mb29wID0gcGxheWVyQ29uZmlnLmxvb3AgPyAnbG9vcCcgOiAnJztcclxuICBjb25zdCBwYXJhbVByZWxvYWQgPSBwbGF5ZXJDb25maWcucHJlbG9hZCA/ICdwcmVsb2FkPVwiJyArIHBsYXllckNvbmZpZy5wcmVsb2FkICsgJ1wiJyA6ICcnO1xyXG5cclxuICByZXR1cm4gYCAkeyBwYXJhbUlkIH0gJHsgcGFyYW1BdXRvUGxheSB9ICR7IHBhcmFtTXV0ZWQgfSAkeyBwYXJhbUxvb3AgfSAkeyBwYXJhbVByZWxvYWQgfWAudHJpbUVuZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRQbGF5QnV0dG9uRWxlbWVudCggYXVkaW9FbGVtZW50OiBIVE1MQXVkaW9FbGVtZW50LCBwbGF5ZXJDb25maWc/OiBBdWRpb1BsYXllckNvbmZpZyApIHtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2J1dHRvbicgKTtcclxuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoICdwbGF5LWJ1dHRvbicgKTtcclxuXHJcbiAgc2V0VGltZW91dCggKCkgPT4ge1xyXG4gICAgaWYgKCBhdWRpb0VsZW1lbnQucGF1c2VkICkge1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoICdwYXVzZWQnICk7XHJcbiAgICB9XHJcbiAgfSwgMzAwICk7XHJcblxyXG4gIGJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgaWYgKCBhdWRpb0VsZW1lbnQucGF1c2VkICkge1xyXG4gICAgICBhdWRpb0VsZW1lbnQucGxheSgpO1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoICdwYXVzZWQnICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhdWRpb0VsZW1lbnQucGF1c2UoKTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCAncGF1c2VkJyApO1xyXG4gICAgfVxyXG4gIH0gKTtcclxuXHJcbiAgc2V0QXVkaW9FbGVtZW50UGxheVBhdXNlRXZlbnRzKCBidXR0b25FbGVtZW50LCBhdWRpb0VsZW1lbnQsIHBsYXllckNvbmZpZyApO1xyXG5cclxuICByZXR1cm4gYnV0dG9uRWxlbWVudDtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHNldEF1ZGlvRWxlbWVudFBsYXlQYXVzZUV2ZW50cyggYnV0dG9uRWxlbWVudDogSFRNTEJ1dHRvbkVsZW1lbnQsIGF1ZGlvRWxlbWVudDogSFRNTEF1ZGlvRWxlbWVudCwgcGxheWVyQ29uZmlnPzogQXVkaW9QbGF5ZXJDb25maWcgKSB7XHJcbiAgYXVkaW9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdwbGF5JywgKCkgPT4ge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCAncGF1c2VkJyApO1xyXG4gICAgaWYgKCBwbGF5ZXJDb25maWcgJiYgcGxheWVyQ29uZmlnLm9uUGxheSApIHtcclxuICAgICAgcGxheWVyQ29uZmlnLm9uUGxheSggYXVkaW9FbGVtZW50ICk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCBwbGF5ZXJDb25maWcgJiYgcGxheWVyQ29uZmlnLm9ucGxheSApIHtcclxuICAgICAgcGxheWVyQ29uZmlnLm9ucGxheSggYXVkaW9FbGVtZW50ICk7XHJcbiAgICB9XHJcbiAgfSApO1xyXG5cclxuICBhdWRpb0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3BhdXNlJywgKCkgPT4ge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCAncGF1c2VkJyApO1xyXG4gICAgaWYgKCBwbGF5ZXJDb25maWcgJiYgcGxheWVyQ29uZmlnLm9uUGF1c2UgKSB7XHJcbiAgICAgIHBsYXllckNvbmZpZy5vblBhdXNlKCBhdWRpb0VsZW1lbnQgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIHBsYXllckNvbmZpZyAmJiBwbGF5ZXJDb25maWcub25wYXVzZSApIHtcclxuICAgICAgcGxheWVyQ29uZmlnLm9ucGF1c2UoIGF1ZGlvRWxlbWVudCApO1xyXG4gICAgfVxyXG4gIH0gKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwbGF5QnV0dG9uQ1NTKCkge1xyXG4gIHJldHVybiBgXHJcbiAgICAucGxheS1idXR0b24ge1xyXG4gICAgICBtYXJnaW46IDA7XHJcbiAgICAgIHBhZGRpbmc6IDA7XHJcbiAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgIGJvcmRlcjogMDtcclxuICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XHJcbiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XHJcbiAgICAgIHdpZHRoOiAwO1xyXG4gICAgICBoZWlnaHQ6IDM0cHg7XHJcbiAgICAgIGJvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgIzIwMjAyMDtcclxuICAgICAgdHJhbnNpdGlvbjogMTAwbXMgYWxsIGVhc2U7XHJcbiAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgYm9yZGVyLXN0eWxlOiBkb3VibGU7XHJcbiAgICAgIGJvcmRlci13aWR0aDogMHB4IDAgMHB4IDMwcHg7XHJcbiAgICB9XHJcblxyXG4gICAgLnBsYXktYnV0dG9uLnBhdXNlZCB7XHJcbiAgICAgIGJvcmRlci1zdHlsZTogc29saWQ7XHJcbiAgICAgIGJvcmRlci13aWR0aDogMjNweCAwcHggMjNweCAzNHB4O1xyXG4gICAgfVxyXG5cclxuICAgIC5wbGF5LWJ1dHRvbjpob3ZlciB7XHJcbiAgICAgIGJvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgIzQwNDA0MDtcclxuICAgIH1cclxuICBgO1xyXG59XHJcblxyXG5leHBvcnQgeyBDcmVhdGVBdWRpb0NvbXBvbmVudE9wdGlvbnMgfTsiLCJpbXBvcnQgeyBEaW1lbnNpb25zLCBQb2ludDJELCBsZXJwLCByZWdleE51bWJlclBhdHRlcm4sIHJvdGF0ZUNvb3JkaW5hdGVzLCByb3RhdGVDb29yZGluYXRlc0Zyb21Qb2ludDJEIH0gZnJvbSAnLi9NYXRoVG9vbHMnO1xyXG5pbXBvcnQgeyB0b1Bob25lTnVtYmVyIH0gZnJvbSAnLi9TdHJpbmdUb29scyc7XHJcbmltcG9ydCB7IENvbGxpc2lvbkRpcmVjdGlvbkNoZWNrLCBCb3JkZXJEaXN0YW5jZSB9IGZyb20gJy4uL0V4dHJhcy9Db2xsaXNpb25FdmVudHMvVHlwZXMnO1xyXG5cclxuZXhwb3J0IHR5cGUgS2V5Ym9hcmRFdmVudENhbGxiYWNrID0gKCBldnQ6IEtleWJvYXJkRXZlbnQgKSA9PiB2b2lkO1xyXG5leHBvcnQgY29uc3QgcmVnZXhSZW1vdmVUcmFuc2xhdGVGcm9tVHJhbnNmb3JtID0gL3RyYW5zbGF0ZVxcKFteKV0qXFwpL2c7XHJcbmV4cG9ydCBjb25zdCByZWdleEdyb3VwUm90YXRlVmFsdWUgPSAvcm90YXRlXFwoKC0/XFxkK1xcLj9cXGQqKWRlZ1xcKS87XHJcbmV4cG9ydCBjb25zdCByZWdleEdyb3VwUm90YXRlWFZhbHVlID0gL3JvdGF0ZVhcXCgoLT9cXGQrXFwuP1xcZCopZGVnXFwpLztcclxuZXhwb3J0IGNvbnN0IHJlZ2V4R3JvdXBSb3RhdGVZVmFsdWUgPSAvcm90YXRlWVxcKCgtP1xcZCtcXC4/XFxkKilkZWdcXCkvO1xyXG5leHBvcnQgY29uc3QgcmVnZXhHcm91cFJvdGF0ZVpWYWx1ZSA9IC9yb3RhdGVaXFwoKC0/XFxkK1xcLj9cXGQqKWRlZ1xcKS87XHJcblxyXG5leHBvcnQgY29uc3QgZGljdEtleXNCeUFjdGlvbktleWRvd25PbmNlID0gbmV3IE1hcDxzdHJpbmcsIEtleWJvYXJkRXZlbnRDYWxsYmFja1tdPigpO1xyXG5leHBvcnQgY29uc3QgZGljdEtleXNCeUFjdGlvbktleWRvd25SZXBlYXQgPSBuZXcgTWFwPHN0cmluZywgS2V5Ym9hcmRFdmVudENhbGxiYWNrW10+KCk7XHJcbmV4cG9ydCBjb25zdCBkaWN0S2V5c0J5QWN0aW9uS2V5dXAgPSBuZXcgTWFwPHN0cmluZywgS2V5Ym9hcmRFdmVudENhbGxiYWNrW10+KCk7XHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRBY3Rpb25LZXkoIHsga2V5LCBrZXlkb3duOiBldmVudEtleWRvd24sIGtleXVwOiBldmVudEtleXVwLCBleGVjdXRlT25seU9uY2UgPSB0cnVlIH06IHsga2V5OiBzdHJpbmc7IGtleWRvd246IEtleWJvYXJkRXZlbnRDYWxsYmFjazsga2V5dXA/OiBLZXlib2FyZEV2ZW50Q2FsbGJhY2s7IGV4ZWN1dGVPbmx5T25jZT86IGJvb2xlYW47IH0gKSB7XHJcbiAgaWYgKCBleGVjdXRlT25seU9uY2UgKSB7XHJcbiAgICBhZGRBY3Rpb25LZXlSdW5PbmNlKCBrZXksIGV2ZW50S2V5ZG93biwgZXZlbnRLZXl1cCApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgYWRkQWN0aW9uS2V5UnVuT25SZXBlYXQoIGtleSwgZXZlbnRLZXlkb3duLCBldmVudEtleXVwICk7XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIFNhZmVQcm9taXNlPFQ+ID0ge1xyXG4gIGRhdGE6ICgpID0+IFQ7XHJcbiAgZXJyb3I6IEVycm9yIHwgbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVByb21pc2U8VD4oIHByb21pc2U6IFByb21pc2U8VD4gKTogUHJvbWlzZTxTYWZlUHJvbWlzZTxUPj4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcHJvbWlzZTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBkYXRhOiAoKSA9PiBkYXRhLFxyXG4gICAgICBlcnJvcjogbnVsbFxyXG4gICAgfTtcclxuICB9IGNhdGNoICggZXJyb3IgKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCBlcnJvciApO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGRhdGE6ICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCBcIkNvdWxkbid0IGZldGNoLCBjaGVjayBTYWZlUHJvbWlzZS5lcnJvciBmb3IgZGV0YWlscy5cIiApOyB9LFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKCBTdHJpbmcoIGVycm9yICkgKVxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkWW91dHViZVVybE9ySWQoIGlucHV0OiBzdHJpbmcgKTogYm9vbGVhbiB7XHJcbiAgY29uc3QgdXJsUGF0dGVybiA9IC9eKGh0dHAocyk/OlxcL1xcLyk/KCh3KXszfS4pP3lvdXR1KGJlfC5iZSk/KFxcLmNvbSk/XFwvLisvO1xyXG4gIGNvbnN0IGlkUGF0dGVybiA9IC9eW2EtekEtWjAtOV8tXXsxMX0kLztcclxuXHJcbiAgcmV0dXJuIHVybFBhdHRlcm4udGVzdCggaW5wdXQgKSB8fCBpZFBhdHRlcm4udGVzdCggaW5wdXQgKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkWW91VHViZVVybCggdXJsOiBzdHJpbmcgKTogYm9vbGVhbiB7XHJcbiAgY29uc3QgcGF0dGVybiA9IC9eKGh0dHAocyk/OlxcL1xcLyk/KCh3KXszfS4pP3lvdXR1KGJlfC5iZSk/KFxcLmNvbSk/XFwvLisvO1xyXG4gIHJldHVybiBwYXR0ZXJuLnRlc3QoIHVybCApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFlvdVR1YmVJZCggaW5wdXQ6IHN0cmluZyApOiBzdHJpbmcgfCBudWxsIHtcclxuICBjb25zdCByZWdleCA9IC9bPyZddj0oW14/Jl0rKS87XHJcbiAgY29uc3QgbWF0Y2ggPSBpbnB1dC5tYXRjaCggcmVnZXggKTtcclxuICBpZiAoIG1hdGNoICYmIG1hdGNoWzFdICkge1xyXG4gICAgcmV0dXJuIG1hdGNoWzFdO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBJZiBkaXJlY3QgdmlkZW8gSUQgaXMgcHJvdmlkZWRcclxuICAgIHJldHVybiBpbnB1dC5sZW5ndGggPT09IDExID8gaW5wdXQgOiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRBdHRyaWJ1dGVMaXN0Rm9yRWxlbWVudCggZWxlbWVudDogSFRNTEVsZW1lbnQsIGF0dHJMaXN0OiBbc3RyaW5nLCBzdHJpbmddW10gKSB7XHJcbiAgYXR0ckxpc3QuZm9yRWFjaCggKCBba2V5LCB2YWxdICkgPT4ge1xyXG4gICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoIGtleSwgdmFsICk7XHJcbiAgfSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RWxlbWVudEZyb21IVE1MKCBodG1sOiBzdHJpbmcsIHRyaW06IGJvb2xlYW4gPSB0cnVlICkge1xyXG4gIGh0bWwgPSB0cmltID8gaHRtbC50cmltKCkgOiBodG1sO1xyXG5cclxuICBpZiAoICFodG1sICkge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0ZW1wbGF0ZScgKTtcclxuICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBodG1sO1xyXG4gIGNvbnN0IHJlc3VsdCA9IHRlbXBsYXRlLmNvbnRlbnQuY2hpbGRyZW47XHJcblxyXG4gIGlmICggcmVzdWx0Lmxlbmd0aCA9PT0gMSApIHtcclxuICAgIHJldHVybiByZXN1bHRbMF0gYXMgSFRNTEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gQXJyYXkuZnJvbSggcmVzdWx0ICkgYXMgSFRNTEVsZW1lbnRbXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnREaW1lbnNpb25zQnlJZCggZWxlbWVudElkOiBzdHJpbmcgKTogRGltZW5zaW9ucyB7XHJcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBlbGVtZW50SWQgKTtcclxuXHJcbiAgaWYgKCAhZWxlbWVudCApIHtcclxuICAgIHRocm93IG5ldyBFcnJvciggXCJJbnZhbGlkIGVsZW1lbnQgYXQgZ2V0RWxlbWVudERpbWVuc2lvbnNCeUlkIHdpdGggaWQ6IFwiICsgZWxlbWVudElkICk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZ2V0RWxlbWVudERpbWVuc2lvbnMoIGVsZW1lbnQgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnREaW1lbnNpb25zKCBlbGVtZW50OiBIVE1MRWxlbWVudCApOiBEaW1lbnNpb25zIHtcclxuICB2YXIgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB3aWR0aDogcmVjdC53aWR0aCxcclxuICAgIGhlaWdodDogcmVjdC5oZWlnaHRcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSb3RhdGVkQm91bmRpbmdCb3hCYXNlZE9uQm9keVJvdGF0aW9uKCBlbGVtZW50OiBIVE1MRWxlbWVudCApOiBET01SZWN0IHtcclxuICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICBjb25zdCBjZW50ZXJYID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAvIDI7XHJcbiAgY29uc3QgY2VudGVyWSA9IHJlY3QudG9wICsgcmVjdC5oZWlnaHQgLyAyO1xyXG5cclxuICAvLyBSb3RhdGlvbiBhbmdsZSBpbiBkZWdyZWVzIChleHRyYWN0ZWQgZnJvbSBzdHlsZS50cmFuc2Zvcm0gb3IgYW55IG90aGVyIHNvdXJjZSlcclxuICBjb25zdCByb3RhdGlvbkFuZ2xlID0gZ2V0Qm9keVJvdGF0aW9uSW5EZWdyZWVzKCk7XHJcblxyXG4gIGNvbnN0IHJhZGlhbnMgPSAoIE1hdGguUEkgLyAxODAgKSAqIHJvdGF0aW9uQW5nbGU7XHJcbiAgY29uc3QgY29zVGhldGEgPSBNYXRoLmNvcyggcmFkaWFucyApO1xyXG4gIGNvbnN0IHNpblRoZXRhID0gTWF0aC5zaW4oIHJhZGlhbnMgKTtcclxuXHJcbiAgLy8gQ2FsY3VsYXRlIHRoZSByb3RhdGVkIGNvb3JkaW5hdGVzXHJcbiAgY29uc3Qgcm90YXRlZFgxID0gY2VudGVyWCArICggcmVjdC5sZWZ0IC0gY2VudGVyWCApICogY29zVGhldGEgLSAoIHJlY3QudG9wIC0gY2VudGVyWSApICogc2luVGhldGE7XHJcbiAgY29uc3Qgcm90YXRlZFkxID0gY2VudGVyWSArICggcmVjdC5sZWZ0IC0gY2VudGVyWCApICogc2luVGhldGEgKyAoIHJlY3QudG9wIC0gY2VudGVyWSApICogY29zVGhldGE7XHJcblxyXG4gIGNvbnN0IHJvdGF0ZWRYMiA9IGNlbnRlclggKyAoIHJlY3QucmlnaHQgLSBjZW50ZXJYICkgKiBjb3NUaGV0YSAtICggcmVjdC5ib3R0b20gLSBjZW50ZXJZICkgKiBzaW5UaGV0YTtcclxuICBjb25zdCByb3RhdGVkWTIgPSBjZW50ZXJZICsgKCByZWN0LnJpZ2h0IC0gY2VudGVyWCApICogc2luVGhldGEgKyAoIHJlY3QuYm90dG9tIC0gY2VudGVyWSApICogY29zVGhldGE7XHJcblxyXG4gIC8vIENhbGN1bGF0ZSBsZWZ0LCB0b3AsIGJvdHRvbSwgYW5kIHJpZ2h0IGNvb3JkaW5hdGVzXHJcbiAgY29uc3Qgcm90YXRlZExlZnQgPSBNYXRoLm1pbiggcm90YXRlZFgxLCByb3RhdGVkWDIgKTtcclxuICBjb25zdCByb3RhdGVkVG9wID0gTWF0aC5taW4oIHJvdGF0ZWRZMSwgcm90YXRlZFkyICk7XHJcbiAgY29uc3Qgcm90YXRlZEJvdHRvbSA9IE1hdGgubWF4KCByb3RhdGVkWTEsIHJvdGF0ZWRZMiApO1xyXG4gIGNvbnN0IHJvdGF0ZWRSaWdodCA9IE1hdGgubWF4KCByb3RhdGVkWDEsIHJvdGF0ZWRYMiApO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgeDogcm90YXRlZExlZnQsXHJcbiAgICB5OiByb3RhdGVkVG9wLFxyXG4gICAgd2lkdGg6IHJlY3Qud2lkdGgsXHJcbiAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0LFxyXG4gICAgdG9KU09OOiByZWN0LnRvSlNPTixcclxuICAgIGxlZnQ6IHJvdGF0ZWRMZWZ0LFxyXG4gICAgdG9wOiByb3RhdGVkVG9wLFxyXG4gICAgYm90dG9tOiByb3RhdGVkQm90dG9tLFxyXG4gICAgcmlnaHQ6IHJvdGF0ZWRSaWdodCxcclxuICB9IGFzIERPTVJlY3Q7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZEFjdGlvbktleVJ1bk9uY2UoIGtleTogc3RyaW5nLCBldmVudEtleWRvd246IEtleWJvYXJkRXZlbnRDYWxsYmFjaywgZXZlbnRLZXl1cD86IEtleWJvYXJkRXZlbnRDYWxsYmFjayApIHtcclxuICBpZiAoIGRpY3RLZXlzQnlBY3Rpb25LZXlkb3duT25jZS5oYXMoIGtleSApICkge1xyXG4gICAgZGljdEtleXNCeUFjdGlvbktleWRvd25PbmNlLnNldCgga2V5LCBbZXZlbnRLZXlkb3duLCAuLi5kaWN0S2V5c0J5QWN0aW9uS2V5ZG93bk9uY2UuZ2V0KCBrZXkgKSFdIClcclxuICB9IGVsc2Uge1xyXG4gICAgZGljdEtleXNCeUFjdGlvbktleWRvd25PbmNlLnNldCgga2V5LCBbZXZlbnRLZXlkb3duXSApXHJcbiAgfVxyXG5cclxuICBpZiAoIGV2ZW50S2V5dXAgKSB7XHJcbiAgICBpZiAoIGRpY3RLZXlzQnlBY3Rpb25LZXl1cC5oYXMoIGtleSApICkge1xyXG4gICAgICBkaWN0S2V5c0J5QWN0aW9uS2V5dXAuc2V0KCBrZXksIFtldmVudEtleXVwLCAuLi5kaWN0S2V5c0J5QWN0aW9uS2V5dXAuZ2V0KCBrZXkgKSFdIClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRpY3RLZXlzQnlBY3Rpb25LZXl1cC5zZXQoIGtleSwgW2V2ZW50S2V5dXBdIClcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZEFjdGlvbktleVJ1bk9uUmVwZWF0KCBrZXk6IHN0cmluZywgZXZlbnRLZXlkb3duOiBLZXlib2FyZEV2ZW50Q2FsbGJhY2ssIGV2ZW50S2V5dXA/OiBLZXlib2FyZEV2ZW50Q2FsbGJhY2sgKSB7XHJcbiAgaWYgKCBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93blJlcGVhdC5oYXMoIGtleSApICkge1xyXG4gICAgZGljdEtleXNCeUFjdGlvbktleWRvd25SZXBlYXQuc2V0KCBrZXksIFtldmVudEtleWRvd24sIC4uLmRpY3RLZXlzQnlBY3Rpb25LZXlkb3duUmVwZWF0LmdldCgga2V5ICkhXSApXHJcbiAgfSBlbHNlIHtcclxuICAgIGRpY3RLZXlzQnlBY3Rpb25LZXlkb3duUmVwZWF0LnNldCgga2V5LCBbZXZlbnRLZXlkb3duXSApXHJcbiAgfVxyXG5cclxuICBpZiAoIGV2ZW50S2V5dXAgKSB7XHJcbiAgICBpZiAoIGRpY3RLZXlzQnlBY3Rpb25LZXl1cC5oYXMoIGtleSApICkge1xyXG4gICAgICBkaWN0S2V5c0J5QWN0aW9uS2V5dXAuc2V0KCBrZXksIFtldmVudEtleXVwLCAuLi5kaWN0S2V5c0J5QWN0aW9uS2V5dXAuZ2V0KCBrZXkgKSFdIClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRpY3RLZXlzQnlBY3Rpb25LZXl1cC5zZXQoIGtleSwgW2V2ZW50S2V5dXBdIClcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja0VsZW1lbnRDb2xsaXNpb24oIGVsZW1lbnQxOiBIVE1MRWxlbWVudCwgZWxlbWVudDI6IEhUTUxFbGVtZW50LCBjaGVja0JvZHlSb3RhdGlvbjogYm9vbGVhbiA9IGZhbHNlICk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IHJlY3QxID0gIWNoZWNrQm9keVJvdGF0aW9uID8gZWxlbWVudDEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBnZXRSb3RhdGVkQm91bmRpbmdCb3hCYXNlZE9uQm9keVJvdGF0aW9uKCBlbGVtZW50MSApO1xyXG4gIGNvbnN0IHJlY3QyID0gIWNoZWNrQm9keVJvdGF0aW9uID8gZWxlbWVudDIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBnZXRSb3RhdGVkQm91bmRpbmdCb3hCYXNlZE9uQm9keVJvdGF0aW9uKCBlbGVtZW50MiApO1xyXG5cclxuICBjb25zdCByZXN1bHQgPSAhKFxyXG4gICAgcmVjdDEudG9wID4gcmVjdDIuYm90dG9tIHx8XHJcbiAgICByZWN0MS5yaWdodCA8IHJlY3QyLmxlZnQgfHxcclxuICAgIHJlY3QxLmJvdHRvbSA8IHJlY3QyLnRvcCB8fFxyXG4gICAgcmVjdDEubGVmdCA+IHJlY3QyLnJpZ2h0XHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBvbGxGb3JWYXJpYWJsZTxUPiggdmFyaWFibGVOYW1lOiBzdHJpbmcsIHJlYWR5Q29uZGl0aW9uOiAoIHZhbHVlOiBUICkgPT4gYm9vbGVhbiwgY2FsbGJhY2s6ICggdmFsdWU6IFQgKSA9PiB2b2lkICkge1xyXG4gIGNvbnN0IHBvbGxJbnRlcnZhbCA9IDEwMDtcclxuICBjb25zdCBwb2xsID0gc2V0SW50ZXJ2YWwoICgpID0+IHtcclxuICAgIGlmICggKCB3aW5kb3cgYXMgYW55IClbdmFyaWFibGVOYW1lXSAhPT0gdW5kZWZpbmVkICYmIHJlYWR5Q29uZGl0aW9uKCAoIHdpbmRvdyBhcyBhbnkgKVt2YXJpYWJsZU5hbWVdICkgKSB7XHJcbiAgICAgIC8vIElmIGJvdGggY29uZGl0aW9ucyBhcmUgbWV0LCBleGVjdXRlIHRoZSBjYWxsYmFjayBhbmQgc3RvcCBwb2xsaW5nXHJcbiAgICAgIGNsZWFySW50ZXJ2YWwoIHBvbGwgKTtcclxuICAgICAgY2FsbGJhY2soICggd2luZG93IGFzIGFueSApW3ZhcmlhYmxlTmFtZV0gKTtcclxuICAgIH1cclxuICB9LCBwb2xsSW50ZXJ2YWwgKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBvbGxGb3JWYXJpYWJsZUFzeW5jPFQ+KCB2YXJpYWJsZU5hbWU6IHN0cmluZywgcmVhZHlDb25kaXRpb246ICggdmFsdWU6IFQgKSA9PiBib29sZWFuLCBjYWxsYmFjazogKCB2YWx1ZTogVCApID0+IHZvaWQgKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgY29uc3QgcG9sbEludGVydmFsID0gMTAwO1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPiggKCByZXNvbHZlICkgPT4ge1xyXG4gICAgY29uc3QgcG9sbCA9IHNldEludGVydmFsKCAoKSA9PiB7XHJcbiAgICAgIGlmICggKCB3aW5kb3cgYXMgYW55IClbdmFyaWFibGVOYW1lXSAhPT0gdW5kZWZpbmVkICYmIHJlYWR5Q29uZGl0aW9uKCAoIHdpbmRvdyBhcyBhbnkgKVt2YXJpYWJsZU5hbWVdICkgKSB7XHJcbiAgICAgICAgLy8gSWYgYm90aCBjb25kaXRpb25zIGFyZSBtZXQsIGV4ZWN1dGUgdGhlIGNhbGxiYWNrLCBzdG9wIHBvbGxpbmcsIGFuZCByZXNvbHZlIHRoZSBwcm9taXNlXHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbCggcG9sbCApO1xyXG4gICAgICAgIGNhbGxiYWNrKCAoIHdpbmRvdyBhcyBhbnkgKVt2YXJpYWJsZU5hbWVdICk7XHJcbiAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9LCBwb2xsSW50ZXJ2YWwgKTtcclxuICB9ICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3YWl0VW50aWxFbGVtZW50RXhpc3RzKCBzZWxlY3Rvcjogc3RyaW5nICkge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSggcmVzb2x2ZSA9PiB7XHJcbiAgICBpZiAoIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIHNlbGVjdG9yICkgKSB7XHJcbiAgICAgIHJldHVybiByZXNvbHZlKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzZWxlY3RvciApICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlciggbXV0YXRpb25zID0+IHtcclxuICAgICAgaWYgKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzZWxlY3RvciApICkge1xyXG4gICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICByZXNvbHZlKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzZWxlY3RvciApICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICBvYnNlcnZlci5vYnNlcnZlKCBkb2N1bWVudC5ib2R5LCB7XHJcbiAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgc3VidHJlZTogdHJ1ZVxyXG4gICAgfSApO1xyXG4gIH0gKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGF5KCBtczogbnVtYmVyICk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSggcmVzb2x2ZSA9PiBzZXRUaW1lb3V0KCByZXNvbHZlLCBtcyApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlRWxlbWVudCggZWxlbWVudFRvUmVtb3ZlOiBIVE1MRWxlbWVudCwgcGFyZW50RWxlbWVudDogSFRNTEVsZW1lbnQsIG5ld0VsZW1lbnQ6IEhUTUxFbGVtZW50ICk6IHZvaWQge1xyXG4gIGlmICggcGFyZW50RWxlbWVudCAmJiBlbGVtZW50VG9SZW1vdmUgKSB7XHJcbiAgICBwYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKCBlbGVtZW50VG9SZW1vdmUgKTtcclxuXHJcbiAgICBwYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZSggbmV3RWxlbWVudCwgZWxlbWVudFRvUmVtb3ZlLm5leHRTaWJsaW5nICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0RWxlbWVudEF0SW5kZXgoIHBhcmVudEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBuZXdFbGVtZW50OiBIVE1MRWxlbWVudCwgaW5kZXg6IG51bWJlciApOiB2b2lkIHtcclxuICBjb25zdCBjaGlsZE5vZGVzID0gcGFyZW50RWxlbWVudC5jaGlsZE5vZGVzO1xyXG5cclxuICBpZiAoIGluZGV4ID49IDAgJiYgaW5kZXggPD0gY2hpbGROb2Rlcy5sZW5ndGggKSB7XHJcbiAgICBpZiAoIGluZGV4ID09PSBjaGlsZE5vZGVzLmxlbmd0aCApIHtcclxuICAgICAgcGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZCggbmV3RWxlbWVudCApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgcmVmTm9kZSA9IGNoaWxkTm9kZXNbaW5kZXhdO1xyXG4gICAgICBwYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZSggbmV3RWxlbWVudCwgcmVmTm9kZSApO1xyXG4gICAgfVxyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCAnSW5kZXggb3V0IG9mIGJvdW5kcycgKTtcclxuICAgIHRocm93IG5ldyBFcnJvciggXCJJbmRleCBvdXQgb2YgYm91bmRzXCIgKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRJbmRleEluUGFyZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCApOiBudW1iZXIge1xyXG4gIGNvbnN0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuXHJcbiAgaWYgKCBwYXJlbnQgKSB7XHJcbiAgICBjb25zdCBjaGlsZHJlbiA9IEFycmF5LmZyb20oIHBhcmVudC5jaGlsZHJlbiApO1xyXG4gICAgcmV0dXJuIGNoaWxkcmVuLmluZGV4T2YoIGVsZW1lbnQgKTtcclxuICB9XHJcblxyXG4gIHJldHVybiAtMTtcclxufVxyXG5cclxuLy8vIEdldCB0aGUgZGVmYXVsdCBhdHRyaWJ1dGVzIGZyb20gdGhlIHRhcmdldCBlbGVtZW50XHJcbi8vLyBJZiBoYXZlIG5vdCBkZWZhdWx0IGF0dHJpYnV0ZSB3aXRoIHRoaXMgQGF0dHJpYnV0ZU5hbWUgb24gbWFwIHdpbGwgc2V0IHRoZSBjdXJyZW50IGF0dHJpYnV0ZSBhcyBkZWZhdWx0XHJcbi8vLyBJZiBoYXZlIG5vdCBkZWZhdWx0IGF0dHJpYnV0ZSB3aXRoIHRoaXMgQGF0dHJpYnV0ZU5hbWUgd2lsbCByZXR1cm4gYW4gZW1wdHkgc3RyaW5nXHJcbmV4cG9ydCBjb25zdCBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudCA9IG5ldyBNYXA8SFRNTEVsZW1lbnQsIE1hcDxzdHJpbmcsIHN0cmluZz4+KCk7XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0QXR0cmlidXRlRm9yVGFyZ2V0KCB0YXJnZXQ6IEhUTUxFbGVtZW50LCBhdHRyaWJ1dGVOYW1lOiBzdHJpbmcgKTogc3RyaW5nIHtcclxuICBpZiAoICFtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5oYXMoIHRhcmdldCApICkge1xyXG4gICAgbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuc2V0KCB0YXJnZXQsIG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCkgKTtcclxuICB9XHJcblxyXG4gIGxldCByZXN1bHQ6IHN0cmluZyA9ICcnO1xyXG4gIGNvbnN0IGRlZmF1bHRBdHRyaWJ1dGVWYWx1ZXNCeU5hbWUgPSBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5nZXQoIHRhcmdldCApITtcclxuICBjb25zdCB0YXJnZXREZWZhdWx0QXR0cmlidXRlID0gIWRlZmF1bHRBdHRyaWJ1dGVWYWx1ZXNCeU5hbWUuaGFzKCBhdHRyaWJ1dGVOYW1lICkgPyB0YXJnZXQuZ2V0QXR0cmlidXRlKCBhdHRyaWJ1dGVOYW1lICkgOiBkZWZhdWx0QXR0cmlidXRlVmFsdWVzQnlOYW1lLmdldCggYXR0cmlidXRlTmFtZSApITtcclxuXHJcbiAgcmVzdWx0ID0gdGFyZ2V0RGVmYXVsdEF0dHJpYnV0ZSA/IHRhcmdldERlZmF1bHRBdHRyaWJ1dGUgOiAnJztcclxuICBzZXREZWZhdWx0QXR0cmlidXRlRm9yVGFyZ2V0KCB0YXJnZXQsIGF0dHJpYnV0ZU5hbWUsIHJlc3VsdCApO1xyXG5cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0RGVmYXVsdEF0dHJpYnV0ZUZvclRhcmdldCggdGFyZ2V0OiBIVE1MRWxlbWVudCwgYXR0cmlidXRlTmFtZTogc3RyaW5nLCBuZXdEZWZhdWx0QXR0cmlidXRlOiBzdHJpbmcgKTogdm9pZCB7XHJcbiAgaWYgKCAhbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuaGFzKCB0YXJnZXQgKSApIHtcclxuICAgIG1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50LnNldCggdGFyZ2V0LCBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpICk7XHJcbiAgfVxyXG5cclxuICBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5nZXQoIHRhcmdldCApIS5zZXQoIGF0dHJpYnV0ZU5hbWUsIG5ld0RlZmF1bHRBdHRyaWJ1dGUgKTtcclxufVxyXG5cclxuLy8vIERpdmlkZSBvIGVsZW1lbnRvIEB0YXJnZXQgZW0gOSBcInF1YWRyYWRvc1wiIGlndWFpcyBlIHJldG9ybmEgZW0gcXVhaXMgcXVhZHJhZG9zIG8gZHJhZ2dhYmxlIGVzdMOhIGNvbGlkaW5kbyBjb20gbyB0YXJnZXRcclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbGxpc2lvbkRpcmVjdGlvbiggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCwgY2hlY2tCb2R5Um90YXRpb246IGJvb2xlYW4gPSBmYWxzZSApOiBDb2xsaXNpb25EaXJlY3Rpb25DaGVjayB7XHJcbiAgY29uc3QgcmVjdDEgPSAhY2hlY2tCb2R5Um90YXRpb24gPyBkcmFnZ2FibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBnZXRSb3RhdGVkQm91bmRpbmdCb3hCYXNlZE9uQm9keVJvdGF0aW9uKCBkcmFnZ2FibGUgKTtcclxuICBjb25zdCByZWN0MiA9ICFjaGVja0JvZHlSb3RhdGlvbiA/IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IGdldFJvdGF0ZWRCb3VuZGluZ0JveEJhc2VkT25Cb2R5Um90YXRpb24oIHRhcmdldCApO1xyXG5cclxuICBjb25zdCBpc1RvcCA9IHJlY3QxLmJvdHRvbSA+IHJlY3QyLnRvcCAmJiByZWN0MS50b3AgPCByZWN0Mi50b3AgKyByZWN0Mi5oZWlnaHQgLyAzO1xyXG4gIGNvbnN0IGlzUmlnaHQgPSByZWN0MS5sZWZ0IDwgcmVjdDIucmlnaHQgJiYgcmVjdDEucmlnaHQgPiByZWN0Mi5yaWdodCAtIHJlY3QyLndpZHRoIC8gMztcclxuICBjb25zdCBpc0NlbnRlciA9IHJlY3QxLnRvcCA8IHJlY3QyLmJvdHRvbSAmJiByZWN0MS5ib3R0b20gPiByZWN0Mi50b3AgJiYgcmVjdDEubGVmdCA8IHJlY3QyLnJpZ2h0ICYmIHJlY3QxLnJpZ2h0ID4gcmVjdDIubGVmdDtcclxuICBjb25zdCBpc0JvdHRvbSA9IHJlY3QxLnRvcCA8IHJlY3QyLmJvdHRvbSAtIHJlY3QyLmhlaWdodCAvIDMgJiYgcmVjdDEuYm90dG9tID4gcmVjdDIuYm90dG9tIC0gcmVjdDIuaGVpZ2h0IC8gMztcclxuICBjb25zdCBpc0xlZnQgPSByZWN0MS5yaWdodCA+IHJlY3QyLmxlZnQgJiYgcmVjdDEubGVmdCA8IHJlY3QyLmxlZnQgKyByZWN0Mi53aWR0aCAvIDM7XHJcblxyXG4gIHJldHVybiB7IHRvcDogaXNUb3AsIHJpZ2h0OiBpc1JpZ2h0LCBjZW50ZXI6IGlzQ2VudGVyLCBib3R0b206IGlzQm90dG9tLCBsZWZ0OiBpc0xlZnQgfTtcclxufVxyXG5cclxuLy8vIHJldHVybiB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgY2VudGVyIG9mIHRoZSBkcmFnZ2FibGUgdG8gdGhlIGNlbnRlciBvZiB0aGUgdGFyZ2V0IGVsZW1lbnQgZnJvbSBlYWNoIGJvcmRlciBcclxuZXhwb3J0IGZ1bmN0aW9uIGdldERpc3RhbmNlRnJvbUJvcmRlciggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCwgY2hlY2tCb2R5Um90YXRpb246IGJvb2xlYW4gPSBmYWxzZSApOiBCb3JkZXJEaXN0YW5jZSB7XHJcbiAgY29uc3QgcmVjdDEgPSAhY2hlY2tCb2R5Um90YXRpb24gPyBkcmFnZ2FibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBnZXRSb3RhdGVkQm91bmRpbmdCb3hCYXNlZE9uQm9keVJvdGF0aW9uKCBkcmFnZ2FibGUgKTtcclxuICBjb25zdCByZWN0MiA9ICFjaGVja0JvZHlSb3RhdGlvbiA/IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IGdldFJvdGF0ZWRCb3VuZGluZ0JveEJhc2VkT25Cb2R5Um90YXRpb24oIHRhcmdldCApO1xyXG5cclxuICBjb25zdCBjZW50ZXIgPSB7XHJcbiAgICB4OiByZWN0MS5sZWZ0ICsgcmVjdDEud2lkdGggLyAyLFxyXG4gICAgeTogcmVjdDEudG9wICsgcmVjdDEuaGVpZ2h0IC8gMixcclxuICB9O1xyXG5cclxuICBjb25zdCBkaXN0YW5jZUZyb21Cb3JkZXI6IEJvcmRlckRpc3RhbmNlID0ge1xyXG4gICAgdG9wOiBjZW50ZXIueSAtIHJlY3QyLnRvcCxcclxuICAgIHJpZ2h0OiByZWN0Mi5yaWdodCAtIGNlbnRlci54LFxyXG4gICAgYm90dG9tOiByZWN0Mi5ib3R0b20gLSBjZW50ZXIueSxcclxuICAgIGxlZnQ6IGNlbnRlci54IC0gcmVjdDIubGVmdCxcclxuICB9O1xyXG5cclxuICByZXR1cm4gZGlzdGFuY2VGcm9tQm9yZGVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBydW5Pbmx5T25jZUtleWRvd25BY3Rpb25zKCBldnQ6IEtleWJvYXJkRXZlbnQgKSB7XHJcbiAgZm9yICggY29uc3QgcGFpciBvZiBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93bk9uY2UgKSB7XHJcbiAgICBpZiAoIGV2dC5jb2RlID09PSBwYWlyWzBdICkge1xyXG4gICAgICBwYWlyWzFdLmZvckVhY2goIGtiRXZlbnQgPT4ga2JFdmVudCggZXZ0ICkgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJ1bktleWRvd25BY3Rpb25zUmVwZWF0KCBldnQ6IEtleWJvYXJkRXZlbnQgKSB7XHJcbiAgZm9yICggY29uc3QgcGFpciBvZiBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93blJlcGVhdCApIHtcclxuICAgIGlmICggZXZ0LmNvZGUgPT09IHBhaXJbMF0gKSB7XHJcbiAgICAgIHBhaXJbMV0uZm9yRWFjaCgga2JFdmVudCA9PiBrYkV2ZW50KCBldnQgKSApO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgZXZ0ID0+IHtcclxuICBpZiAoICFldnQucmVwZWF0ICkge1xyXG4gICAgcnVuT25seU9uY2VLZXlkb3duQWN0aW9ucyggZXZ0ICk7XHJcbiAgfVxyXG5cclxuICBydW5LZXlkb3duQWN0aW9uc1JlcGVhdCggZXZ0ICk7XHJcbn0gKTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5dXAnLCBldnQgPT4ge1xyXG4gIGZvciAoIGNvbnN0IHBhaXIgb2YgZGljdEtleXNCeUFjdGlvbktleXVwICkge1xyXG4gICAgaWYgKCBldnQuY29kZSA9PT0gcGFpclswXSApIHtcclxuICAgICAgcGFpclsxXS5mb3JFYWNoKCBrYkV2ZW50ID0+IGtiRXZlbnQoIGV2dCApICk7XHJcbiAgICB9XHJcbiAgfVxyXG59ICk7XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRSb3RhdGlvbkluRGVncmVlcyggZWxlbWVudDogSFRNTEVsZW1lbnQsIGF4aXM6ICd4JyB8ICd5JyB8ICd6JyA9ICd4JyApOiBudW1iZXIge1xyXG4gIGxldCByZWdleE1hdGNoUm90YXRlVmFsdWU6IFJlZ0V4cDtcclxuICBzd2l0Y2ggKCBheGlzICkge1xyXG4gICAgY2FzZSAneCc6XHJcbiAgICAgIHJlZ2V4TWF0Y2hSb3RhdGVWYWx1ZSA9IHJlZ2V4R3JvdXBSb3RhdGVYVmFsdWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAneSc6XHJcbiAgICAgIHJlZ2V4TWF0Y2hSb3RhdGVWYWx1ZSA9IHJlZ2V4R3JvdXBSb3RhdGVZVmFsdWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAneic6XHJcbiAgICAgIHJlZ2V4TWF0Y2hSb3RhdGVWYWx1ZSA9IHJlZ2V4R3JvdXBSb3RhdGVaVmFsdWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmVnZXhNYXRjaFJvdGF0ZVZhbHVlID0gcmVnZXhHcm91cFJvdGF0ZVZhbHVlO1xyXG4gICAgICBicmVhaztcclxuICB9XHJcblxyXG4gIGNvbnN0IG1hdGNoID0gcmVnZXhNYXRjaFJvdGF0ZVZhbHVlLmV4ZWMoIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtICk7XHJcbiAgaWYgKCBtYXRjaCApIHtcclxuICAgIGNvbnN0IHJvdGF0aW9uVmFsdWUgPSBwYXJzZUZsb2F0KCBtYXRjaFsxXSApO1xyXG4gICAgcmV0dXJuIHJvdGF0aW9uVmFsdWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiAwO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEJvZHlSb3RhdGlvbkluRGVncmVlcygpOiBudW1iZXIge1xyXG4gIGNvbnN0IG1hdGNoID0gZ2V0UmVnZXhSZW1vdmVSb3RhdGlvbkZyb21Cb2R5KCkuZXhlYyggZG9jdW1lbnQuYm9keS5zdHlsZS50cmFuc2Zvcm0gKTtcclxuICBpZiAoIG1hdGNoICkge1xyXG4gICAgY29uc3Qgcm90YXRpb25WYWx1ZSA9IHBhcnNlRmxvYXQoIG1hdGNoWzFdICk7XHJcbiAgICByZXR1cm4gcm90YXRpb25WYWx1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVnZXhSZW1vdmVSb3RhdGlvbkZyb21Cb2R5KCkge1xyXG4gIHJldHVybiBnZXRSZWdleFJlbW92ZVJvdGF0aW9uQmFzZWRPbkF4aXMoIGdldEJvZHlSb3RhdGlvbkF4aXMoKSApXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWdleFJlbW92ZVJvdGF0aW9uQmFzZWRPbkF4aXMoIGF4aXM6ICd4JyB8ICd5JyB8ICd6JyApIHtcclxuICBzd2l0Y2ggKCBheGlzICkge1xyXG4gICAgY2FzZSAneCc6XHJcbiAgICAgIHJldHVybiByZWdleEdyb3VwUm90YXRlWFZhbHVlO1xyXG4gICAgY2FzZSAneSc6XHJcbiAgICAgIHJldHVybiByZWdleEdyb3VwUm90YXRlWVZhbHVlO1xyXG4gICAgY2FzZSAneic6XHJcbiAgICAgIHJldHVybiByZWdleEdyb3VwUm90YXRlWlZhbHVlO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmV0dXJuIHJlZ2V4R3JvdXBSb3RhdGVWYWx1ZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRCb2R5Um90YXRpb25BeGlzKCk6ICd4JyB8ICd5JyB8ICd6JyB7XHJcbiAgcmV0dXJuIGdldEVsZW1lbnRSb3RhdGlvbkF4aXMoIGRvY3VtZW50LmJvZHkgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRSb3RhdGlvbkF4aXMoIGVsZW1lbnQ6IEhUTUxFbGVtZW50ICk6ICd4JyB8ICd5JyB8ICd6JyB7XHJcbiAgY29uc3QgZWxlbWVudFRyYW5zZm9ybSA9IGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtLnRvTG93ZXJDYXNlKCk7XHJcbiAgaWYgKCBlbGVtZW50VHJhbnNmb3JtLmluY2x1ZGVzKCAneCcgKSApIHtcclxuICAgIHJldHVybiAneCc7XHJcbiAgfSBlbHNlIGlmICggZWxlbWVudFRyYW5zZm9ybS5pbmNsdWRlcyggJ3knICkgKSB7XHJcbiAgICByZXR1cm4gJ3knO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gJ3onO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRyYW5zZm9ybUNvb3Jkc0Zyb21FbGVtZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCwgY2hlY2tCb2R5Um90YXRpb246IGJvb2xlYW4gPSBmYWxzZSApOiBQb2ludDJEIHtcclxuICBjb25zdCBhcnJDb21wdXRlZERyYWdnYWJsZVRyYW5zbGF0ZSA9ICggd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGVsZW1lbnQgKS50cmFuc2Zvcm0ubWF0Y2goIHJlZ2V4TnVtYmVyUGF0dGVybiApID8/IFswLCAwXSApLm1hcCggbiA9PiArbiApO1xyXG5cclxuICBsZXQgcmVzdWx0ID0ge1xyXG4gICAgeDogYXJyQ29tcHV0ZWREcmFnZ2FibGVUcmFuc2xhdGVbNF0gIT09IHVuZGVmaW5lZCA/IE1hdGgucm91bmQoIGFyckNvbXB1dGVkRHJhZ2dhYmxlVHJhbnNsYXRlWzRdICkgOiAwLFxyXG4gICAgeTogYXJyQ29tcHV0ZWREcmFnZ2FibGVUcmFuc2xhdGVbNV0gIT09IHVuZGVmaW5lZCA/IE1hdGgucm91bmQoIGFyckNvbXB1dGVkRHJhZ2dhYmxlVHJhbnNsYXRlWzVdICkgOiAwXHJcbiAgfVxyXG5cclxuICBpZiAoIGNoZWNrQm9keVJvdGF0aW9uICkge1xyXG4gICAgY29uc3QgYm9keUFuZ2xlID0gZ2V0RWxlbWVudFJvdGF0aW9uSW5EZWdyZWVzKCBkb2N1bWVudC5ib2R5LCBnZXRFbGVtZW50Um90YXRpb25BeGlzKCBlbGVtZW50ICkgKSB8fCAwO1xyXG4gICAgcmV0dXJuIHJvdGF0ZUNvb3JkaW5hdGVzKCByZXN1bHQueCwgcmVzdWx0LnksIGJvZHlBbmdsZSApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsaWNrRXZlbnRUb0Nvb3JkaW5hdGVzKCBldmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQgKSB7XHJcbiAgaWYgKCBldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiBldmVudC5jbGllbnRYLFxyXG4gICAgICB5OiBldmVudC5jbGllbnRZXHJcbiAgICB9O1xyXG4gIH0gZWxzZSBpZiAoIGV2ZW50IGluc3RhbmNlb2YgVG91Y2hFdmVudCApIHtcclxuICAgIGNvbnN0IHRvdWNoID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiB0b3VjaC5jbGllbnRYLFxyXG4gICAgICB5OiB0b3VjaC5jbGllbnRZXHJcbiAgICB9O1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aHJvdyBcIkV2ZW50IG5vdCBGb3VuZFwiO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnZpc2libGVEaXZBYm92ZVBhcmVudCggeyBwYXJlbnRFbGVtZW50LCBpZCwgcG9zaXRpb24sIGRpbWVuc2lvbnMgfTogeyBwYXJlbnRFbGVtZW50OiBIVE1MRWxlbWVudDsgaWQ6IHN0cmluZzsgcG9zaXRpb24/OiB7IHRvcDogbnVtYmVyOyBsZWZ0OiBudW1iZXI7IH07IGRpbWVuc2lvbnM/OiBEaW1lbnNpb25zOyB9ICkge1xyXG4gIHZhciBpbnZpc2libGVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG5cclxuICBpZiAoICFwYXJlbnRFbGVtZW50LnN0eWxlLnBvc2l0aW9uICkge1xyXG4gICAgcGFyZW50RWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcbiAgfVxyXG5cclxuICBpbnZpc2libGVEaXYuaWQgPSBpZDtcclxuICBpbnZpc2libGVEaXYuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gIGludmlzaWJsZURpdi5zdHlsZS53aWR0aCA9IGRpbWVuc2lvbnMgJiYgZGltZW5zaW9ucy53aWR0aCA/IGRpbWVuc2lvbnMud2lkdGgudG9TdHJpbmcoKSArICdweCcgOiAnMTAwJSc7XHJcbiAgaW52aXNpYmxlRGl2LnN0eWxlLmhlaWdodCA9IGRpbWVuc2lvbnMgJiYgZGltZW5zaW9ucy5oZWlnaHQgPyBkaW1lbnNpb25zLmhlaWdodC50b1N0cmluZygpICsgJ3B4JyA6ICcxMDAlJztcclxuICBpbnZpc2libGVEaXYuc3R5bGUudG9wID0gKCBwb3NpdGlvbj8udG9wLnRvU3RyaW5nKCkgPz8gJzAnICkgKyAncHgnO1xyXG4gIGludmlzaWJsZURpdi5zdHlsZS5sZWZ0ID0gKCBwb3NpdGlvbj8ubGVmdC50b1N0cmluZygpID8/ICcwJyApICsgJ3B4JztcclxuICBpbnZpc2libGVEaXYuc3R5bGUub3BhY2l0eSA9ICcwJzsgLy8gTWFrZSB0aGUgZGl2IGludmlzaWJsZVxyXG4gIGludmlzaWJsZURpdi5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nOyAvLyBBbGxvdyB0aGUgZGl2IHRvIGludGVyY2VwdCBtb3VzZSBldmVudHNcclxuXHJcbiAgcGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZCggaW52aXNpYmxlRGl2ICk7XHJcblxyXG4gIHJldHVybiBpbnZpc2libGVEaXY7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoaWRlRWxlbWVudCggZWxlbWVudDogSFRNTEVsZW1lbnQgKSB7XHJcbiAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICBlbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICBlbGVtZW50LnN0eWxlLnpJbmRleCA9ICctMSc7XHJcbiAgZWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG4gIGVsZW1lbnQuc3R5bGUud2lkdGggPSAnMHB4ICFpbXBvcnRhbnQnO1xyXG4gIGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzBweCAhaW1wb3J0YW50JztcclxuICBlbGVtZW50LnNldEF0dHJpYnV0ZSggJ2hpZGRlbicsICcnICk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzbGVlcEFzeW5jKCBtczogbnVtYmVyICkge1xyXG4gIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPiggKCByZXNvbHZlICkgPT4gc2V0VGltZW91dCggKCkgPT4gcmVzb2x2ZSgpLCBtcyApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBiaW5kRWxlbWVudHNCeUNoZWNrKCB0cmlnZ2VyRWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgdGFyZ2V0RWxlbWVudDogSFRNTEVsZW1lbnQsIG9uQ2hlY2s6IEZ1bmN0aW9uLCBvblVuY2hlY2s6IEZ1bmN0aW9uICkge1xyXG4gIGlmICggdHJpZ2dlckVsZW1lbnQuY2hlY2tlZCApIHtcclxuICAgIG9uQ2hlY2soIHRhcmdldEVsZW1lbnQgKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRyaWdnZXJHcm91cCA9IHRyaWdnZXJFbGVtZW50Lm5hbWVcclxuICAgID8gQXJyYXkuZnJvbSggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggYFtuYW1lPVwiJHsgdHJpZ2dlckVsZW1lbnQubmFtZSB9XCJdYCApIClcclxuICAgIDogW3RyaWdnZXJFbGVtZW50XTtcclxuXHJcbiAgdHJpZ2dlckdyb3VwLmZvckVhY2goIHQgPT4gdC5hZGRFdmVudExpc3RlbmVyKCAnY2hhbmdlJywgZXZ0ID0+IHtcclxuICAgIGlmICggdHJpZ2dlckVsZW1lbnQuY2hlY2tlZCApIHtcclxuICAgICAgb25DaGVjayggdGFyZ2V0RWxlbWVudCwgZXZ0ICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBvblVuY2hlY2soIHRhcmdldEVsZW1lbnQsIGV2dCApO1xyXG4gICAgfVxyXG4gIH0gKSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0SW5wdXRGb3JjZVBob25lTnVtYmVyRm9ybWF0KCBpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQgKSB7XHJcbiAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdpbnB1dCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIGxldCBwaG9uZUlucHV0ID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICBjb25zdCBjbGVhblBob25lSW5wdXQgPSBwaG9uZUlucHV0LnJlcGxhY2UoIC9cXEQvZywgJycgKTtcclxuICAgIGlmICggY2xlYW5QaG9uZUlucHV0Lmxlbmd0aCA+IDExICkge1xyXG4gICAgICBwaG9uZUlucHV0ID0gY2xlYW5QaG9uZUlucHV0LnNsaWNlKCAwLCAxMSApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBwaG9uZU51bWJlckZvcm1hdHRlZCA9IHRvUGhvbmVOdW1iZXIoIHBob25lSW5wdXQgKTtcclxuXHJcbiAgICBpZiAoIHBob25lTnVtYmVyRm9ybWF0dGVkLmxlbmd0aCA9PT0gMTAgKSB7XHJcbiAgICAgIHBob25lTnVtYmVyRm9ybWF0dGVkID0gcGhvbmVOdW1iZXJGb3JtYXR0ZWQucmVwbGFjZUFsbCggJy0nLCAnJyApO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudmFsdWUgPSBwaG9uZU51bWJlckZvcm1hdHRlZDtcclxuICB9ICk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNNb2JpbGVCcm93c2VyKCkge1xyXG4gIHJldHVybiAvQW5kcm9pZHxpUGhvbmUvaS50ZXN0KCBuYXZpZ2F0b3IudXNlckFnZW50ICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyRGV2aWNlVHlwZSgpOiAnYW5kcm9pZCcgfCAnYXBwbGUnIHwgJ2Rlc2t0b3AnIHtcclxuICB2YXIgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8ICggd2luZG93IGFzIGFueSApLm9wZXJhO1xyXG5cclxuICBpZiAoIC9hbmRyb2lkL2kudGVzdCggdXNlckFnZW50ICkgKSB7XHJcbiAgICByZXR1cm4gJ2FuZHJvaWQnO1xyXG4gIH0gZWxzZSBpZiAoIC9pUGFkfGlQaG9uZXxpUG9kLy50ZXN0KCB1c2VyQWdlbnQgKSAmJiAhKCB3aW5kb3cgYXMgYW55ICkuTVNTdHJlYW0gKSB7XHJcbiAgICByZXR1cm4gJ2FwcGxlJztcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuICdkZXNrdG9wJztcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc09uU2NyZWVuKCBlbGVtZW50OiBIVE1MRWxlbWVudCApIHtcclxuICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICByZXR1cm4gKFxyXG4gICAgcmVjdC50b3AgPj0gMCAmJlxyXG4gICAgcmVjdC5sZWZ0ID49IDAgJiZcclxuICAgIHJlY3QuYm90dG9tIDw9ICggd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKSAmJlxyXG4gICAgcmVjdC5yaWdodCA8PSAoIHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCApXHJcbiAgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRFbGVtZW50Vmlld0lmQ2hlY2tlZCggdHJpZ2dlckVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIHRhcmdldEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIG9wdGlvbnMgPSB7XHJcbiAgb25DaGVjazogKCB0cmlnZ2VyRWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgdGFyZ2V0RWxlbWVudDogSFRNTEVsZW1lbnQgKSA9PiB7IH0sXHJcbiAgb25VbmNoZWNrOiAoIHRyaWdnZXJFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50LCB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudCApID0+IHsgfVxyXG59ICkge1xyXG4gIGJpbmRFbGVtZW50c0J5Q2hlY2soXHJcbiAgICB0cmlnZ2VyRWxlbWVudCxcclxuICAgIHRhcmdldEVsZW1lbnQsXHJcbiAgICAoIGVsOiBIVE1MRWxlbWVudCApID0+IHtcclxuICAgICAgZWwuY2xhc3NMaXN0LmFkZCggJ3Nob3cnICk7XHJcbiAgICAgIG9wdGlvbnMub25DaGVjayggdHJpZ2dlckVsZW1lbnQsIHRhcmdldEVsZW1lbnQgKTtcclxuICAgIH0sXHJcbiAgICAoIGVsOiBIVE1MRWxlbWVudCApID0+IHtcclxuICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSggJ3Nob3cnICk7XHJcbiAgICAgIG9wdGlvbnMub25VbmNoZWNrKCB0cmlnZ2VyRWxlbWVudCwgdGFyZ2V0RWxlbWVudCApO1xyXG4gICAgfSxcclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmFsdWVGcm9tUmFkaW9Hcm91cCggZ3JvdXBOYW1lOiBzdHJpbmcgKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIGBbbmFtZT0keyBncm91cE5hbWUgfV06Y2hlY2tlZGAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gIGlmICggZWwgKSB7XHJcbiAgICByZXR1cm4gZWwudmFsdWU7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNtb290aFNjcm9sbCggdGFyZ2V0WTogbnVtYmVyLCBkdXJhdGlvbjogbnVtYmVyICk6IHZvaWQge1xyXG4gIGNvbnN0IHN0YXJ0WSA9IHdpbmRvdy5zY3JvbGxZIHx8IHdpbmRvdy5wYWdlWU9mZnNldDtcclxuICBsZXQgc3RhcnRUaW1lOiBudW1iZXIgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgZnVuY3Rpb24gc3RlcCggY3VycmVudFRpbWU6IG51bWJlciApIHtcclxuICAgIGlmICggIXN0YXJ0VGltZSApIHN0YXJ0VGltZSA9IGN1cnJlbnRUaW1lO1xyXG4gICAgY29uc3QgZWxhcHNlZFRpbWUgPSBjdXJyZW50VGltZSAtIHN0YXJ0VGltZTtcclxuICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5taW4oIGVsYXBzZWRUaW1lIC8gZHVyYXRpb24sIDEgKTtcclxuICAgIGNvbnN0IGVhc2VkUHJvZ3Jlc3MgPSBsZXJwKCAwLCAxLCBwcm9ncmVzcyApO1xyXG4gICAgd2luZG93LnNjcm9sbFRvKCAwLCBsZXJwKCBzdGFydFksIHRhcmdldFksIGVhc2VkUHJvZ3Jlc3MgKSApO1xyXG4gICAgaWYgKCBlbGFwc2VkVGltZSA8IGR1cmF0aW9uICkge1xyXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIHN0ZXAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZSggc3RlcCApO1xyXG59XHJcblxyXG4vLyBSZXRvcm5hIHVtYSBmdW7Dp8OjbyBxdWUgbsOjbyB2YWkgc2VyIGNvbXBsZXRhZGEgY2FzbyBzZWphIGNoYW1hZGEgbm92YW1lbnRlIGVtIHsgZGVsYXkgfSBtaWxpc3NlZ3VuZG9zXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZUZhY3RvcnkoIGZ1bmM6IEZ1bmN0aW9uLCBkZWxheTogbnVtYmVyICk6IEZ1bmN0aW9uIHtcclxuICBsZXQgaW5EZWJvdW5jZTogbnVtYmVyO1xyXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gd2luZG93O1xyXG4gICAgY29uc3QgYXJncyA9IGFyZ3VtZW50cztcclxuICAgIGNsZWFyVGltZW91dCggaW5EZWJvdW5jZSApO1xyXG4gICAgaW5EZWJvdW5jZSA9IHdpbmRvdy5zZXRUaW1lb3V0KCAoKSA9PiBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICksIGRlbGF5ICk7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gUmV0b3JuYSB1bWEgZnVuw6fDo28gcXVlIHPDsyBwb2RlIHNlciBjb21wbGV0YWRhIHVtYSB2ZXogYSBjYWRhIHsgbGltaXQgfSBtaWxpc3NlZ3VuZG9zIFxyXG5leHBvcnQgZnVuY3Rpb24gdGhyb3R0bGVGYWN0b3J5KCBmdW5jOiBGdW5jdGlvbiwgbGltaXQ6IG51bWJlciApOiBGdW5jdGlvbiB7XHJcbiAgbGV0IGxhc3RGdW5jOiBudW1iZXI7XHJcbiAgbGV0IGxhc3RSYW46IG51bWJlcjtcclxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgY29udGV4dCA9IHdpbmRvdztcclxuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICBpZiAoICFsYXN0UmFuICkge1xyXG4gICAgICBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICk7XHJcbiAgICAgIGxhc3RSYW4gPSBEYXRlLm5vdygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KCBsYXN0RnVuYyApO1xyXG4gICAgICBsYXN0RnVuYyA9IHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCBEYXRlLm5vdygpIC0gbGFzdFJhbiA+PSBsaW1pdCApIHtcclxuICAgICAgICAgIGZ1bmMuYXBwbHkoIGNvbnRleHQsIGFyZ3MgKTtcclxuICAgICAgICAgIGxhc3RSYW4gPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgbGltaXQgLSAoIERhdGUubm93KCkgLSBsYXN0UmFuICkgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzbW9vdGhTY3JvbGxUbyggcG9zOiBudW1iZXIgKTogdm9pZCB7XHJcbiAgZG9jdW1lbnQuYm9keS5zY3JvbGxUbygge1xyXG4gICAgdG9wOiBwb3MsXHJcbiAgICBiZWhhdmlvcjogJ3Ntb290aCcsXHJcbiAgfSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc21vb3RoU2Nyb2xsVG9FbGVtZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCwgdXNlQnJvd3NlckRlZmF1bHRzOiBib29sZWFuID0gdHJ1ZSApOiB2b2lkIHtcclxuICBpZiAoICF1c2VCcm93c2VyRGVmYXVsdHMgKSB7XHJcbiAgICBjb25zdCB0YXJnZXRZID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyB3aW5kb3cuc2Nyb2xsWTtcclxuICAgIGNvbnN0IGR1cmF0aW9uID0gMTAwMDsgLy8gRHVyYcOnw6NvIGZpeGEgZW0gbWlsaXNzZWd1bmRvcyAoMSBzZWd1bmRvKVxyXG4gICAgc21vb3RoU2Nyb2xsKCB0YXJnZXRZLCBkdXJhdGlvbiApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgZG9jdW1lbnQuYm9keS5zY3JvbGxUbygge1xyXG4gICAgdG9wOiBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnksXHJcbiAgICBsZWZ0OiBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLngsXHJcbiAgICBiZWhhdmlvcjogJ3Ntb290aCcsXHJcbiAgfSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0T3B0aW9uQnlUZXh0KCBpZFNlbGVjdEVsZW1lbnQ6IHN0cmluZywgc2VhcmNoVGV4dDogc3RyaW5nLCBjb250YWluczogYm9vbGVhbiA9IGZhbHNlICk6IHZvaWQge1xyXG4gIGNvbnN0IHNlbGVjdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggaWRTZWxlY3RFbGVtZW50ICkgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcblxyXG4gIGlmICggIXNlbGVjdEVsZW1lbnQgKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBjb25zdCBvcHRpb25zRWxlbWVudG9TZWxlY3QgPSBbLi4uc2VsZWN0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCAnb3B0aW9uJyApXTtcclxuXHJcbiAgbGV0IHNlbGVjdGVkT3B0aW9uO1xyXG4gIGlmICggY29udGFpbnMgKSB7XHJcbiAgICBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnNFbGVtZW50b1NlbGVjdFxyXG4gICAgICAuZmlsdGVyKCBlbCA9PiBlbC50ZXh0Q29udGVudCAmJiBlbC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkgKSApWzBdLnZhbHVlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnNFbGVtZW50b1NlbGVjdFxyXG4gICAgICAuZmlsdGVyKCBlbCA9PiBlbC50ZXh0Q29udGVudCAmJiBlbC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpID09PSBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkgKVswXS52YWx1ZTtcclxuICB9XHJcblxyXG4gIHNlbGVjdEVsZW1lbnQudmFsdWUgPSBzZWxlY3RlZE9wdGlvbjtcclxufVxyXG5cclxuIiwiXHJcbi8vLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xNjI0NTc2Ny9jcmVhdGluZy1hLWJsb2ItZnJvbS1hLWJhc2U2NC1zdHJpbmctaW4tamF2YXNjcmlwdFxyXG4vLy8gRGl2aWRlIHVtIGFycXVpdm8gYmluw6FyaW8gZW0gdsOhcmlhcyBwYXJ0ZXMsIHBhcmEgcXVlIGEgY29udmVyc8OjbyBzZWphIG90aW1pemFkYSwgZSByZXRvcm5hIHVtYSBibG9iIGNvbSBvIGFycXVpdm9cclxuXHJcbmltcG9ydCB7IGlzTnVsbE9yRW1wdHkgfSBmcm9tICcuL1N0cmluZ1Rvb2xzJztcclxuXHJcbi8vLyBAcGFyYW0gb25Qcm9ncmVzc28gVW0gY2FsbGJhY2sgcXVlIHJlY2ViZSBhIHBvcmNlbnRhZ2VtIGRlIHByb2dyZXNzbyBhdHVhbCBkYSBjb252ZXJzw6NvXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBiYXNlNjRUb0Jsb2IoIHRleHRvQmFzZTY0OiBzdHJpbmcsIGNvbnRlbnRUeXBlOiBzdHJpbmcsIHRhbWFuaG9QYXJ0ZXMgPSAxMDI0LCBvblByb2dyZXNzID0gKCBwcm9ncmVzc29BdHVhbDogbnVtYmVyICkgPT4geyBjb25zb2xlLmxvZyggcHJvZ3Jlc3NvQXR1YWwgKSB9ICkge1xyXG4gIGNvbnN0IGJ5dGVBcnJheXMgPSBuZXcgQXJyYXk8VWludDhBcnJheT4oKTtcclxuICBjb25zdCBmaWxlU2l6ZSA9IHRleHRvQmFzZTY0Lmxlbmd0aDtcclxuXHJcbiAgLy8vIHByZWVuY2hlIGBieXRlQXJyYXlzYCBjb20gb3MgYnl0ZXMgZG8gYXJxdWl2byBwZWdhbmRvIHVtYSBwYXJ0ZSBkZSBcInRhbWFuaG9QYXJ0ZXNcIiBwb3IgdmV6XHJcbiAgZm9yICggbGV0IG9mZnNldCA9IDA7IG9mZnNldCA8IGZpbGVTaXplOyBvZmZzZXQgKz0gdGFtYW5ob1BhcnRlcyApIHtcclxuICAgIC8vLyBwZWdhbmRvIHVtIHBhcnRlIGRlIHRhbWFuaG8ge3RhbWFuaG9QYXJ0ZXN9IGRvIGFycXVpdm9cclxuICAgIGNvbnN0IGNodW5rID0gdGV4dG9CYXNlNjQuc2xpY2UoIG9mZnNldCwgb2Zmc2V0ICsgdGFtYW5ob1BhcnRlcyApO1xyXG5cclxuICAgIC8vLyBjb252ZXJ0ZW5kbyBhIHBhcnRlIGVtIHVtIGFycmF5IGNvbSBjYWRhIGJ5dGUgZGVzc2UgcGVkYcOnbyBkbyBhcnF1aXZvXHJcbiAgICBjb25zdCBhcnJCeXRlc0NodW5rID0gbmV3IEFycmF5PG51bWJlcj4oIGNodW5rLmxlbmd0aCApO1xyXG4gICAgZm9yICggbGV0IGkgPSAwOyBpIDwgY2h1bmsubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgIGFyckJ5dGVzQ2h1bmtbaV0gPSBjaHVuay5jaGFyQ29kZUF0KCBpICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8vIHRyYW5zZm9ybWFuZG8gZXNzZSBhcnJheSBlbSB1bSBhcnJheSBjb20gY2FtcG9zIGRvIHRhbWFuaG8gZGUgdW0gYnl0ZVxyXG4gICAgLy8vIGUgdW5pbmRvIGFzIHBhcnRlcyBqw6EgY29uY2x1w61kYXMgZG8gYXJxdWl2b1xyXG4gICAgYnl0ZUFycmF5cy5wdXNoKCBuZXcgVWludDhBcnJheSggYXJyQnl0ZXNDaHVuayApICk7XHJcblxyXG4gICAgLy8vIENoYW1hbmRvIGNhbGxiYWNrIHF1ZSBleGliZSBvIHByb2dyZXNzbyBxdWFuZG8gbyBwYXNzbyBhdHVhbCBmb3IgY29uY2x1w61kb1xyXG4gICAgYXdhaXQgb25Qcm9ncmVzcyggKCBvZmZzZXQgLyBmaWxlU2l6ZSApICogMTAwICk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbmV3IEJsb2IoIGJ5dGVBcnJheXMsIHsgdHlwZTogY29udGVudFR5cGUgfSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZG93bmxvYWRGaWxlRnJvbUJsb2IoIGJsb2I6IEJsb2IsIHRpdGxlOiBzdHJpbmcgKSB7XHJcbiAgbGV0IGZpbGUgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKCBibG9iICk7XHJcblxyXG4gIGlmICggZmlsZSApIHtcclxuICAgIGxldCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2EnICk7XHJcbiAgICBhLmhyZWYgPSBmaWxlO1xyXG4gICAgYS5kb3dubG9hZCA9IHRpdGxlO1xyXG4gICAgYS5jbGljaygpO1xyXG4gICAgYS5yZW1vdmUoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVGaWxlUGF0aCggZmlsZVBhdGg6IHN0cmluZyApOiBzdHJpbmcge1xyXG4gIGNvbnN0IHJlZ2V4ID0gLyg/Oi4qW1xcXFwvXSkoW15cXFxcL10rKSQvO1xyXG5cclxuICBjb25zdCBtYXRjaCA9IHJlZ2V4LmV4ZWMoIGZpbGVQYXRoICk7XHJcbiAgaWYgKCBtYXRjaCAmJiBtYXRjaC5sZW5ndGggPiAxICkge1xyXG4gICAgcmV0dXJuIG1hdGNoWzFdO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gZmlsZVBhdGg7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlsZUV4dGVuc2lvbiggZmlsZU5hbWU6IHN0cmluZyApOiBzdHJpbmcge1xyXG4gIGlmICggaXNOdWxsT3JFbXB0eSggZmlsZU5hbWUgKSApIHJldHVybiAnJztcclxuXHJcbiAgY29uc3QgZGVmYXVsdEZpbGVTcmMgPSBmaWxlTmFtZS5zcGxpdCggJy4nICkucG9wKCk7XHJcbiAgaWYgKCBkZWZhdWx0RmlsZVNyYyAmJiBkZWZhdWx0RmlsZVNyYyAhPT0gZmlsZU5hbWUgKSB7XHJcbiAgICByZXR1cm4gZGVmYXVsdEZpbGVTcmM7XHJcbiAgfVxyXG5cclxuICBjb25zdCBmaWxlVHlwZVN0ciA9IGZpbGVOYW1lLnNwbGl0KCAnLycgKS5wb3AoKTtcclxuICBpZiAoIGZpbGVUeXBlU3RyICYmIGZpbGVUeXBlU3RyICE9PSBmaWxlTmFtZSApIHtcclxuICAgIHJldHVybiBmaWxlVHlwZVN0cjtcclxuICB9XHJcblxyXG4gIHJldHVybiAnJztcclxufSIsImV4cG9ydCBmdW5jdGlvbiByZW1vdmVBY2NlbnRzKCBzdHI6IHN0cmluZyApIHtcclxuICByZXR1cm4gc3RyLm5vcm1hbGl6ZSggJ05GRCcgKS5yZXBsYWNlKCAvW1xcdTAzMDAtXFx1MDM2Zl0vZywgXCJcIiApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKCBzdHI6IHN0cmluZyApOiBzdHJpbmcge1xyXG4gIGlmICggdHlwZW9mIHN0ciAhPT0gJ3N0cmluZycgKSB7XHJcbiAgICByZXR1cm4gJyc7XHJcbiAgfVxyXG4gIHJldHVybiBzdHIuY2hhckF0KCAwICkudG9VcHBlckNhc2UoKSArIHN0ci5zdWJzdHJpbmcoIDEgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNlYXJjaFRlcm0oIHN0cmluZ0FycmF5OiBzdHJpbmdbXSwgc2VhcmNoVGVybTogc3RyaW5nICk6IHN0cmluZ1tdIHtcclxuICByZXR1cm4gc3RyaW5nQXJyYXlcclxuICAgIC5maWx0ZXIoICggdjogc3RyaW5nICkgPT4gdi50b0xvd2VyQ2FzZSgpLmluZGV4T2YoIHNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSApID4gLTEgKVxyXG4gICAgLnNsaWNlKCAwLCAxMCApXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB6ZXJvQmVmb3JlKCBuOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIG4udG9TdHJpbmcoKS5wYWRTdGFydCggMiwgJzAnICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc051bGxPckVtcHR5KCBzdHI6IHN0cmluZyApIHtcclxuICByZXR1cm4gdHlwZW9mIHN0ciAhPT0gJ3N0cmluZycgfHwgIXN0ciB8fCBzdHIgPT09ICcnXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0b1Bob25lTnVtYmVyKCBpbnB1dFRleHQ6IHN0cmluZyApIHtcclxuICBjb25zdCBjbGVhbk51bWJlciA9IGlucHV0VGV4dC5yZXBsYWNlKCAvXFxEL2csICcnICk7XHJcblxyXG4gIGxldCByZXN1bHQ7XHJcbiAgaWYgKCBjbGVhbk51bWJlci5sZW5ndGggPD0gMTAgKSB7XHJcbiAgICBjb25zdCByZWdleCA9IC9eKFxcZHsyfSkoXFxkezR9KShcXGR7MCw0fSkkLztcclxuICAgIHJlc3VsdCA9IGNsZWFuTnVtYmVyLnJlcGxhY2UoIHJlZ2V4LCAnKCQxKSAkMi0kMycgKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY29uc3QgcmVnZXggPSAvXihcXGR7Mn0pKFxcZHs1fSkoXFxkezAsNH0pJC87XHJcbiAgICByZXN1bHQgPSBjbGVhbk51bWJlci5yZXBsYWNlKCByZWdleCwgJygkMSkgJDItJDMnICk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlU3BlY2lhbENoYXJhY3RlcnMoIGlucHV0OiBzdHJpbmcgKTogc3RyaW5nIHtcclxuICByZXR1cm4gaW5wdXQucmVwbGFjZSggL1teYS16QS1aMC05XS9nLCAnJyApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZVNwZWNpYWxXaXRoV2hpdGVzcGFjZSggaW5wdXQ6IHN0cmluZyApOiBzdHJpbmcge1xyXG4gIHJldHVybiBpbnB1dC5yZXBsYWNlKCAvW15hLXpBLVowLTldL2csICcgJyApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZVBlcmNlbnRFbmNvZGluZyggaHRtbDogc3RyaW5nICk6IHN0cmluZyB7XHJcbiAgLy8gUmVwbGFjZSAlMjAgd2l0aCBhY3R1YWwgc3BhY2VzXHJcbiAgcmV0dXJuIGh0bWwucmVwbGFjZSggLyUyMC9nLCAnICcgKTtcclxufSIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNzM1Myk7XG4iXSwibmFtZXMiOlsiQXVkaW9Db21wb25lbnQiLCJzcmMiLCJhdWRpb0VsZW1lbnQiLCJfY29udGFpbmVyIiwiX3N0YXJ0c0F0IiwiX2Jsb2NrSW50ZXJhY3Rpb24iLCJfZGl2QmxvY2tJbnRlcmFjdGlvbiIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInN1cGVyIiwidGhpcyIsImNvbnRhaW5lciIsImJsb2NrSW50ZXJhY3Rpb24iLCJhdWRpb0VsZW1lbnRJZCIsImlkIiwic3RhcnRzQXQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwic3RvcCIsImdldEludmlzaWJsZURpdkJsb2NrSW50ZXJhY3Rpb24iLCJzZXR1cEludmlzaWJsZURpdkJsb2NrSW50ZXJhY3Rpb24iLCJzZXRFbGVtZW50c0F0dHJpYnV0ZXMiLCJkZXN0cm95IiwicmVtb3ZlIiwiaXNQbGF5aW5nIiwicGF1c2VkIiwidmFsIiwiX3ZpZGVvSW5mb0F0dHJpYnV0ZUxpc3QiLCJuYW1lIiwicmVwbGFjZVBlcmNlbnRFbmNvZGluZyIsInJlbW92ZUZpbGVQYXRoIiwic2V0QXR0cmlidXRlTGlzdEZvckVsZW1lbnQiLCJkaXZCbG9ja0ludGVyYWN0aW9uIiwiZmlsZU5hbWUiLCJxdWVyeVNlbGVjdG9yIiwicGxheWVyQ3VycmVudFRpbWUiLCJ0IiwiY3VycmVudFRpbWUiLCJzZWVrIiwic291cmNlRWxlbWVudHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2hhbmdlU291cmNlIiwibmV3SWQiLCJpbm5lckhUTUwiLCJzb3VyY2VFbGVtZW50SFRNTCIsImxvYWQiLCJwbGF5V2l0aG91dFRyaWdnZXJFdmVudHMiLCJwbGF5UHJvbWlzZSIsInBsYXkiLCJ1bmRlZmluZWQiLCJ0aGVuIiwiXyIsImNhdGNoIiwic2V0Q2xhc3Nlc1BsYXlpbmciLCJwYXVzZVdpdGhvdXRUcmlnZ2VyRXZlbnRzIiwicGF1c2UiLCJzZXRDbGFzc2VzUGF1c2VkIiwiY2FsbEV2ZW50c0J5TmFtZSIsInRvZ2dsZSIsIm11dGUiLCJ2b2x1bWUiLCJ1bm11dGUiLCJzZWVrVGltZSIsIl9yZWxvYWRCdWZmZXIiLCJkaW1lbnNpb25zIiwiZ2V0RWxlbWVudERpbWVuc2lvbnMiLCJhdWRpb0NvbXBvbmVudCIsImVsZW1lbnRJbnZpc2libGVEaXYiLCJjcmVhdGVJbnZpc2libGVEaXZBYm92ZVBhcmVudCIsInBhcmVudEVsZW1lbnQiLCJwb3NpdGlvbiIsInRvcCIsImxlZnQiLCJ3aWR0aCIsImhlaWdodCIsInN0eWxlIiwiZGlzcGxheSIsInpJbmRleCIsImNyZWF0ZUF1ZGlvQ29tcG9uZW50T25Cb2R5IiwiYXVkaW9Db21wb25lbnRDb250YWluZXIiLCJBdWRpb0NvbXBvbmVudEZhY3RvcnkiLCJidWlsZE9uQm9keSIsImNyZWF0ZUF1ZGlvQ29tcG9uZW50IiwiZG9jdW1lbnQiLCJib2R5IiwiYnVpbGQiLCJDb21wb25lbnRDb250YWluZXIiLCJwbGF5ZXJDb25maWciLCJjcmVhdGVJbnZpc2libGVQbGF5ZXIiLCJidWlsZFN1YkNvbXBvbmVudHMiLCJwYXJlbnQiLCJfZWxlbWVudCIsInRlbXBsYXRlRWxlbWVudCIsImNvbXBvbmVudE5hbWUiLCJzdWJDb21wb25lbnRDb3VudEJ5TmFtZSIsIk1hcCIsInN1YkNvbXBvbmVudHMiLCJ0ZW1wbGF0ZSIsImdldEVsZW1lbnRCeUlkIiwiRXJyb3IiLCJjcmVhdGVFbGVtZW50IiwiY29udGVudCIsImFwcGVuZENoaWxkIiwiZ2V0VGVtcGxhdGVDbG9uZU5vZGVzIiwiY2xvbmVOb2RlIiwiY2hpbGRyZW4iLCJidWlsZFNpbmdsZVN1YkNvbXBvbmVudCIsImNvbXBvbmVudCIsImhhcyIsInNldCIsImNvbXBvbmVudENvdW50IiwiZ2V0IiwiY2FwaXRhbGl6ZUZpcnN0TGV0dGVyIiwiZWxlbWVudElkIiwiaXRlbSIsImluc2VydEFkamFjZW50RWxlbWVudCIsIk1lZGlhUGxheWVyIiwiT2JqZWN0RXZlbnRMaXN0ZW5lciIsIlN0cmluZyIsInByb3RvdHlwZSIsImlzTnVsbE9yRW1wdHkiLCJ0cnVuY2F0ZSIsIm1heCIsImRlY29yYXRvciIsImxlbmd0aCIsInN1YnN0cmluZyIsInRvU3RyaW5nIiwicmVtb3ZlQWNjZW50cyIsIm5vcm1hbGl6ZSIsInJlcGxhY2UiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInplcm9CZWZvcmUiLCJwYWRTdGFydCIsImV2ZW50c0J5TmFtZSIsImV2ZW50TmFtZSIsImV2ZW50IiwibmV3RXZlbnQiLCJjcnlwdG8iLCJyYW5kb21VVUlEIiwidG9Mb3dlckNhc2UiLCJwdXNoIiwiZ2V0RXZlbnRzQnlOYW1lIiwicmVtb3ZlRXZlbnRCeUlkIiwiZXZlbnRJZCIsImZvckVhY2giLCJ2YWx1ZSIsImtleSIsImZpbHRlciIsImUiLCJldmVudEFyZ3MiLCJhc3luYyIsImFyclNvdXJjZXMiLCJnZXRFbGVtZW50RnJvbUhUTUwiLCJhdWRpb0VsZW1lbnRIVE1MIiwiaGlkZUVsZW1lbnQiLCJhdXRvUGxheSIsImF1dG9wbGF5IiwibXV0ZWQiLCJsb29wIiwicHJlbG9hZCIsInRyaW1FbmQiLCJhdWRpb0VsZW1lbnRQYXJhbXNCeVBsYXllckNvbmZpZyIsIm1hcCIsInJlZHVjZSIsImFjYyIsIm5leHQiLCJnZXRGaWxlRXh0ZW5zaW9uIiwicGxheUJ1dHRvbkNTUyIsImRpY3RLZXlzQnlBY3Rpb25LZXlkb3duT25jZSIsImRpY3RLZXlzQnlBY3Rpb25LZXlkb3duUmVwZWF0IiwiZGljdEtleXNCeUFjdGlvbktleXVwIiwiZWxlbWVudCIsImF0dHJMaXN0Iiwic2V0QXR0cmlidXRlIiwiaHRtbCIsInRyaW0iLCJyZXN1bHQiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiaW52aXNpYmxlRGl2Iiwib3BhY2l0eSIsInBvaW50ZXJFdmVudHMiLCJ3aW5kb3ciLCJldnQiLCJyZXBlYXQiLCJwYWlyIiwiY29kZSIsImtiRXZlbnQiLCJydW5Pbmx5T25jZUtleWRvd25BY3Rpb25zIiwicnVuS2V5ZG93bkFjdGlvbnNSZXBlYXQiLCJmaWxlUGF0aCIsIm1hdGNoIiwiZXhlYyIsImRlZmF1bHRGaWxlU3JjIiwic3BsaXQiLCJwb3AiLCJmaWxlVHlwZVN0ciIsInN0ciIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibiIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkIiwiYSIsImRlZmluaXRpb24iLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwib2JqIiwicHJvcCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsIl9fd2VicGFja19leHBvcnRzX18iXSwic291cmNlUm9vdCI6IiJ9
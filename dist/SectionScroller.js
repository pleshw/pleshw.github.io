var SectionScroller;(()=>{"use strict";var e={7001:(e,t,o)=>{o.d(t,{debounceFactory:()=>r});const n=new Map,s=new Map,i=new Map;function r(e,t){let o;return function(){const n=window,s=arguments;clearTimeout(o),o=window.setTimeout((()=>e.apply(n,s)),t)}}new Map,window.addEventListener("keydown",(e=>{e.repeat||function(e){for(const t of n)e.code===t[0]&&t[1].forEach((t=>t(e)))}(e),function(e){for(const t of s)e.code===t[0]&&t[1].forEach((t=>t(e)))}(e)})),window.addEventListener("keyup",(e=>{for(const t of i)e.code===t[0]&&t[1].forEach((t=>t(e)))}))},4140:(e,t,o)=>{function n(e=0,t=0,o=100){return Math.max(t,Math.min(e,o))}o.d(t,{clamp:()=>n})},9699:(e,t,o)=>{var n,s,i,r;o.d(t,{ObjectEventListener:()=>c}),function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENTAGE=1]="PERCENTAGE"}(n||(n={})),function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(s||(s={})),function(e){e[e.FROM_TOP=0]="FROM_TOP",e[e.FROM_BOTTOM=1]="FROM_BOTTOM"}(i||(i={})),function(e){e[e.R=0]="R",e[e.G=1]="G",e[e.B=2]="B",e[e.A=3]="A"}(r||(r={}));class c{eventsByName=new Map;addEventListener(e,t){this.eventsByName.has(e.toLowerCase())?this.eventsByName.get(e.toLowerCase()).push(t):this.eventsByName.set(e.toLowerCase(),[t])}getEventsByName(e){return this.eventsByName.has(e.toLowerCase())||this.eventsByName.set(e.toLowerCase(),[]),this.eventsByName.get(e.toLowerCase())}callEventsByName(e,...t){this.getEventsByName(e).forEach((e=>e(...t)))}}}},t={};function o(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{o.r(n),o.d(n,{SectionScroller:()=>i});var e=o(7001),t=o(4140),s=o(9699);class i extends s.ObjectEventListener{static _globalInstance=new i;static _debounceWheel;_index;_sections;constructor(){super(),this._index=0,this._sections=Array.from(document.querySelectorAll("section"))}get section(){return this._sections[this._index]}scrollToSectionByIndex(e){e=(0,t.clamp)(e,0,this._sections.length-1),this.callEventsByName("onscroll",this.section,this._index),e>this._index?this.callEventsByName("onscrolldown",this.section,this._index):e<this._index?this.callEventsByName("onscrollup",this.section,this._index):this.callEventsByName("onscrollfailed",this.section,this._index),this._index=e,this._sections[e].scrollIntoView({behavior:"smooth",block:"start"})}scrollToPreviousSection(){return this.scrollToSectionByIndex(this._index-1)}scrollToNextSection(){return this.scrollToSectionByIndex(this._index+1)}static makeGlobalScrollSectionScroller(){i._debounceWheel=(0,e.debounceFactory)((e=>{e.deltaY>0?i._globalInstance.scrollToNextSection():i._globalInstance.scrollToPreviousSection()}),500),window.addEventListener("wheel",(function(e){i._debounceWheel(e)}))}}})(),SectionScroller=n})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FBS29DLE9BQVMsRUFDcEQsQ0FFTyxzQ0FBT2lCLEdBQ1puQixFQUFnQm9CLGdCQUFpQixJQUFBdkYsa0JBQW1CZ0MsSUFDN0NBLEVBQU13RCxPQUFTLEVBQ2xCckIsRUFBZ0JzQixnQkFBZ0JKLHNCQUVoQ2xCLEVBQWdCc0IsZ0JBQWdCTCx5QixHQUVqQyxLQUVIL0UsT0FBT00saUJBQWtCLFNBQVMsU0FBV3FCLEdBQzNDbUMsRUFBZ0JvQixlQUFnQnZELEVBQ2xDLEdBQ0YsRSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9ET01Ub29scy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aFRvb2xzLnRzIiwid2VicGFjazovLy8uL3NyYy90eXBlcy50cyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly8vLi9zcmMvU2VjdGlvblNjcm9sbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpbWVuc2lvbnMsIFBvaW50MkQsIGxlcnAsIHJlZ2V4TnVtYmVyUGF0dGVybiwgcm90YXRlQ29vcmRpbmF0ZXMsIHJvdGF0ZUNvb3JkaW5hdGVzRnJvbVBvaW50MkQgfSBmcm9tICcuL01hdGhUb29scyc7XHJcbmltcG9ydCB7IHRvUGhvbmVOdW1iZXIgfSBmcm9tICcuL1N0cmluZ1Rvb2xzJztcclxuaW1wb3J0IHsgQ29sbGlzaW9uRGlyZWN0aW9uQ2hlY2ssIENvbGxpc2lvbkJvcmRlckRpc3RhbmNlIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5leHBvcnQgdHlwZSBLZXlib2FyZEV2ZW50Q2FsbGJhY2sgPSAoIGV2dDogS2V5Ym9hcmRFdmVudCApID0+IHZvaWQ7XHJcbmV4cG9ydCBjb25zdCByZWdleFJlbW92ZVRyYW5zbGF0ZUZyb21UcmFuc2Zvcm0gPSAvdHJhbnNsYXRlXFwoW14pXSpcXCkvZztcclxuZXhwb3J0IGNvbnN0IHJlZ2V4R3JvdXBSb3RhdGVWYWx1ZSA9IC9yb3RhdGVcXCgoLT9cXGQrXFwuP1xcZCopZGVnXFwpLztcclxuZXhwb3J0IGNvbnN0IHJlZ2V4R3JvdXBSb3RhdGVYVmFsdWUgPSAvcm90YXRlWFxcKCgtP1xcZCtcXC4/XFxkKilkZWdcXCkvO1xyXG5leHBvcnQgY29uc3QgcmVnZXhHcm91cFJvdGF0ZVlWYWx1ZSA9IC9yb3RhdGVZXFwoKC0/XFxkK1xcLj9cXGQqKWRlZ1xcKS87XHJcbmV4cG9ydCBjb25zdCByZWdleEdyb3VwUm90YXRlWlZhbHVlID0gL3JvdGF0ZVpcXCgoLT9cXGQrXFwuP1xcZCopZGVnXFwpLztcclxuXHJcbmV4cG9ydCBjb25zdCBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93bk9uY2UgPSBuZXcgTWFwPHN0cmluZywgS2V5Ym9hcmRFdmVudENhbGxiYWNrW10+KCk7XHJcbmV4cG9ydCBjb25zdCBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93blJlcGVhdCA9IG5ldyBNYXA8c3RyaW5nLCBLZXlib2FyZEV2ZW50Q2FsbGJhY2tbXT4oKTtcclxuZXhwb3J0IGNvbnN0IGRpY3RLZXlzQnlBY3Rpb25LZXl1cCA9IG5ldyBNYXA8c3RyaW5nLCBLZXlib2FyZEV2ZW50Q2FsbGJhY2tbXT4oKTtcclxuZXhwb3J0IGZ1bmN0aW9uIGFkZEFjdGlvbktleSggeyBrZXksIGtleWRvd246IGV2ZW50S2V5ZG93biwga2V5dXA6IGV2ZW50S2V5dXAsIGV4ZWN1dGVPbmx5T25jZSA9IHRydWUgfTogeyBrZXk6IHN0cmluZzsga2V5ZG93bjogS2V5Ym9hcmRFdmVudENhbGxiYWNrOyBrZXl1cD86IEtleWJvYXJkRXZlbnRDYWxsYmFjazsgZXhlY3V0ZU9ubHlPbmNlPzogYm9vbGVhbjsgfSApIHtcclxuICBpZiAoIGV4ZWN1dGVPbmx5T25jZSApIHtcclxuICAgIGFkZEFjdGlvbktleVJ1bk9uY2UoIGtleSwgZXZlbnRLZXlkb3duLCBldmVudEtleXVwICk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBhZGRBY3Rpb25LZXlSdW5PblJlcGVhdCgga2V5LCBldmVudEtleWRvd24sIGV2ZW50S2V5dXAgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRGcm9tSFRNTCggaHRtbDogc3RyaW5nLCB0cmltOiBib29sZWFuID0gdHJ1ZSApIHtcclxuICBodG1sID0gdHJpbSA/IGh0bWwudHJpbSgpIDogaHRtbDtcclxuXHJcbiAgaWYgKCAhaHRtbCApIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAndGVtcGxhdGUnICk7XHJcbiAgdGVtcGxhdGUuaW5uZXJIVE1MID0gaHRtbDtcclxuICBjb25zdCByZXN1bHQgPSB0ZW1wbGF0ZS5jb250ZW50LmNoaWxkcmVuO1xyXG5cclxuICBpZiAoIHJlc3VsdC5sZW5ndGggPT09IDEgKSB7XHJcbiAgICByZXR1cm4gcmVzdWx0WzBdIGFzIEhUTUxFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIEFycmF5LmZyb20oIHJlc3VsdCApIGFzIEhUTUxFbGVtZW50W107XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50RGltZW5zaW9uc0J5SWQoIGVsZW1lbnRJZDogc3RyaW5nICk6IERpbWVuc2lvbnMge1xyXG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggZWxlbWVudElkICk7XHJcblxyXG4gIGlmICggIWVsZW1lbnQgKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoIFwiSW52YWxpZCBlbGVtZW50IGF0IGdldEVsZW1lbnREaW1lbnNpb25zQnlJZCB3aXRoIGlkOiBcIiArIGVsZW1lbnRJZCApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGdldEVsZW1lbnREaW1lbnNpb25zKCBlbGVtZW50ICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50RGltZW5zaW9ucyggZWxlbWVudDogSFRNTEVsZW1lbnQgKTogRGltZW5zaW9ucyB7XHJcbiAgdmFyIHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgd2lkdGg6IHJlY3Qud2lkdGgsXHJcbiAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Um90YXRlZEJvdW5kaW5nQm94QmFzZWRPbkJvZHlSb3RhdGlvbiggZWxlbWVudDogSFRNTEVsZW1lbnQgKTogRE9NUmVjdCB7XHJcbiAgY29uc3QgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgY29uc3QgY2VudGVyWCA9IHJlY3QubGVmdCArIHJlY3Qud2lkdGggLyAyO1xyXG4gIGNvbnN0IGNlbnRlclkgPSByZWN0LnRvcCArIHJlY3QuaGVpZ2h0IC8gMjtcclxuXHJcbiAgLy8gUm90YXRpb24gYW5nbGUgaW4gZGVncmVlcyAoZXh0cmFjdGVkIGZyb20gc3R5bGUudHJhbnNmb3JtIG9yIGFueSBvdGhlciBzb3VyY2UpXHJcbiAgY29uc3Qgcm90YXRpb25BbmdsZSA9IGdldEJvZHlSb3RhdGlvbkluRGVncmVlcygpO1xyXG5cclxuICBjb25zdCByYWRpYW5zID0gKCBNYXRoLlBJIC8gMTgwICkgKiByb3RhdGlvbkFuZ2xlO1xyXG4gIGNvbnN0IGNvc1RoZXRhID0gTWF0aC5jb3MoIHJhZGlhbnMgKTtcclxuICBjb25zdCBzaW5UaGV0YSA9IE1hdGguc2luKCByYWRpYW5zICk7XHJcblxyXG4gIC8vIENhbGN1bGF0ZSB0aGUgcm90YXRlZCBjb29yZGluYXRlc1xyXG4gIGNvbnN0IHJvdGF0ZWRYMSA9IGNlbnRlclggKyAoIHJlY3QubGVmdCAtIGNlbnRlclggKSAqIGNvc1RoZXRhIC0gKCByZWN0LnRvcCAtIGNlbnRlclkgKSAqIHNpblRoZXRhO1xyXG4gIGNvbnN0IHJvdGF0ZWRZMSA9IGNlbnRlclkgKyAoIHJlY3QubGVmdCAtIGNlbnRlclggKSAqIHNpblRoZXRhICsgKCByZWN0LnRvcCAtIGNlbnRlclkgKSAqIGNvc1RoZXRhO1xyXG5cclxuICBjb25zdCByb3RhdGVkWDIgPSBjZW50ZXJYICsgKCByZWN0LnJpZ2h0IC0gY2VudGVyWCApICogY29zVGhldGEgLSAoIHJlY3QuYm90dG9tIC0gY2VudGVyWSApICogc2luVGhldGE7XHJcbiAgY29uc3Qgcm90YXRlZFkyID0gY2VudGVyWSArICggcmVjdC5yaWdodCAtIGNlbnRlclggKSAqIHNpblRoZXRhICsgKCByZWN0LmJvdHRvbSAtIGNlbnRlclkgKSAqIGNvc1RoZXRhO1xyXG5cclxuICAvLyBDYWxjdWxhdGUgbGVmdCwgdG9wLCBib3R0b20sIGFuZCByaWdodCBjb29yZGluYXRlc1xyXG4gIGNvbnN0IHJvdGF0ZWRMZWZ0ID0gTWF0aC5taW4oIHJvdGF0ZWRYMSwgcm90YXRlZFgyICk7XHJcbiAgY29uc3Qgcm90YXRlZFRvcCA9IE1hdGgubWluKCByb3RhdGVkWTEsIHJvdGF0ZWRZMiApO1xyXG4gIGNvbnN0IHJvdGF0ZWRCb3R0b20gPSBNYXRoLm1heCggcm90YXRlZFkxLCByb3RhdGVkWTIgKTtcclxuICBjb25zdCByb3RhdGVkUmlnaHQgPSBNYXRoLm1heCggcm90YXRlZFgxLCByb3RhdGVkWDIgKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHg6IHJvdGF0ZWRMZWZ0LFxyXG4gICAgeTogcm90YXRlZFRvcCxcclxuICAgIHdpZHRoOiByZWN0LndpZHRoLFxyXG4gICAgaGVpZ2h0OiByZWN0LmhlaWdodCxcclxuICAgIHRvSlNPTjogcmVjdC50b0pTT04sXHJcbiAgICBsZWZ0OiByb3RhdGVkTGVmdCxcclxuICAgIHRvcDogcm90YXRlZFRvcCxcclxuICAgIGJvdHRvbTogcm90YXRlZEJvdHRvbSxcclxuICAgIHJpZ2h0OiByb3RhdGVkUmlnaHQsXHJcbiAgfSBhcyBET01SZWN0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRBY3Rpb25LZXlSdW5PbmNlKCBrZXk6IHN0cmluZywgZXZlbnRLZXlkb3duOiBLZXlib2FyZEV2ZW50Q2FsbGJhY2ssIGV2ZW50S2V5dXA/OiBLZXlib2FyZEV2ZW50Q2FsbGJhY2sgKSB7XHJcbiAgaWYgKCBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93bk9uY2UuaGFzKCBrZXkgKSApIHtcclxuICAgIGRpY3RLZXlzQnlBY3Rpb25LZXlkb3duT25jZS5zZXQoIGtleSwgW2V2ZW50S2V5ZG93biwgLi4uZGljdEtleXNCeUFjdGlvbktleWRvd25PbmNlLmdldCgga2V5ICkhXSApXHJcbiAgfSBlbHNlIHtcclxuICAgIGRpY3RLZXlzQnlBY3Rpb25LZXlkb3duT25jZS5zZXQoIGtleSwgW2V2ZW50S2V5ZG93bl0gKVxyXG4gIH1cclxuXHJcbiAgaWYgKCBldmVudEtleXVwICkge1xyXG4gICAgaWYgKCBkaWN0S2V5c0J5QWN0aW9uS2V5dXAuaGFzKCBrZXkgKSApIHtcclxuICAgICAgZGljdEtleXNCeUFjdGlvbktleXVwLnNldCgga2V5LCBbZXZlbnRLZXl1cCwgLi4uZGljdEtleXNCeUFjdGlvbktleXVwLmdldCgga2V5ICkhXSApXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkaWN0S2V5c0J5QWN0aW9uS2V5dXAuc2V0KCBrZXksIFtldmVudEtleXVwXSApXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRBY3Rpb25LZXlSdW5PblJlcGVhdCgga2V5OiBzdHJpbmcsIGV2ZW50S2V5ZG93bjogS2V5Ym9hcmRFdmVudENhbGxiYWNrLCBldmVudEtleXVwPzogS2V5Ym9hcmRFdmVudENhbGxiYWNrICkge1xyXG4gIGlmICggZGljdEtleXNCeUFjdGlvbktleWRvd25SZXBlYXQuaGFzKCBrZXkgKSApIHtcclxuICAgIGRpY3RLZXlzQnlBY3Rpb25LZXlkb3duUmVwZWF0LnNldCgga2V5LCBbZXZlbnRLZXlkb3duLCAuLi5kaWN0S2V5c0J5QWN0aW9uS2V5ZG93blJlcGVhdC5nZXQoIGtleSApIV0gKVxyXG4gIH0gZWxzZSB7XHJcbiAgICBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93blJlcGVhdC5zZXQoIGtleSwgW2V2ZW50S2V5ZG93bl0gKVxyXG4gIH1cclxuXHJcbiAgaWYgKCBldmVudEtleXVwICkge1xyXG4gICAgaWYgKCBkaWN0S2V5c0J5QWN0aW9uS2V5dXAuaGFzKCBrZXkgKSApIHtcclxuICAgICAgZGljdEtleXNCeUFjdGlvbktleXVwLnNldCgga2V5LCBbZXZlbnRLZXl1cCwgLi4uZGljdEtleXNCeUFjdGlvbktleXVwLmdldCgga2V5ICkhXSApXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkaWN0S2V5c0J5QWN0aW9uS2V5dXAuc2V0KCBrZXksIFtldmVudEtleXVwXSApXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tFbGVtZW50Q29sbGlzaW9uKCBlbGVtZW50MTogSFRNTEVsZW1lbnQsIGVsZW1lbnQyOiBIVE1MRWxlbWVudCwgY2hlY2tCb2R5Um90YXRpb246IGJvb2xlYW4gPSBmYWxzZSApOiBib29sZWFuIHtcclxuICBjb25zdCByZWN0MSA9ICFjaGVja0JvZHlSb3RhdGlvbiA/IGVsZW1lbnQxLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDogZ2V0Um90YXRlZEJvdW5kaW5nQm94QmFzZWRPbkJvZHlSb3RhdGlvbiggZWxlbWVudDEgKTtcclxuICBjb25zdCByZWN0MiA9ICFjaGVja0JvZHlSb3RhdGlvbiA/IGVsZW1lbnQyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDogZ2V0Um90YXRlZEJvdW5kaW5nQm94QmFzZWRPbkJvZHlSb3RhdGlvbiggZWxlbWVudDIgKTtcclxuXHJcbiAgY29uc3QgcmVzdWx0ID0gIShcclxuICAgIHJlY3QxLnRvcCA+IHJlY3QyLmJvdHRvbSB8fFxyXG4gICAgcmVjdDEucmlnaHQgPCByZWN0Mi5sZWZ0IHx8XHJcbiAgICByZWN0MS5ib3R0b20gPCByZWN0Mi50b3AgfHxcclxuICAgIHJlY3QxLmxlZnQgPiByZWN0Mi5yaWdodFxyXG4gICk7XHJcblxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwb2xsRm9yVmFyaWFibGU8VD4oIHZhcmlhYmxlTmFtZTogc3RyaW5nLCByZWFkeUNvbmRpdGlvbjogKCB2YWx1ZTogVCApID0+IGJvb2xlYW4sIGNhbGxiYWNrOiAoIHZhbHVlOiBUICkgPT4gdm9pZCApIHtcclxuICBjb25zdCBwb2xsSW50ZXJ2YWwgPSAxMDA7XHJcbiAgY29uc3QgcG9sbCA9IHNldEludGVydmFsKCAoKSA9PiB7XHJcbiAgICBpZiAoICggd2luZG93IGFzIGFueSApW3ZhcmlhYmxlTmFtZV0gIT09IHVuZGVmaW5lZCAmJiByZWFkeUNvbmRpdGlvbiggKCB3aW5kb3cgYXMgYW55IClbdmFyaWFibGVOYW1lXSApICkge1xyXG4gICAgICAvLyBJZiBib3RoIGNvbmRpdGlvbnMgYXJlIG1ldCwgZXhlY3V0ZSB0aGUgY2FsbGJhY2sgYW5kIHN0b3AgcG9sbGluZ1xyXG4gICAgICBjbGVhckludGVydmFsKCBwb2xsICk7XHJcbiAgICAgIGNhbGxiYWNrKCAoIHdpbmRvdyBhcyBhbnkgKVt2YXJpYWJsZU5hbWVdICk7XHJcbiAgICB9XHJcbiAgfSwgcG9sbEludGVydmFsICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3YWl0VW50aWxFbGVtZW50RXhpc3RzKCBzZWxlY3Rvcjogc3RyaW5nICkge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSggcmVzb2x2ZSA9PiB7XHJcbiAgICBpZiAoIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIHNlbGVjdG9yICkgKSB7XHJcbiAgICAgIHJldHVybiByZXNvbHZlKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzZWxlY3RvciApICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlciggbXV0YXRpb25zID0+IHtcclxuICAgICAgaWYgKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzZWxlY3RvciApICkge1xyXG4gICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICByZXNvbHZlKCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzZWxlY3RvciApICk7XHJcbiAgICAgIH1cclxuICAgIH0gKTtcclxuXHJcbiAgICBvYnNlcnZlci5vYnNlcnZlKCBkb2N1bWVudC5ib2R5LCB7XHJcbiAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgc3VidHJlZTogdHJ1ZVxyXG4gICAgfSApO1xyXG4gIH0gKTtcclxufVxyXG5cclxuLy8vIEdldCB0aGUgZGVmYXVsdCBhdHRyaWJ1dGVzIGZyb20gdGhlIHRhcmdldCBlbGVtZW50XHJcbi8vLyBJZiBoYXZlIG5vdCBkZWZhdWx0IGF0dHJpYnV0ZSB3aXRoIHRoaXMgQGF0dHJpYnV0ZU5hbWUgb24gbWFwIHdpbGwgc2V0IHRoZSBjdXJyZW50IGF0dHJpYnV0ZSBhcyBkZWZhdWx0XHJcbi8vLyBJZiBoYXZlIG5vdCBkZWZhdWx0IGF0dHJpYnV0ZSB3aXRoIHRoaXMgQGF0dHJpYnV0ZU5hbWUgd2lsbCByZXR1cm4gYW4gZW1wdHkgc3RyaW5nXHJcbmV4cG9ydCBjb25zdCBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudCA9IG5ldyBNYXA8SFRNTEVsZW1lbnQsIE1hcDxzdHJpbmcsIHN0cmluZz4+KCk7XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0QXR0cmlidXRlRm9yVGFyZ2V0KCB0YXJnZXQ6IEhUTUxFbGVtZW50LCBhdHRyaWJ1dGVOYW1lOiBzdHJpbmcgKTogc3RyaW5nIHtcclxuICBpZiAoICFtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5oYXMoIHRhcmdldCApICkge1xyXG4gICAgbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuc2V0KCB0YXJnZXQsIG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCkgKTtcclxuICB9XHJcblxyXG4gIGxldCByZXN1bHQ6IHN0cmluZyA9ICcnO1xyXG4gIGNvbnN0IGRlZmF1bHRBdHRyaWJ1dGVWYWx1ZXNCeU5hbWUgPSBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5nZXQoIHRhcmdldCApITtcclxuICBjb25zdCB0YXJnZXREZWZhdWx0QXR0cmlidXRlID0gIWRlZmF1bHRBdHRyaWJ1dGVWYWx1ZXNCeU5hbWUuaGFzKCBhdHRyaWJ1dGVOYW1lICkgPyB0YXJnZXQuZ2V0QXR0cmlidXRlKCBhdHRyaWJ1dGVOYW1lICkgOiBkZWZhdWx0QXR0cmlidXRlVmFsdWVzQnlOYW1lLmdldCggYXR0cmlidXRlTmFtZSApITtcclxuXHJcbiAgcmVzdWx0ID0gdGFyZ2V0RGVmYXVsdEF0dHJpYnV0ZSA/IHRhcmdldERlZmF1bHRBdHRyaWJ1dGUgOiAnJztcclxuICBzZXREZWZhdWx0QXR0cmlidXRlRm9yVGFyZ2V0KCB0YXJnZXQsIGF0dHJpYnV0ZU5hbWUsIHJlc3VsdCApO1xyXG5cclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0RGVmYXVsdEF0dHJpYnV0ZUZvclRhcmdldCggdGFyZ2V0OiBIVE1MRWxlbWVudCwgYXR0cmlidXRlTmFtZTogc3RyaW5nLCBuZXdEZWZhdWx0QXR0cmlidXRlOiBzdHJpbmcgKTogdm9pZCB7XHJcbiAgaWYgKCAhbWFwRGVmYXVsdEF0dHJpYnV0ZXNCeUVsZW1lbnQuaGFzKCB0YXJnZXQgKSApIHtcclxuICAgIG1hcERlZmF1bHRBdHRyaWJ1dGVzQnlFbGVtZW50LnNldCggdGFyZ2V0LCBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpICk7XHJcbiAgfVxyXG5cclxuICBtYXBEZWZhdWx0QXR0cmlidXRlc0J5RWxlbWVudC5nZXQoIHRhcmdldCApIS5zZXQoIGF0dHJpYnV0ZU5hbWUsIG5ld0RlZmF1bHRBdHRyaWJ1dGUgKTtcclxufVxyXG5cclxuLy8vIERpdmlkZSBvIGVsZW1lbnRvIEB0YXJnZXQgZW0gOSBcInF1YWRyYWRvc1wiIGlndWFpcyBlIHJldG9ybmEgZW0gcXVhaXMgcXVhZHJhZG9zIG8gZHJhZ2dhYmxlIGVzdMOhIGNvbGlkaW5kbyBjb20gbyB0YXJnZXRcclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbGxpc2lvbkRpcmVjdGlvbiggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCwgY2hlY2tCb2R5Um90YXRpb246IGJvb2xlYW4gPSBmYWxzZSApOiBDb2xsaXNpb25EaXJlY3Rpb25DaGVjayB7XHJcbiAgY29uc3QgcmVjdDEgPSAhY2hlY2tCb2R5Um90YXRpb24gPyBkcmFnZ2FibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBnZXRSb3RhdGVkQm91bmRpbmdCb3hCYXNlZE9uQm9keVJvdGF0aW9uKCBkcmFnZ2FibGUgKTtcclxuICBjb25zdCByZWN0MiA9ICFjaGVja0JvZHlSb3RhdGlvbiA/IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IGdldFJvdGF0ZWRCb3VuZGluZ0JveEJhc2VkT25Cb2R5Um90YXRpb24oIHRhcmdldCApO1xyXG5cclxuICBjb25zdCBpc1RvcCA9IHJlY3QxLmJvdHRvbSA+IHJlY3QyLnRvcCAmJiByZWN0MS50b3AgPCByZWN0Mi50b3AgKyByZWN0Mi5oZWlnaHQgLyAzO1xyXG4gIGNvbnN0IGlzUmlnaHQgPSByZWN0MS5sZWZ0IDwgcmVjdDIucmlnaHQgJiYgcmVjdDEucmlnaHQgPiByZWN0Mi5yaWdodCAtIHJlY3QyLndpZHRoIC8gMztcclxuICBjb25zdCBpc0NlbnRlciA9IHJlY3QxLnRvcCA8IHJlY3QyLmJvdHRvbSAmJiByZWN0MS5ib3R0b20gPiByZWN0Mi50b3AgJiYgcmVjdDEubGVmdCA8IHJlY3QyLnJpZ2h0ICYmIHJlY3QxLnJpZ2h0ID4gcmVjdDIubGVmdDtcclxuICBjb25zdCBpc0JvdHRvbSA9IHJlY3QxLnRvcCA8IHJlY3QyLmJvdHRvbSAtIHJlY3QyLmhlaWdodCAvIDMgJiYgcmVjdDEuYm90dG9tID4gcmVjdDIuYm90dG9tIC0gcmVjdDIuaGVpZ2h0IC8gMztcclxuICBjb25zdCBpc0xlZnQgPSByZWN0MS5yaWdodCA+IHJlY3QyLmxlZnQgJiYgcmVjdDEubGVmdCA8IHJlY3QyLmxlZnQgKyByZWN0Mi53aWR0aCAvIDM7XHJcblxyXG4gIHJldHVybiB7IHRvcDogaXNUb3AsIHJpZ2h0OiBpc1JpZ2h0LCBjZW50ZXI6IGlzQ2VudGVyLCBib3R0b206IGlzQm90dG9tLCBsZWZ0OiBpc0xlZnQgfTtcclxufVxyXG5cclxuLy8vIHJldHVybiB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgY2VudGVyIG9mIHRoZSBkcmFnZ2FibGUgdG8gdGhlIGNlbnRlciBvZiB0aGUgdGFyZ2V0IGVsZW1lbnQgZnJvbSBlYWNoIGJvcmRlciBcclxuZXhwb3J0IGZ1bmN0aW9uIGdldERpc3RhbmNlRnJvbUJvcmRlciggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCwgY2hlY2tCb2R5Um90YXRpb246IGJvb2xlYW4gPSBmYWxzZSApOiBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSB7XHJcbiAgY29uc3QgcmVjdDEgPSAhY2hlY2tCb2R5Um90YXRpb24gPyBkcmFnZ2FibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBnZXRSb3RhdGVkQm91bmRpbmdCb3hCYXNlZE9uQm9keVJvdGF0aW9uKCBkcmFnZ2FibGUgKTtcclxuICBjb25zdCByZWN0MiA9ICFjaGVja0JvZHlSb3RhdGlvbiA/IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSA6IGdldFJvdGF0ZWRCb3VuZGluZ0JveEJhc2VkT25Cb2R5Um90YXRpb24oIHRhcmdldCApO1xyXG5cclxuICBjb25zdCBjZW50ZXIgPSB7XHJcbiAgICB4OiByZWN0MS5sZWZ0ICsgcmVjdDEud2lkdGggLyAyLFxyXG4gICAgeTogcmVjdDEudG9wICsgcmVjdDEuaGVpZ2h0IC8gMixcclxuICB9O1xyXG5cclxuICBjb25zdCBkaXN0YW5jZUZyb21Cb3JkZXI6IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlID0ge1xyXG4gICAgdG9wOiBjZW50ZXIueSAtIHJlY3QyLnRvcCxcclxuICAgIHJpZ2h0OiByZWN0Mi5yaWdodCAtIGNlbnRlci54LFxyXG4gICAgYm90dG9tOiByZWN0Mi5ib3R0b20gLSBjZW50ZXIueSxcclxuICAgIGxlZnQ6IGNlbnRlci54IC0gcmVjdDIubGVmdCxcclxuICB9O1xyXG5cclxuICByZXR1cm4gZGlzdGFuY2VGcm9tQm9yZGVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBydW5Pbmx5T25jZUtleWRvd25BY3Rpb25zKCBldnQ6IEtleWJvYXJkRXZlbnQgKSB7XHJcbiAgZm9yICggY29uc3QgcGFpciBvZiBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93bk9uY2UgKSB7XHJcbiAgICBpZiAoIGV2dC5jb2RlID09PSBwYWlyWzBdICkge1xyXG4gICAgICBwYWlyWzFdLmZvckVhY2goIGtiRXZlbnQgPT4ga2JFdmVudCggZXZ0ICkgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJ1bktleWRvd25BY3Rpb25zUmVwZWF0KCBldnQ6IEtleWJvYXJkRXZlbnQgKSB7XHJcbiAgZm9yICggY29uc3QgcGFpciBvZiBkaWN0S2V5c0J5QWN0aW9uS2V5ZG93blJlcGVhdCApIHtcclxuICAgIGlmICggZXZ0LmNvZGUgPT09IHBhaXJbMF0gKSB7XHJcbiAgICAgIHBhaXJbMV0uZm9yRWFjaCgga2JFdmVudCA9PiBrYkV2ZW50KCBldnQgKSApO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgZXZ0ID0+IHtcclxuICBpZiAoICFldnQucmVwZWF0ICkge1xyXG4gICAgcnVuT25seU9uY2VLZXlkb3duQWN0aW9ucyggZXZ0ICk7XHJcbiAgfVxyXG5cclxuICBydW5LZXlkb3duQWN0aW9uc1JlcGVhdCggZXZ0ICk7XHJcbn0gKTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5dXAnLCBldnQgPT4ge1xyXG4gIGZvciAoIGNvbnN0IHBhaXIgb2YgZGljdEtleXNCeUFjdGlvbktleXVwICkge1xyXG4gICAgaWYgKCBldnQuY29kZSA9PT0gcGFpclswXSApIHtcclxuICAgICAgcGFpclsxXS5mb3JFYWNoKCBrYkV2ZW50ID0+IGtiRXZlbnQoIGV2dCApICk7XHJcbiAgICB9XHJcbiAgfVxyXG59ICk7XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRSb3RhdGlvbkluRGVncmVlcyggZWxlbWVudDogSFRNTEVsZW1lbnQsIGF4aXM6ICd4JyB8ICd5JyB8ICd6JyA9ICd4JyApOiBudW1iZXIge1xyXG4gIGxldCByZWdleE1hdGNoUm90YXRlVmFsdWU6IFJlZ0V4cDtcclxuICBzd2l0Y2ggKCBheGlzICkge1xyXG4gICAgY2FzZSAneCc6XHJcbiAgICAgIHJlZ2V4TWF0Y2hSb3RhdGVWYWx1ZSA9IHJlZ2V4R3JvdXBSb3RhdGVYVmFsdWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAneSc6XHJcbiAgICAgIHJlZ2V4TWF0Y2hSb3RhdGVWYWx1ZSA9IHJlZ2V4R3JvdXBSb3RhdGVZVmFsdWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAneic6XHJcbiAgICAgIHJlZ2V4TWF0Y2hSb3RhdGVWYWx1ZSA9IHJlZ2V4R3JvdXBSb3RhdGVaVmFsdWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmVnZXhNYXRjaFJvdGF0ZVZhbHVlID0gcmVnZXhHcm91cFJvdGF0ZVZhbHVlO1xyXG4gICAgICBicmVhaztcclxuICB9XHJcblxyXG4gIGNvbnN0IG1hdGNoID0gcmVnZXhNYXRjaFJvdGF0ZVZhbHVlLmV4ZWMoIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtICk7XHJcbiAgaWYgKCBtYXRjaCApIHtcclxuICAgIGNvbnN0IHJvdGF0aW9uVmFsdWUgPSBwYXJzZUZsb2F0KCBtYXRjaFsxXSApO1xyXG4gICAgcmV0dXJuIHJvdGF0aW9uVmFsdWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiAwO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEJvZHlSb3RhdGlvbkluRGVncmVlcygpOiBudW1iZXIge1xyXG4gIGNvbnN0IG1hdGNoID0gZ2V0UmVnZXhSZW1vdmVSb3RhdGlvbkZyb21Cb2R5KCkuZXhlYyggZG9jdW1lbnQuYm9keS5zdHlsZS50cmFuc2Zvcm0gKTtcclxuICBpZiAoIG1hdGNoICkge1xyXG4gICAgY29uc3Qgcm90YXRpb25WYWx1ZSA9IHBhcnNlRmxvYXQoIG1hdGNoWzFdICk7XHJcbiAgICByZXR1cm4gcm90YXRpb25WYWx1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVnZXhSZW1vdmVSb3RhdGlvbkZyb21Cb2R5KCkge1xyXG4gIHJldHVybiBnZXRSZWdleFJlbW92ZVJvdGF0aW9uQmFzZWRPbkF4aXMoIGdldEJvZHlSb3RhdGlvbkF4aXMoKSApXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWdleFJlbW92ZVJvdGF0aW9uQmFzZWRPbkF4aXMoIGF4aXM6ICd4JyB8ICd5JyB8ICd6JyApIHtcclxuICBzd2l0Y2ggKCBheGlzICkge1xyXG4gICAgY2FzZSAneCc6XHJcbiAgICAgIHJldHVybiByZWdleEdyb3VwUm90YXRlWFZhbHVlO1xyXG4gICAgY2FzZSAneSc6XHJcbiAgICAgIHJldHVybiByZWdleEdyb3VwUm90YXRlWVZhbHVlO1xyXG4gICAgY2FzZSAneic6XHJcbiAgICAgIHJldHVybiByZWdleEdyb3VwUm90YXRlWlZhbHVlO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmV0dXJuIHJlZ2V4R3JvdXBSb3RhdGVWYWx1ZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRCb2R5Um90YXRpb25BeGlzKCk6ICd4JyB8ICd5JyB8ICd6JyB7XHJcbiAgcmV0dXJuIGdldEVsZW1lbnRSb3RhdGlvbkF4aXMoIGRvY3VtZW50LmJvZHkgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnRSb3RhdGlvbkF4aXMoIGVsZW1lbnQ6IEhUTUxFbGVtZW50ICk6ICd4JyB8ICd5JyB8ICd6JyB7XHJcbiAgY29uc3QgZWxlbWVudFRyYW5zZm9ybSA9IGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtLnRvTG93ZXJDYXNlKCk7XHJcbiAgaWYgKCBlbGVtZW50VHJhbnNmb3JtLmluY2x1ZGVzKCAneCcgKSApIHtcclxuICAgIHJldHVybiAneCc7XHJcbiAgfSBlbHNlIGlmICggZWxlbWVudFRyYW5zZm9ybS5pbmNsdWRlcyggJ3knICkgKSB7XHJcbiAgICByZXR1cm4gJ3knO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gJ3onO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRyYW5zZm9ybUNvb3Jkc0Zyb21FbGVtZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCwgY2hlY2tCb2R5Um90YXRpb246IGJvb2xlYW4gPSBmYWxzZSApOiBQb2ludDJEIHtcclxuICBjb25zdCBhcnJDb21wdXRlZERyYWdnYWJsZVRyYW5zbGF0ZSA9ICggd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGVsZW1lbnQgKS50cmFuc2Zvcm0ubWF0Y2goIHJlZ2V4TnVtYmVyUGF0dGVybiApID8/IFswLCAwXSApLm1hcCggbiA9PiArbiApO1xyXG5cclxuICBsZXQgcmVzdWx0ID0ge1xyXG4gICAgeDogYXJyQ29tcHV0ZWREcmFnZ2FibGVUcmFuc2xhdGVbNF0gIT09IHVuZGVmaW5lZCA/IE1hdGgucm91bmQoIGFyckNvbXB1dGVkRHJhZ2dhYmxlVHJhbnNsYXRlWzRdICkgOiAwLFxyXG4gICAgeTogYXJyQ29tcHV0ZWREcmFnZ2FibGVUcmFuc2xhdGVbNV0gIT09IHVuZGVmaW5lZCA/IE1hdGgucm91bmQoIGFyckNvbXB1dGVkRHJhZ2dhYmxlVHJhbnNsYXRlWzVdICkgOiAwXHJcbiAgfVxyXG5cclxuICBpZiAoIGNoZWNrQm9keVJvdGF0aW9uICkge1xyXG4gICAgY29uc3QgYm9keUFuZ2xlID0gZ2V0RWxlbWVudFJvdGF0aW9uSW5EZWdyZWVzKCBkb2N1bWVudC5ib2R5LCBnZXRFbGVtZW50Um90YXRpb25BeGlzKCBlbGVtZW50ICkgKSB8fCAwO1xyXG4gICAgcmV0dXJuIHJvdGF0ZUNvb3JkaW5hdGVzKCByZXN1bHQueCwgcmVzdWx0LnksIGJvZHlBbmdsZSApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsaWNrRXZlbnRUb0Nvb3JkaW5hdGVzKCBldmVudDogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQgKSB7XHJcbiAgaWYgKCBldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiBldmVudC5jbGllbnRYLFxyXG4gICAgICB5OiBldmVudC5jbGllbnRZXHJcbiAgICB9O1xyXG4gIH0gZWxzZSBpZiAoIGV2ZW50IGluc3RhbmNlb2YgVG91Y2hFdmVudCApIHtcclxuICAgIGNvbnN0IHRvdWNoID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiB0b3VjaC5jbGllbnRYLFxyXG4gICAgICB5OiB0b3VjaC5jbGllbnRZXHJcbiAgICB9O1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aHJvdyBcIkV2ZW50IG5vdCBGb3VuZFwiO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnZpc2libGVEaXZBYm92ZVBhcmVudCggeyBwYXJlbnRFbGVtZW50LCBpZCwgcG9zaXRpb24sIGRpbWVuc2lvbnMgfTogeyBwYXJlbnRFbGVtZW50OiBIVE1MRWxlbWVudDsgaWQ6IHN0cmluZzsgcG9zaXRpb24/OiB7IHRvcDogbnVtYmVyOyBsZWZ0OiBudW1iZXI7IH07IGRpbWVuc2lvbnM/OiBEaW1lbnNpb25zOyB9ICkge1xyXG4gIHZhciBpbnZpc2libGVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG5cclxuICBpZiAoICFwYXJlbnRFbGVtZW50LnN0eWxlLnBvc2l0aW9uICkge1xyXG4gICAgcGFyZW50RWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcbiAgfVxyXG5cclxuICBpbnZpc2libGVEaXYuaWQgPSBpZDtcclxuICBpbnZpc2libGVEaXYuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gIGludmlzaWJsZURpdi5zdHlsZS53aWR0aCA9IGRpbWVuc2lvbnMgJiYgZGltZW5zaW9ucy53aWR0aCA/IGRpbWVuc2lvbnMud2lkdGgudG9TdHJpbmcoKSArICdweCcgOiAnMTAwJSc7XHJcbiAgaW52aXNpYmxlRGl2LnN0eWxlLmhlaWdodCA9IGRpbWVuc2lvbnMgJiYgZGltZW5zaW9ucy5oZWlnaHQgPyBkaW1lbnNpb25zLmhlaWdodC50b1N0cmluZygpICsgJ3B4JyA6ICcxMDAlJztcclxuICBpbnZpc2libGVEaXYuc3R5bGUudG9wID0gKCBwb3NpdGlvbj8udG9wLnRvU3RyaW5nKCkgPz8gJzAnICkgKyAncHgnO1xyXG4gIGludmlzaWJsZURpdi5zdHlsZS5sZWZ0ID0gKCBwb3NpdGlvbj8ubGVmdC50b1N0cmluZygpID8/ICcwJyApICsgJ3B4JztcclxuICBpbnZpc2libGVEaXYuc3R5bGUub3BhY2l0eSA9ICcwJzsgLy8gTWFrZSB0aGUgZGl2IGludmlzaWJsZVxyXG4gIGludmlzaWJsZURpdi5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nOyAvLyBBbGxvdyB0aGUgZGl2IHRvIGludGVyY2VwdCBtb3VzZSBldmVudHNcclxuXHJcbiAgcGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZCggaW52aXNpYmxlRGl2ICk7XHJcblxyXG4gIHJldHVybiBpbnZpc2libGVEaXY7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoaWRlRWxlbWVudCggZWxlbWVudDogSFRNTEVsZW1lbnQgKSB7XHJcbiAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICBlbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICBlbGVtZW50LnN0eWxlLnpJbmRleCA9ICctMSc7XHJcbiAgZWxlbWVudC5zdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG4gIGVsZW1lbnQuc3R5bGUud2lkdGggPSAnMHB4ICFpbXBvcnRhbnQnO1xyXG4gIGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzBweCAhaW1wb3J0YW50JztcclxuICBlbGVtZW50LnNldEF0dHJpYnV0ZSggJ2hpZGRlbicsICcnICk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzbGVlcEFzeW5jKCBtczogbnVtYmVyICkge1xyXG4gIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPiggKCByZXNvbHZlICkgPT4gc2V0VGltZW91dCggKCkgPT4gcmVzb2x2ZSgpLCBtcyApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBiaW5kRWxlbWVudHNCeUNoZWNrKCB0cmlnZ2VyRWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgdGFyZ2V0RWxlbWVudDogSFRNTEVsZW1lbnQsIG9uQ2hlY2s6IEZ1bmN0aW9uLCBvblVuY2hlY2s6IEZ1bmN0aW9uICkge1xyXG4gIGlmICggdHJpZ2dlckVsZW1lbnQuY2hlY2tlZCApIHtcclxuICAgIG9uQ2hlY2soIHRhcmdldEVsZW1lbnQgKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRyaWdnZXJHcm91cCA9IHRyaWdnZXJFbGVtZW50Lm5hbWVcclxuICAgID8gQXJyYXkuZnJvbSggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggYFtuYW1lPVwiJHsgdHJpZ2dlckVsZW1lbnQubmFtZSB9XCJdYCApIClcclxuICAgIDogW3RyaWdnZXJFbGVtZW50XTtcclxuXHJcbiAgdHJpZ2dlckdyb3VwLmZvckVhY2goIHQgPT4gdC5hZGRFdmVudExpc3RlbmVyKCAnY2hhbmdlJywgZXZ0ID0+IHtcclxuICAgIGlmICggdHJpZ2dlckVsZW1lbnQuY2hlY2tlZCApIHtcclxuICAgICAgb25DaGVjayggdGFyZ2V0RWxlbWVudCwgZXZ0ICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBvblVuY2hlY2soIHRhcmdldEVsZW1lbnQsIGV2dCApO1xyXG4gICAgfVxyXG4gIH0gKSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0SW5wdXRGb3JjZVBob25lTnVtYmVyRm9ybWF0KCBpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQgKSB7XHJcbiAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdpbnB1dCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIGxldCBwaG9uZUlucHV0ID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICBjb25zdCBjbGVhblBob25lSW5wdXQgPSBwaG9uZUlucHV0LnJlcGxhY2UoIC9cXEQvZywgJycgKTtcclxuICAgIGlmICggY2xlYW5QaG9uZUlucHV0Lmxlbmd0aCA+IDExICkge1xyXG4gICAgICBwaG9uZUlucHV0ID0gY2xlYW5QaG9uZUlucHV0LnNsaWNlKCAwLCAxMSApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBwaG9uZU51bWJlckZvcm1hdHRlZCA9IHRvUGhvbmVOdW1iZXIoIHBob25lSW5wdXQgKTtcclxuXHJcbiAgICBpZiAoIHBob25lTnVtYmVyRm9ybWF0dGVkLmxlbmd0aCA9PT0gMTAgKSB7XHJcbiAgICAgIHBob25lTnVtYmVyRm9ybWF0dGVkID0gcGhvbmVOdW1iZXJGb3JtYXR0ZWQucmVwbGFjZUFsbCggJy0nLCAnJyApO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudmFsdWUgPSBwaG9uZU51bWJlckZvcm1hdHRlZDtcclxuICB9ICk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNNb2JpbGVCcm93c2VyKCkge1xyXG4gIHJldHVybiAvQW5kcm9pZHxpUGhvbmUvaS50ZXN0KCBuYXZpZ2F0b3IudXNlckFnZW50ICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyRGV2aWNlVHlwZSgpOiAnYW5kcm9pZCcgfCAnYXBwbGUnIHwgJ2Rlc2t0b3AnIHtcclxuICB2YXIgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8ICggd2luZG93IGFzIGFueSApLm9wZXJhO1xyXG5cclxuICBpZiAoIC9hbmRyb2lkL2kudGVzdCggdXNlckFnZW50ICkgKSB7XHJcbiAgICByZXR1cm4gJ2FuZHJvaWQnO1xyXG4gIH0gZWxzZSBpZiAoIC9pUGFkfGlQaG9uZXxpUG9kLy50ZXN0KCB1c2VyQWdlbnQgKSAmJiAhKCB3aW5kb3cgYXMgYW55ICkuTVNTdHJlYW0gKSB7XHJcbiAgICByZXR1cm4gJ2FwcGxlJztcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuICdkZXNrdG9wJztcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc09uU2NyZWVuKCBlbGVtZW50OiBIVE1MRWxlbWVudCApIHtcclxuICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICByZXR1cm4gKFxyXG4gICAgcmVjdC50b3AgPj0gMCAmJlxyXG4gICAgcmVjdC5sZWZ0ID49IDAgJiZcclxuICAgIHJlY3QuYm90dG9tIDw9ICggd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKSAmJlxyXG4gICAgcmVjdC5yaWdodCA8PSAoIHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCApXHJcbiAgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRFbGVtZW50Vmlld0lmQ2hlY2tlZCggdHJpZ2dlckVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIHRhcmdldEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsIG9wdGlvbnMgPSB7XHJcbiAgb25DaGVjazogKCB0cmlnZ2VyRWxlbWVudDogSFRNTElucHV0RWxlbWVudCwgdGFyZ2V0RWxlbWVudDogSFRNTEVsZW1lbnQgKSA9PiB7IH0sXHJcbiAgb25VbmNoZWNrOiAoIHRyaWdnZXJFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50LCB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudCApID0+IHsgfVxyXG59ICkge1xyXG4gIGJpbmRFbGVtZW50c0J5Q2hlY2soXHJcbiAgICB0cmlnZ2VyRWxlbWVudCxcclxuICAgIHRhcmdldEVsZW1lbnQsXHJcbiAgICAoIGVsOiBIVE1MRWxlbWVudCApID0+IHtcclxuICAgICAgZWwuY2xhc3NMaXN0LmFkZCggJ3Nob3cnICk7XHJcbiAgICAgIG9wdGlvbnMub25DaGVjayggdHJpZ2dlckVsZW1lbnQsIHRhcmdldEVsZW1lbnQgKTtcclxuICAgIH0sXHJcbiAgICAoIGVsOiBIVE1MRWxlbWVudCApID0+IHtcclxuICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSggJ3Nob3cnICk7XHJcbiAgICAgIG9wdGlvbnMub25VbmNoZWNrKCB0cmlnZ2VyRWxlbWVudCwgdGFyZ2V0RWxlbWVudCApO1xyXG4gICAgfSxcclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmFsdWVGcm9tUmFkaW9Hcm91cCggZ3JvdXBOYW1lOiBzdHJpbmcgKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIGBbbmFtZT0keyBncm91cE5hbWUgfV06Y2hlY2tlZGAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gIGlmICggZWwgKSB7XHJcbiAgICByZXR1cm4gZWwudmFsdWU7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNtb290aFNjcm9sbCggdGFyZ2V0WTogbnVtYmVyLCBkdXJhdGlvbjogbnVtYmVyICk6IHZvaWQge1xyXG4gIGNvbnN0IHN0YXJ0WSA9IHdpbmRvdy5zY3JvbGxZIHx8IHdpbmRvdy5wYWdlWU9mZnNldDtcclxuICBsZXQgc3RhcnRUaW1lOiBudW1iZXIgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgZnVuY3Rpb24gc3RlcCggY3VycmVudFRpbWU6IG51bWJlciApIHtcclxuICAgIGlmICggIXN0YXJ0VGltZSApIHN0YXJ0VGltZSA9IGN1cnJlbnRUaW1lO1xyXG4gICAgY29uc3QgZWxhcHNlZFRpbWUgPSBjdXJyZW50VGltZSAtIHN0YXJ0VGltZTtcclxuICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5taW4oIGVsYXBzZWRUaW1lIC8gZHVyYXRpb24sIDEgKTtcclxuICAgIGNvbnN0IGVhc2VkUHJvZ3Jlc3MgPSBsZXJwKCAwLCAxLCBwcm9ncmVzcyApO1xyXG4gICAgd2luZG93LnNjcm9sbFRvKCAwLCBsZXJwKCBzdGFydFksIHRhcmdldFksIGVhc2VkUHJvZ3Jlc3MgKSApO1xyXG4gICAgaWYgKCBlbGFwc2VkVGltZSA8IGR1cmF0aW9uICkge1xyXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIHN0ZXAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZSggc3RlcCApO1xyXG59XHJcblxyXG4vLyBSZXRvcm5hIHVtYSBmdW7Dp8OjbyBxdWUgbsOjbyB2YWkgc2VyIGNvbXBsZXRhZGEgY2FzbyBzZWphIGNoYW1hZGEgbm92YW1lbnRlIGVtIHsgZGVsYXkgfSBtaWxpc3NlZ3VuZG9zXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZUZhY3RvcnkoIGZ1bmM6IEZ1bmN0aW9uLCBkZWxheTogbnVtYmVyICk6IEZ1bmN0aW9uIHtcclxuICBsZXQgaW5EZWJvdW5jZTogbnVtYmVyO1xyXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gd2luZG93O1xyXG4gICAgY29uc3QgYXJncyA9IGFyZ3VtZW50cztcclxuICAgIGNsZWFyVGltZW91dCggaW5EZWJvdW5jZSApO1xyXG4gICAgaW5EZWJvdW5jZSA9IHdpbmRvdy5zZXRUaW1lb3V0KCAoKSA9PiBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICksIGRlbGF5ICk7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gUmV0b3JuYSB1bWEgZnVuw6fDo28gcXVlIHPDsyBwb2RlIHNlciBjb21wbGV0YWRhIHVtYSB2ZXogYSBjYWRhIHsgbGltaXQgfSBtaWxpc3NlZ3VuZG9zIFxyXG5leHBvcnQgZnVuY3Rpb24gdGhyb3R0bGVGYWN0b3J5KCBmdW5jOiBGdW5jdGlvbiwgbGltaXQ6IG51bWJlciApOiBGdW5jdGlvbiB7XHJcbiAgbGV0IGxhc3RGdW5jOiBudW1iZXI7XHJcbiAgbGV0IGxhc3RSYW46IG51bWJlcjtcclxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgY29udGV4dCA9IHdpbmRvdztcclxuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICBpZiAoICFsYXN0UmFuICkge1xyXG4gICAgICBmdW5jLmFwcGx5KCBjb250ZXh0LCBhcmdzICk7XHJcbiAgICAgIGxhc3RSYW4gPSBEYXRlLm5vdygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KCBsYXN0RnVuYyApO1xyXG4gICAgICBsYXN0RnVuYyA9IHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCBEYXRlLm5vdygpIC0gbGFzdFJhbiA+PSBsaW1pdCApIHtcclxuICAgICAgICAgIGZ1bmMuYXBwbHkoIGNvbnRleHQsIGFyZ3MgKTtcclxuICAgICAgICAgIGxhc3RSYW4gPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgbGltaXQgLSAoIERhdGUubm93KCkgLSBsYXN0UmFuICkgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzbW9vdGhTY3JvbGxUbyggcG9zOiBudW1iZXIgKTogdm9pZCB7XHJcbiAgZG9jdW1lbnQuYm9keS5zY3JvbGxUbygge1xyXG4gICAgdG9wOiBwb3MsXHJcbiAgICBiZWhhdmlvcjogJ3Ntb290aCcsXHJcbiAgfSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc21vb3RoU2Nyb2xsVG9FbGVtZW50KCBlbGVtZW50OiBIVE1MRWxlbWVudCwgdXNlQnJvd3NlckRlZmF1bHRzOiBib29sZWFuID0gdHJ1ZSApOiB2b2lkIHtcclxuICBpZiAoICF1c2VCcm93c2VyRGVmYXVsdHMgKSB7XHJcbiAgICBjb25zdCB0YXJnZXRZID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyB3aW5kb3cuc2Nyb2xsWTtcclxuICAgIGNvbnN0IGR1cmF0aW9uID0gMTAwMDsgLy8gRHVyYcOnw6NvIGZpeGEgZW0gbWlsaXNzZWd1bmRvcyAoMSBzZWd1bmRvKVxyXG4gICAgc21vb3RoU2Nyb2xsKCB0YXJnZXRZLCBkdXJhdGlvbiApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgZG9jdW1lbnQuYm9keS5zY3JvbGxUbygge1xyXG4gICAgdG9wOiBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnksXHJcbiAgICBsZWZ0OiBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLngsXHJcbiAgICBiZWhhdmlvcjogJ3Ntb290aCcsXHJcbiAgfSApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0T3B0aW9uQnlUZXh0KCBpZFNlbGVjdEVsZW1lbnQ6IHN0cmluZywgc2VhcmNoVGV4dDogc3RyaW5nLCBjb250YWluczogYm9vbGVhbiA9IGZhbHNlICk6IHZvaWQge1xyXG4gIGNvbnN0IHNlbGVjdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggaWRTZWxlY3RFbGVtZW50ICkgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcblxyXG4gIGlmICggIXNlbGVjdEVsZW1lbnQgKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBjb25zdCBvcHRpb25zRWxlbWVudG9TZWxlY3QgPSBbLi4uc2VsZWN0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCAnb3B0aW9uJyApXTtcclxuXHJcbiAgbGV0IHNlbGVjdGVkT3B0aW9uO1xyXG4gIGlmICggY29udGFpbnMgKSB7XHJcbiAgICBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnNFbGVtZW50b1NlbGVjdFxyXG4gICAgICAuZmlsdGVyKCBlbCA9PiBlbC50ZXh0Q29udGVudCAmJiBlbC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkgKSApWzBdLnZhbHVlO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBzZWxlY3RlZE9wdGlvbiA9IG9wdGlvbnNFbGVtZW50b1NlbGVjdFxyXG4gICAgICAuZmlsdGVyKCBlbCA9PiBlbC50ZXh0Q29udGVudCAmJiBlbC50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpID09PSBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCkgKVswXS52YWx1ZTtcclxuICB9XHJcblxyXG4gIHNlbGVjdEVsZW1lbnQudmFsdWUgPSBzZWxlY3RlZE9wdGlvbjtcclxufVxyXG5cclxuIiwiZXhwb3J0IGNvbnN0IHJlZ2V4TnVtYmVyUGF0dGVybiA9IC8tP1xcZCtcXC4/XFxkKi9nO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQb2ludDJEIHtcclxuICB4OiBudW1iZXI7XHJcbiAgeTogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERpbWVuc2lvbnMge1xyXG4gIHdpZHRoOiBudW1iZXI7XHJcbiAgaGVpZ2h0OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbmRleFRvUm93KCBpbmRleDogbnVtYmVyLCBncmlkV2lkdGg6IG51bWJlciApIHtcclxuICByZXR1cm4gTWF0aC5mbG9vciggaW5kZXggLyBncmlkV2lkdGggKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGluZGV4VG9Db2woIGluZGV4OiBudW1iZXIsIGdyaWRXaWR0aDogbnVtYmVyICkge1xyXG4gIHJldHVybiBpbmRleCAlIGdyaWRXaWR0aDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJvd0NvbFRvSW5kZXgoIHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgd2lkdGg6IG51bWJlciApIHtcclxuICByZXR1cm4gKCByb3cgKiB3aWR0aCApICsgY29sO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlQ29vcmRpbmF0ZXNGcm9tUG9pbnQyRCggY29vcmRzOiBQb2ludDJELCBhbmdsZTogbnVtYmVyICk6IFBvaW50MkQge1xyXG4gIGNvbnN0IHJhZGlhbnMgPSAoIE1hdGguUEkgLyAxODAgKSAqIGFuZ2xlO1xyXG4gIGNvbnN0IG5ld1ggPSBjb29yZHMueCAqIE1hdGguY29zKCByYWRpYW5zICkgLSBjb29yZHMueSAqIE1hdGguc2luKCByYWRpYW5zICk7XHJcbiAgY29uc3QgbmV3WSA9IGNvb3Jkcy54ICogTWF0aC5zaW4oIHJhZGlhbnMgKSArIGNvb3Jkcy55ICogTWF0aC5jb3MoIHJhZGlhbnMgKTtcclxuICByZXR1cm4geyB4OiBuZXdYLCB5OiBuZXdZIH07XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlQ29vcmRpbmF0ZXMoIHg6IG51bWJlciwgeTogbnVtYmVyLCBhbmdsZTogbnVtYmVyICk6IFBvaW50MkQge1xyXG4gIGNvbnN0IHJhZGlhbnMgPSAoIE1hdGguUEkgLyAxODAgKSAqIGFuZ2xlO1xyXG4gIGNvbnN0IG5ld1ggPSB4ICogTWF0aC5jb3MoIHJhZGlhbnMgKSAtIHkgKiBNYXRoLnNpbiggcmFkaWFucyApO1xyXG4gIGNvbnN0IG5ld1kgPSB4ICogTWF0aC5zaW4oIHJhZGlhbnMgKSArIHkgKiBNYXRoLmNvcyggcmFkaWFucyApO1xyXG4gIHJldHVybiB7IHg6IG5ld1gsIHk6IG5ld1kgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFyZURpYWdvbmFscyggaW5kZXgxOiBudW1iZXIsIGluZGV4MjogbnVtYmVyLCBncmlkU2l6ZTogbnVtYmVyICk6IGJvb2xlYW4ge1xyXG4gIGlmICggaW5kZXgxIDwgMCB8fCBpbmRleDIgPCAwICkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCAnSW52YWxpZCBjZWxsIGluZGljZXMnICk7XHJcbiAgfVxyXG5cclxuICBjb25zdCByb3cxID0gaW5kZXhUb1JvdyggaW5kZXgxLCBncmlkU2l6ZSApO1xyXG4gIGNvbnN0IGNvbDEgPSBpbmRleFRvQ29sKCBpbmRleDEsIGdyaWRTaXplICk7XHJcblxyXG4gIGNvbnN0IHJvdzIgPSBpbmRleFRvUm93KCBpbmRleDIsIGdyaWRTaXplICk7XHJcbiAgY29uc3QgY29sMiA9IGluZGV4VG9Db2woIGluZGV4MiwgZ3JpZFNpemUgKTtcclxuXHJcbiAgcmV0dXJuIE1hdGguYWJzKCByb3cxIC0gcm93MiApID09PSBNYXRoLmFicyggY29sMSAtIGNvbDIgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGluZGV4VG9Qb2ludDJEKCBpbmRleDogbnVtYmVyLCBncmlkV2lkdGg6IG51bWJlciApOiBQb2ludDJEIHtcclxuICByZXR1cm4ge1xyXG4gICAgeDogaW5kZXhUb0NvbCggaW5kZXgsIGdyaWRXaWR0aCApLFxyXG4gICAgeTogaW5kZXhUb1JvdyggaW5kZXgsIGdyaWRXaWR0aCApXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbGVycCggbWluOiBudW1iZXIsIG1heDogbnVtYmVyLCBhbW91bnQ6IG51bWJlciApOiBudW1iZXIge1xyXG4gIHJldHVybiAoIDEgLSBhbW91bnQgKSAqIG1pbiArIGFtb3VudCAqIG1heDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGludmVyc2VMZXJwKCBhOiBudW1iZXIsIGI6IG51bWJlciwgdmFsOiBudW1iZXIgKTogbnVtYmVyIHtcclxuICByZXR1cm4gKCB2YWwgLSBhICkgLyAoIGIgLSBhICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1hcCggaW5NaW46IG51bWJlciwgaW5NYXg6IG51bWJlciwgb3V0TWluOiBudW1iZXIsIG91dE1heDogbnVtYmVyLCB2YWw6IG51bWJlciApOiBudW1iZXIge1xyXG4gIHJldHVybiBsZXJwKCBvdXRNaW4sIG91dE1heCwgaW52ZXJzZUxlcnAoIGluTWluLCBpbk1heCwgdmFsICkgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFJhbmRvbUludEV4Y2x1c2l2ZSggbWluOiBudW1iZXIsIG1heDogbnVtYmVyICkge1xyXG4gIHJldHVybiBNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogKCBtYXggLSBtaW4gKSArIG1pbiApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNFcXVhbFNldHM8VD4oIHNldDE6IFNldDxUPiwgc2V0MjogU2V0PFQ+ICkge1xyXG4gIHJldHVybiBzZXQxLnNpemUgPT09IHNldDIuc2l6ZSAmJlxyXG4gICAgWy4uLnNldDFdLmV2ZXJ5KCAoIHggKSA9PiBzZXQyLmhhcyggeCApICk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSYW5kb21JbnRJbmNsdXNpdmUoIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciApIHtcclxuICBtaW4gPSBNYXRoLmNlaWwoIG1pbiApO1xyXG4gIG1heCA9IE1hdGguZmxvb3IoIG1heCApO1xyXG4gIHJldHVybiBNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogKCBtYXggLSBtaW4gKyAxICkgKSArIG1pbjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFJhbmRvbUZyb21BcnJheTxUPiggYXJyOiBBcnJheTxUPiApIHtcclxuICByZXR1cm4gYXJyW2dldFJhbmRvbUludEV4Y2x1c2l2ZSggMCwgYXJyLmxlbmd0aCApXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKCBudW06IG51bWJlciA9IDAsIG1pbjogbnVtYmVyID0gMCwgbWF4OiBudW1iZXIgPSAxMDAgKTogbnVtYmVyIHtcclxuICByZXR1cm4gTWF0aC5tYXgoIG1pbiwgTWF0aC5taW4oIG51bSwgbWF4ICkgKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1pbnV0ZXNUb01pbGxpc2Vjb25kcyggbXM6IG51bWJlciApIHtcclxuICByZXR1cm4gbXMgKiA2MDAwMDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1pbGxpc2Vjb25kc1RvTWludXRlcyggbXM6IG51bWJlciApIHtcclxuICByZXR1cm4gbXMgLyA2MDAwMDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1pbGxpc2Vjb25kc1RvSG91cnMoIG1zOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIG1zIC8gMy42ZSs2O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWlsbGlzZWNvbmRzVG9EYXlzKCBtczogbnVtYmVyICkge1xyXG4gIHJldHVybiBtcyAvIDguNjRlKzc7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtZWdhYnl0ZVRvQnl0ZSggbWI6IG51bWJlciApIHtcclxuICByZXR1cm4gbWIgKiAxMDI0ICogMTAyNDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ5dGVUb01lZ2FieXRlKCBiOiBudW1iZXIgKSB7XHJcbiAgcmV0dXJuIGIgLyAxMDI0IC8gMTAyNDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFycmF5RnJvbVJhbmdlKCBzaXplOiBudW1iZXIsIHN0YXJ0aW5nRnJvbTogbnVtYmVyID0gMCApOiBudW1iZXJbXSB7XHJcbiAgbGV0IHJlc3VsdCA9IFsuLi5BcnJheSggc2l6ZSApLmtleXMoKV1cclxuXHJcbiAgaWYgKCBzdGFydGluZ0Zyb20gIT0gMCApIHtcclxuICAgIHJlc3VsdCA9IHJlc3VsdC5tYXAoIGkgPT4gaSArIHN0YXJ0aW5nRnJvbSApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufSIsImltcG9ydCB7IFlvdXR1YmVJZnJhbWUgfSBmcm9tICcuL1lvdXR1YmVJZnJhbWUnO1xyXG5pbXBvcnQgeyBJUG9pbnQyRCB9IGZyb20gJy4vaW50ZXJmYWNlcyc7XHJcblxyXG5leHBvcnQgZW51bSBDT05WRVJTSU9OX1VOSVQgeyBQSVhFTCwgUEVSQ0VOVEFHRSB9XHJcbmV4cG9ydCBlbnVtIERJUkVDVElPTl9SRUZFUkVOQ0UgeyBIT1JJWk9OVEFMLCBWRVJUSUNBTCB9XHJcbmV4cG9ydCBlbnVtIFZFUlRJQ0FMX1JFRkVSRU5DRSB7IEZST01fVE9QLCBGUk9NX0JPVFRPTSB9XHJcblxyXG5leHBvcnQgZW51bSBDT0xPUl9DSEFOTkVMIHsgUiwgRywgQiwgQSB9O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb21wYXJhYmxlPFQ+IHtcclxuICBlcXVhbHMoIGI6IFQgKTogYm9vbGVhbjtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBDU1NQb3NpdGlvbiBpbXBsZW1lbnRzIElQb2ludDJEIHtcclxuICBwdWJsaWMgeDogbnVtYmVyO1xyXG4gIHB1YmxpYyB5OiBudW1iZXI7XHJcbiAgcHJpdmF0ZSB0eXBlOiBDT05WRVJTSU9OX1VOSVQ7XHJcbiAgcHVibGljIHZlcnRpY2FsUmVmZXJlbmNlOiBWRVJUSUNBTF9SRUZFUkVOQ0U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCB7IHgsIHksIHZlcnRpY2FsUmVmZXJlbmNlID0gVkVSVElDQUxfUkVGRVJFTkNFLkZST01fVE9QLCB0eXBlID0gQ09OVkVSU0lPTl9VTklULlBJWEVMIH06IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHZlcnRpY2FsUmVmZXJlbmNlPzogVkVSVElDQUxfUkVGRVJFTkNFOyB0eXBlPzogQ09OVkVSU0lPTl9VTklUOyB9ICkge1xyXG4gICAgW3RoaXMueCwgdGhpcy55LCB0aGlzLnZlcnRpY2FsUmVmZXJlbmNlLCB0aGlzLnR5cGVdID0gW3gsIHksIHZlcnRpY2FsUmVmZXJlbmNlLCB0eXBlXTtcclxuICB9XHJcblxyXG4gIGdldCBob3Jpem9udGFsKCk6IHN0cmluZyB7XHJcbiAgICBzd2l0Y2ggKCB0aGlzLnR5cGUgKSB7XHJcbiAgICAgIGNhc2UgQ09OVkVSU0lPTl9VTklULlBJWEVMOlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy54IH1weGA7XHJcbiAgICAgIGNhc2UgQ09OVkVSU0lPTl9VTklULlBFUkNFTlRBR0U6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnggfSVgO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBgJHsgdGhpcy54IH1weGA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXQgdmVydGljYWwoKTogc3RyaW5nIHtcclxuICAgIHN3aXRjaCAoIHRoaXMudHlwZSApIHtcclxuICAgICAgY2FzZSBDT05WRVJTSU9OX1VOSVQuUElYRUw6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnkgfXB4YDtcclxuICAgICAgY2FzZSBDT05WRVJTSU9OX1VOSVQuUEVSQ0VOVEFHRTpcclxuICAgICAgICByZXR1cm4gYCR7IHRoaXMueSB9JWA7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIGAkeyB0aGlzLnkgfXB4YDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIENvbGxpc2lvbkRpcmVjdGlvbkNoZWNrID0ge1xyXG4gIHRvcDogYm9vbGVhbjtcclxuICByaWdodDogYm9vbGVhbjtcclxuICBjZW50ZXI6IGJvb2xlYW47XHJcbiAgYm90dG9tOiBib29sZWFuO1xyXG4gIGxlZnQ6IGJvb2xlYW47XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSA9IHtcclxuICB0b3A6IG51bWJlcjtcclxuICByaWdodDogbnVtYmVyO1xyXG4gIGJvdHRvbTogbnVtYmVyO1xyXG4gIGxlZnQ6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgTmVpZ2hib3JzPFQ+ID0ge1xyXG4gIHRvcDogSU5vZGU8VD4gfCBudWxsO1xyXG4gIHJpZ2h0OiBJTm9kZTxUPiB8IG51bGw7XHJcbiAgYm90dG9tOiBJTm9kZTxUPiB8IG51bGw7XHJcbiAgbGVmdDogSU5vZGU8VD4gfCBudWxsO1xyXG4gIHRvcFJpZ2h0OiBJTm9kZTxUPiB8IG51bGw7XHJcbiAgYm90dG9tUmlnaHQ6IElOb2RlPFQ+IHwgbnVsbDtcclxuICB0b3BMZWZ0OiBJTm9kZTxUPiB8IG51bGw7XHJcbiAgYm90dG9tTGVmdDogSU5vZGU8VD4gfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUHJpb3JpdHlRdWV1ZTxUPiB7XHJcbiAgcHVibGljIGhlYXA6IElOb2RlPFQ+W10gPSBbXTtcclxuXHJcbiAgaXNFbXB0eSgpIHtcclxuICAgIHJldHVybiB0aGlzLmhlYXAubGVuZ3RoID09IDA7XHJcbiAgfVxyXG5cclxuICBwZWVrKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaGVhcC5sZW5ndGggPT0gMCA/IG51bGwgOiB0aGlzLmhlYXBbMF0udmFsdWU7XHJcbiAgfVxyXG5cclxuICBzaXplKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaGVhcC5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICBwYXJlbnQoIGluZGV4OiBudW1iZXIgKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBNYXRoLmZsb29yKCAoIGluZGV4IC0gMSApIC8gMiApO1xyXG4gIH1cclxuXHJcbiAgbGVmdCggaW5kZXg6IG51bWJlciApOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIDIgKiBpbmRleCArIDE7XHJcbiAgfVxyXG5cclxuICByaWdodCggaW5kZXg6IG51bWJlciApOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIDIgKiBpbmRleCArIDI7XHJcbiAgfVxyXG5cclxuICBoYXNMZWZ0KCBpbmRleDogbnVtYmVyICk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMubGVmdCggaW5kZXggKSA8IHRoaXMuaGVhcC5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICBoYXNSaWdodCggaW5kZXg6IG51bWJlciApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLnJpZ2h0KCBpbmRleCApIDwgdGhpcy5oZWFwLmxlbmd0aDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzd2FwKCBhOiBudW1iZXIsIGI6IG51bWJlciApIHtcclxuICAgIGNvbnN0IHRtcCA9IHRoaXMuaGVhcFthXVxyXG4gICAgdGhpcy5oZWFwW2FdID0gdGhpcy5oZWFwW2JdXHJcbiAgICB0aGlzLmhlYXBbYl0gPSB0bXBcclxuICB9XHJcblxyXG4gIHB1c2goIGl0ZW06IFQsIHByaW9yaXR5OiBudW1iZXIgKTogdm9pZCB7XHJcbiAgICB0aGlzLmhlYXAucHVzaCggeyBrZXk6IHByaW9yaXR5LCB2YWx1ZTogaXRlbSB9ICk7XHJcblxyXG4gICAgbGV0IGkgPSB0aGlzLmhlYXAubGVuZ3RoIC0gMTtcclxuICAgIHdoaWxlICggaSA+IDAgKSB7XHJcbiAgICAgIGNvbnN0IHAgPSB0aGlzLnBhcmVudCggaSApO1xyXG5cclxuICAgICAgaWYgKCB0aGlzLmhlYXBbcF0ua2V5IDwgdGhpcy5oZWFwW2ldLmtleSApIHtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5zd2FwKCBpLCBwICk7XHJcbiAgICAgIGkgPSBwO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcG9wKCk6IFQgfCBudWxsIHtcclxuICAgIGlmICggdGhpcy5oZWFwLmxlbmd0aCA9PSAwICkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgdGhpcy5zd2FwKCAwLCB0aGlzLmhlYXAubGVuZ3RoIC0gMSApO1xyXG4gICAgY29uc3QgaXRlbSA9IHRoaXMuaGVhcC5wb3AoKTtcclxuXHJcbiAgICBsZXQgY3VycmVudCA9IDA7XHJcbiAgICB3aGlsZSAoIHRoaXMuaGFzTGVmdCggY3VycmVudCApICkge1xyXG4gICAgICBsZXQgc21hbGxlckNoaWxkID0gdGhpcy5sZWZ0KCBjdXJyZW50ICk7XHJcblxyXG4gICAgICBpZiAoIHRoaXMuaGFzUmlnaHQoIGN1cnJlbnQgKSAmJiB0aGlzLmhlYXBbdGhpcy5yaWdodCggY3VycmVudCApXS5rZXkgPCB0aGlzLmhlYXBbdGhpcy5sZWZ0KCBjdXJyZW50ICldLmtleSApIHtcclxuICAgICAgICBzbWFsbGVyQ2hpbGQgPSB0aGlzLnJpZ2h0KCBjdXJyZW50ICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICggdGhpcy5oZWFwW3NtYWxsZXJDaGlsZF0ua2V5ID4gdGhpcy5oZWFwW2N1cnJlbnRdLmtleSApIHtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5zd2FwKCBjdXJyZW50LCBzbWFsbGVyQ2hpbGQgKTtcclxuICAgICAgY3VycmVudCA9IHNtYWxsZXJDaGlsZDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaXRlbSA/IGl0ZW0udmFsdWUgOiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJTm9kZTxUPiB7XHJcbiAga2V5OiBudW1iZXI7XHJcbiAgdmFsdWU6IFQgfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNOb2RlPFQ+KCB0ZXN0OiBhbnkgKTogdGVzdCBpcyBJTm9kZTxUPiB7XHJcbiAgbGV0IHRlc3RBc05vZGUgPSAoIHRlc3QgYXMgSU5vZGU8VD4gKTtcclxuICByZXR1cm4gdGVzdEFzTm9kZS52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRlc3RBc05vZGUua2V5ICE9PSB1bmRlZmluZWQgJiYgdGVzdEFzTm9kZS5rZXkgIT09IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU1lZGlhUGxheWVyRnVuY3Rpb25zIHtcclxuICBwbGF5KCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBwYXVzZSgpOiBJTWVkaWFQbGF5ZXJGdW5jdGlvbnM7XHJcbiAgdG9nZ2xlKCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBzZWVrKCBzZWVrVGltZTogbnVtYmVyLCByZWxvYWRCdWZmZXI/OiBib29sZWFuICk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICBtdXRlKCk6IElNZWRpYVBsYXllckZ1bmN0aW9ucztcclxuICB1bm11dGUoKTogSU1lZGlhUGxheWVyRnVuY3Rpb25zO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElDb2xsaXNpb25FdmVudCB7XHJcbiAgdGFyZ2V0Q2xhc3M6IHN0cmluZztcclxuICBjaGVja1RhcmdldENsYXNzOiBib29sZWFuO1xyXG4gIG9uQ29sbGlkaW5nKCBkcmFnZ2FibGU6IEhUTUxFbGVtZW50LCB0YXJnZXQ6IEhUTUxFbGVtZW50LCBjb2xsaWRpbmdBdDogQ29sbGlzaW9uRGlyZWN0aW9uQ2hlY2ssIGRpc3RhbmNlRnJvbUJvcmRlcjogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2UgKTogUHJvbWlzZTx2b2lkPjtcclxuICBvbk5vdENvbGxpZGluZyggZHJhZ2dhYmxlOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCApOiBQcm9taXNlPHZvaWQ+O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElPYmplY3RUb1NldE9uWW91dHViZUlmcmFtZXNSZWFkeSB7XHJcbiAgc2V0dXAoIGRpY3RFdmVyeUlmcmFtZTogTWFwPHN0cmluZywgWW91dHViZUlmcmFtZT4gKTogdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE9iamVjdEV2ZW50TGlzdGVuZXIge1xyXG4gIHB1YmxpYyBldmVudHNCeU5hbWU6IE1hcDxzdHJpbmcsIEZ1bmN0aW9uW10+ID0gbmV3IE1hcCgpO1xyXG5cclxuICBwdWJsaWMgYWRkRXZlbnRMaXN0ZW5lciggZXZlbnROYW1lOiBzdHJpbmcsIGV2ZW50OiBGdW5jdGlvbiApIHtcclxuICAgIGlmICggIXRoaXMuZXZlbnRzQnlOYW1lLmhhcyggZXZlbnROYW1lLnRvTG93ZXJDYXNlKCkgKSApIHtcclxuICAgICAgdGhpcy5ldmVudHNCeU5hbWUuc2V0KCBldmVudE5hbWUudG9Mb3dlckNhc2UoKSwgW2V2ZW50XSApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5ldmVudHNCeU5hbWUuZ2V0KCBldmVudE5hbWUudG9Mb3dlckNhc2UoKSApIS5wdXNoKCBldmVudCApO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldEV2ZW50c0J5TmFtZSggZXZlbnROYW1lOiBzdHJpbmcgKTogRnVuY3Rpb25bXSB7XHJcbiAgICBpZiAoICF0aGlzLmV2ZW50c0J5TmFtZS5oYXMoIGV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpICkgKSB7XHJcbiAgICAgIHRoaXMuZXZlbnRzQnlOYW1lLnNldCggZXZlbnROYW1lLnRvTG93ZXJDYXNlKCksIFtdICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZXZlbnRzQnlOYW1lLmdldCggZXZlbnROYW1lLnRvTG93ZXJDYXNlKCkgKSE7XHJcbiAgfVxyXG5cclxuXHJcbiAgcHVibGljIGNhbGxFdmVudHNCeU5hbWUoIGV2ZW50TmFtZTogc3RyaW5nLCAuLi5ldmVudEFyZ3M6IGFueVtdICk6IHZvaWQge1xyXG4gICAgdGhpcy5nZXRFdmVudHNCeU5hbWUoIGV2ZW50TmFtZSApLmZvckVhY2goIGUgPT4gZSggLi4uZXZlbnRBcmdzICkgKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIENvbGxpc2lvbkV2ZW50U3ViRXZlbnRMaXN0ZW5lciA9ICggKCB0cmlnZ2VyOiBIVE1MRWxlbWVudCwgdGFyZ2V0OiBIVE1MRWxlbWVudCApID0+IHZvaWQgKTtcclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbGxpc2lvbkV2ZW50IGV4dGVuZHMgT2JqZWN0RXZlbnRMaXN0ZW5lciBpbXBsZW1lbnRzIElDb2xsaXNpb25FdmVudCB7XHJcbiAgYWJzdHJhY3QgdGFyZ2V0Q2xhc3M6IHN0cmluZztcclxuICBhYnN0cmFjdCBjaGVja1RhcmdldENsYXNzOiBib29sZWFuO1xyXG5cclxuICBwdWJsaWMgZW5hYmxlZDogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gIGlzVmFsaWRUYXJnZXRUb1RyaWdnZXJFdmVudCggY3VycmVudFRhcmdldDogSFRNTEVsZW1lbnQsIHRhcmdldENsYXNzTmFtZTogc3RyaW5nLCB2YWxpZGF0ZURpc3RhbmNlPzogeyBkaXN0YW5jZVRocmVzaG9sZDogbnVtYmVyLCBkaXN0YW5jZUZyb21Cb3JkZXI6IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlIH0gKTogYm9vbGVhbiB7XHJcbiAgICBpZiAoICF0aGlzLmVuYWJsZWQgKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIHRoaXMuY2hlY2tUYXJnZXRDbGFzcyAmJiAhY3VycmVudFRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoIHRhcmdldENsYXNzTmFtZSApICkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCB2YWxpZGF0ZURpc3RhbmNlICkge1xyXG4gICAgICAvLy8gQ2hlY2tzIGhvdyBtYW55IHBpeGVscyB0aGUgZHJhZ2dhYmxlIGlzIGluc2lkZSBmcm9tIGVhY2ggYm9yZGVyOyBpZiB0aGUgZWxlbWVudCBpcyBvdmVyIHRoZSB0aHJlc2hvbGQgdGhlIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIHRydWU7XHJcbiAgICAgIGNvbnN0IGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlRXh0cmFzID0gbmV3IENvbGxpc2lvbkJvcmRlckRpc3RhbmNlRXh0cmFzKCB2YWxpZGF0ZURpc3RhbmNlLmRpc3RhbmNlRnJvbUJvcmRlciApO1xyXG4gICAgICBpZiAoIGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlRXh0cmFzLmFueUxvd2VyVGhhbiggdmFsaWRhdGVEaXN0YW5jZS5kaXN0YW5jZVRocmVzaG9sZCApICkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgYWJzdHJhY3Qgb25Db2xsaWRpbmcoIGRyYWdnYWJsZTogSFRNTEVsZW1lbnQsIHRhcmdldDogSFRNTEVsZW1lbnQsIGNvbGxpZGluZ0F0OiBDb2xsaXNpb25EaXJlY3Rpb25DaGVjaywgZGlzdGFuY2VGcm9tQm9yZGVyOiBDb2xsaXNpb25Cb3JkZXJEaXN0YW5jZSApOiBQcm9taXNlPHZvaWQ+O1xyXG4gIGFic3RyYWN0IG9uTm90Q29sbGlkaW5nKCBkcmFnZ2FibGU6IEhUTUxFbGVtZW50LCB0YXJnZXQ6IEhUTUxFbGVtZW50ICk6IFByb21pc2U8dm9pZD47XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIENvbGxpc2lvblRyaWdnZXJPcHRpb25zID0ge1xyXG4gIHRyaWdnZXJFbGVtZW50OiBIVE1MRWxlbWVudDtcclxuICBldmVudHM6IENvbGxpc2lvbkV2ZW50W107XHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2VFeHRyYXMge1xyXG4gIGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlczogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCBjb2xsaXNpb25Cb3JkZXJEaXN0YW5jZTogQ29sbGlzaW9uQm9yZGVyRGlzdGFuY2UgKSB7XHJcbiAgICB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcyA9IGNvbGxpc2lvbkJvcmRlckRpc3RhbmNlO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGFueUdyZWF0ZXJUaGFuKCBudW06IG51bWJlciApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy50b3AgPiBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMucmlnaHQgPiBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMuYm90dG9tID4gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmxlZnQgPiBudW07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYW55TG93ZXJUaGFuKCBudW06IG51bWJlciApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy50b3AgPCBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMucmlnaHQgPCBudW1cclxuICAgICAgfHwgdGhpcy5jb2xsaXNpb25Cb3JkZXJEaXN0YW5jZXMuYm90dG9tIDwgbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmxlZnQgPCBudW07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYW55RXF1YWxzKCBudW06IG51bWJlciApOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy50b3AgPT09IG51bVxyXG4gICAgICB8fCB0aGlzLmNvbGxpc2lvbkJvcmRlckRpc3RhbmNlcy5yaWdodCA9PT0gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmJvdHRvbSA9PT0gbnVtXHJcbiAgICAgIHx8IHRoaXMuY29sbGlzaW9uQm9yZGVyRGlzdGFuY2VzLmxlZnQgPT09IG51bTtcclxuICB9XHJcbn0iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7IGRlYm91bmNlRmFjdG9yeSwgc21vb3RoU2Nyb2xsVG9FbGVtZW50IH0gZnJvbSAnLi9ET01Ub29scyc7XHJcbmltcG9ydCB7IGNsYW1wIH0gZnJvbSAnLi9NYXRoVG9vbHMnO1xyXG5pbXBvcnQgeyBTY2VuZUNvbnRyb2xsZXIgfSBmcm9tICcuL1NjZW5lQ29udHJvbGxlcic7XHJcbmltcG9ydCB7IE9iamVjdEV2ZW50TGlzdGVuZXIgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBTZWN0aW9uU2Nyb2xsZXIgZXh0ZW5kcyBPYmplY3RFdmVudExpc3RlbmVyIHtcclxuICBwcml2YXRlIHN0YXRpYyBfZ2xvYmFsSW5zdGFuY2U6IFNlY3Rpb25TY3JvbGxlciA9IG5ldyBTZWN0aW9uU2Nyb2xsZXIoKTtcclxuICBwcml2YXRlIHN0YXRpYyBfZGVib3VuY2VXaGVlbDogRnVuY3Rpb247XHJcblxyXG4gIHByaXZhdGUgX2luZGV4OiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBfc2VjdGlvbnM6IEhUTUxFbGVtZW50W107XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuX2luZGV4ID0gMDtcclxuICAgIHRoaXMuX3NlY3Rpb25zID0gQXJyYXkuZnJvbSggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggJ3NlY3Rpb24nICkgKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXQgc2VjdGlvbigpOiBIVE1MRWxlbWVudCB7XHJcbiAgICByZXR1cm4gdGhpcy5fc2VjdGlvbnNbdGhpcy5faW5kZXhdO1xyXG4gIH1cclxuXHJcbiAgc2Nyb2xsVG9TZWN0aW9uQnlJbmRleCggaW5kZXg6IG51bWJlciApIHtcclxuICAgIGluZGV4ID0gY2xhbXAoIGluZGV4LCAwLCB0aGlzLl9zZWN0aW9ucy5sZW5ndGggLSAxICk7XHJcblxyXG4gICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb25zY3JvbGwnLCB0aGlzLnNlY3Rpb24sIHRoaXMuX2luZGV4ICk7XHJcblxyXG4gICAgaWYgKCBpbmRleCA+IHRoaXMuX2luZGV4ICkge1xyXG4gICAgICB0aGlzLmNhbGxFdmVudHNCeU5hbWUoICdvbnNjcm9sbGRvd24nLCB0aGlzLnNlY3Rpb24sIHRoaXMuX2luZGV4ICk7XHJcbiAgICB9IGVsc2UgaWYgKCBpbmRleCA8IHRoaXMuX2luZGV4ICkge1xyXG4gICAgICB0aGlzLmNhbGxFdmVudHNCeU5hbWUoICdvbnNjcm9sbHVwJywgdGhpcy5zZWN0aW9uLCB0aGlzLl9pbmRleCApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jYWxsRXZlbnRzQnlOYW1lKCAnb25zY3JvbGxmYWlsZWQnLCB0aGlzLnNlY3Rpb24sIHRoaXMuX2luZGV4ICk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5faW5kZXggPSBpbmRleDtcclxuICAgIHRoaXMuX3NlY3Rpb25zW2luZGV4XS5zY3JvbGxJbnRvVmlldyggeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0gKTtcclxuICB9XHJcblxyXG4gIHNjcm9sbFRvUHJldmlvdXNTZWN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuc2Nyb2xsVG9TZWN0aW9uQnlJbmRleCggdGhpcy5faW5kZXggLSAxICk7XHJcbiAgfVxyXG5cclxuICBzY3JvbGxUb05leHRTZWN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuc2Nyb2xsVG9TZWN0aW9uQnlJbmRleCggdGhpcy5faW5kZXggKyAxICk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIG1ha2VHbG9iYWxTY3JvbGxTZWN0aW9uU2Nyb2xsZXIoKSB7XHJcbiAgICBTZWN0aW9uU2Nyb2xsZXIuX2RlYm91bmNlV2hlZWwgPSBkZWJvdW5jZUZhY3RvcnkoICggZXZlbnQ6IFdoZWVsRXZlbnQgKSA9PiB7XHJcbiAgICAgIGlmICggZXZlbnQuZGVsdGFZID4gMCApIHtcclxuICAgICAgICBTZWN0aW9uU2Nyb2xsZXIuX2dsb2JhbEluc3RhbmNlLnNjcm9sbFRvTmV4dFNlY3Rpb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBTZWN0aW9uU2Nyb2xsZXIuX2dsb2JhbEluc3RhbmNlLnNjcm9sbFRvUHJldmlvdXNTZWN0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgIH0sIDUwMCApO1xyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAnd2hlZWwnLCBmdW5jdGlvbiAoIGV2ZW50ICkge1xyXG4gICAgICBTZWN0aW9uU2Nyb2xsZXIuX2RlYm91bmNlV2hlZWwoIGV2ZW50ICk7XHJcbiAgICB9ICk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbImRpY3RLZXlzQnlBY3Rpb25LZXlkb3duT25jZSIsIk1hcCIsImRpY3RLZXlzQnlBY3Rpb25LZXlkb3duUmVwZWF0IiwiZGljdEtleXNCeUFjdGlvbktleXVwIiwiZGVib3VuY2VGYWN0b3J5IiwiZnVuYyIsImRlbGF5IiwiaW5EZWJvdW5jZSIsImNvbnRleHQiLCJ3aW5kb3ciLCJhcmdzIiwiYXJndW1lbnRzIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsImFwcGx5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInJlcGVhdCIsInBhaXIiLCJjb2RlIiwiZm9yRWFjaCIsImtiRXZlbnQiLCJydW5Pbmx5T25jZUtleWRvd25BY3Rpb25zIiwicnVuS2V5ZG93bkFjdGlvbnNSZXBlYXQiLCJjbGFtcCIsIm51bSIsIm1pbiIsIm1heCIsIk1hdGgiLCJDT05WRVJTSU9OX1VOSVQiLCJESVJFQ1RJT05fUkVGRVJFTkNFIiwiVkVSVElDQUxfUkVGRVJFTkNFIiwiQ09MT1JfQ0hBTk5FTCIsIk9iamVjdEV2ZW50TGlzdGVuZXIiLCJldmVudHNCeU5hbWUiLCJldmVudE5hbWUiLCJldmVudCIsInRoaXMiLCJoYXMiLCJ0b0xvd2VyQ2FzZSIsImdldCIsInB1c2giLCJzZXQiLCJnZXRFdmVudHNCeU5hbWUiLCJjYWxsRXZlbnRzQnlOYW1lIiwiZXZlbnRBcmdzIiwiZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiU2VjdGlvblNjcm9sbGVyIiwic3RhdGljIiwiX2luZGV4IiwiX3NlY3Rpb25zIiwiY29uc3RydWN0b3IiLCJzdXBlciIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsInNlY3Rpb24iLCJzY3JvbGxUb1NlY3Rpb25CeUluZGV4IiwiaW5kZXgiLCJsZW5ndGgiLCJzY3JvbGxJbnRvVmlldyIsImJlaGF2aW9yIiwiYmxvY2siLCJzY3JvbGxUb1ByZXZpb3VzU2VjdGlvbiIsInNjcm9sbFRvTmV4dFNlY3Rpb24iLCJtYWtlR2xvYmFsU2Nyb2xsU2VjdGlvblNjcm9sbGVyIiwiX2RlYm91bmNlV2hlZWwiLCJkZWx0YVkiLCJfZ2xvYmFsSW5zdGFuY2UiXSwic291cmNlUm9vdCI6IiJ9